---
title: 自订阅事件
updated: 2013-06-18 05:28:32Z
created: 2013-06-18 05:28:04Z
tags:
  - c#
---




<en-note STYLE="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div ALIGN="left"><font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">using</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">System;</span></font></div><div ALIGN="left"><font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">using</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">System.Collections.Generic;</span></font></div><div ALIGN="left"><font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">using</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">System.ComponentModel;</span></font></div><div ALIGN="left"><font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">using</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">System.Data;</span></font></div><div ALIGN="left"><font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">using</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">System.Drawing;</span></font></div><div ALIGN="left"><font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">using</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">System.Linq;</span></font></div><div ALIGN="left"><font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">using</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">System.Text;</span></font></div><div ALIGN="left"><font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">using</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">System.Windows.Forms;</span></font></div><div ALIGN="left"><font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">using</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">System.Data.SqlClient;</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt"><br/></span></font></div><div ALIGN="left"><font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">namespace</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">WindowsFormsApplication6</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">{</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">public</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">partial</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">class</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">Form1</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">:</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">Form</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp; {</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">public</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">static</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">readonly</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">string</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">SQLconnString =</span></font> <font COLOR="#A31515" FACE="Calibri"><span STYLE="font-size:12pt">&quot;Data Source=TANG-LEPTOP\\SQLEXPRESS;Initial Catalog=health;Integrated Security=True&quot;</span></font><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">;</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">public</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">Form1()</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; InitializeComponent();</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt"><br/></span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">private</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">void</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">dataGridView1_RowsAdded(</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">object</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">sender,</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">DataGridViewRowsAddedEventArgs</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">e)</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; label1.Text=e.RowCount.ToString();</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; label2.Text=e.RowIndex.ToString();</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">private</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">void</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">dataGridView1_CellValuePushed(</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">object</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">sender,</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">DataGridViewCellValueEventArgs</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">e)</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; label3.Text = e.RowIndex.ToString();</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">private</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">void</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">datagridview_CellValueChanged(</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">object</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">ss,</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">DataGridViewCellEventArgs</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">e)</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#008000" FACE="Calibri"><span STYLE="font-size:12pt">////wrote by my self</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">try</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; label5.Text =</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">this</span></font><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">.dataGridView1.Rows[e.ColumnIndex].Cells[e.ColumnIndex].Value.ToString();</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">finally</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt"><br/></span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt"><br/></span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">DataGridViewComboBoxColumn</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">CreateCheckInfoColumn()</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">DataGridViewComboBoxColumn</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">combo =</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">new</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">DataGridViewComboBoxColumn</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">();</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">SqlCommand</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">sqlComm = InitDatabase(SQLconnString);</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sqlComm.CommandType =</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">CommandType</span></font><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">.Text;</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sqlComm.CommandText =</span></font> <font COLOR="#A31515" FACE="Calibri"><span STYLE="font-size:12pt">&quot;select checkName from checklist;&quot;</span></font><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">;</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">if</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">(sqlComm.Connection.State ==</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">ConnectionState</span></font><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">.Open)</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">SqlDataReader</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">dr = sqlComm.ExecuteReader();</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">List</span></font><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&lt;</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">string</span></font><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&gt; _buff_list =</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">new</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">List</span></font><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&lt;</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">string</span></font><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&gt;();</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">while</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">(dr.Read())</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _buff_list.Add((</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">string</span></font><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">)dr[</span></font> <font COLOR="#A31515" FACE="Calibri"><span STYLE="font-size:12pt">&quot;checkName&quot;</span></font><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">]);</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; combo.DataSource = _buff_list;</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; combo.DataPropertyName =</span></font> <font COLOR="#A31515" FACE="Calibri"><span STYLE="font-size:12pt">&quot;check info&quot;</span></font><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">;</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; combo.Name =</span></font> <font COLOR="#A31515" FACE="Calibri"><span STYLE="font-size:12pt">&quot;checkinfo&quot;</span></font><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">;</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sqlComm.Connection.Close();</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt"><br/></span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">return</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">combo;</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">SqlCommand</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">InitDatabase(</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">string</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">ConnString)</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">SqlConnection</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">sqlConn =</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">new</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">SqlConnection</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">(ConnString);</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sqlConn.Open();</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt"><br/></span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">SqlCommand</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">sqlComm = sqlConn.CreateCommand();</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">return</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">sqlComm;</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt"><br/></span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">private</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">void</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">Form1_Load(</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">object</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">sender,</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">EventArgs</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">e)</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">this</span></font><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">.dataGridView1.CellValuePushed += dataGridView1_CellValuePushed;</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">this</span></font><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">.dataGridView1.CellValueChanged += datagridview_CellValueChanged;</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt"><br/></span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">private</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">void</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">button1_Click(</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">object</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">sender,</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">EventArgs</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">e)</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dataGridView1.Columns.Add(CreateCheckInfoColumn());</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt"><br/></span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp; }</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">}</span></font></div><div ALIGN="left">&nbsp;&nbsp;</div></en-note>      