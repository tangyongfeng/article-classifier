---
title: 'Returning a DataSet From a Web Services: Step-by-Step'
updated: 2013-07-16 07:24:07Z
created: 2013-07-16 07:22:55Z
tags:
  - c#
---




<en-note STYLE="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><br/>
This Example Shows how to create a webservice which returns a DataSet and a Client Which displays the DataSet in a Grid.<br/><br/>
Description<br/><br/>
This Example Shows how to create a webservice which returns a DataSet and a Client Which displays the DataSet in a Grid.<br/><br/>
Source Code<br/><br/>
*** WEBSERVICE<br/><br/>
Open a New WebService project Lets Call It WebService1<br/>
Create a Stock Table on SQL Desktop Edition with the Following Fields<br/>
Stock Code,Description,Price(Can be anything you want), and Add some dummy data.<br/>
Create a Method as the Code Below<br/><br/>
// Put the Code Below in the using Section<br/>
using System.Data.SqlClient ;<br/>
// this is the Actual Web Method<br/>
[WebMethod]<br/>
public DataSet GetData()<br/>
{<br/>
// First Create a New Connection<br/>
System.Data.SqlClient.SqlConnection sqlConnection1 = new System.Data.SqlClient.SqlConnection();<br/>
// Now Pass a Connection String To the Connection<br/>
sqlConnection1.ConnectionString = &quot;data source=MyServer-001\\SqlServerName;initial catalog=Stock;integrated securi&quot; +<br/>
&quot;ty=SSPI;persist security info=False;workstation id=MyServer-001;packet size=40&quot; +<br/>
&quot;96&quot;;<br/>
// Now the Select statement you want to run<br/>
string select =&quot;select * from stock &quot;;<br/>
// Create an Adapter<br/>
SqlDataAdapter da = new SqlDataAdapter(select,sqlConnection1);<br/>
// Create a New DataSet<br/>
DataSet ds = new DataSet();<br/>
// Fill The DataSet With the Contents of the Stock Table<br/>
da.Fill(ds , &quot;stock&quot;);<br/>
// Now Return ds which is a DataSet<br/>
return(ds);<br/>
}<br/><br/>
*****CLIENT<br/><br/>
Now For the Client<br/><br/>
Open a New Window form Project and Call it WindowsApplication1<br/>
Add a DataGrid to the Form. Rename DataGrid1 to dataGrid<br/>
Add a Command Button<br/>
Now to add a Web reference do the Following.<br/>
In the Solution Explorer Right Click on you application name and Click Add Web Reference.<br/>
A Form is brought up. In the Window Type your Url it would Be http://localhost/webservice1/service1.asmx<br/>
Now Click on Add Reference Button. you will be brought back to your solution explorer.<br/>
Now in the solution explorer under web references Rename localhost to WebDataSet<br/>
Now in the Using Section add the Foll Code<br/>
using WindowsApplication1.WebDataSet;<br/>
Now in the Button click event add the foll Code<br/>
private void button1_Click(object sender, System.EventArgs e)<br/>
{<br/>
// Init MyService to the Web Service<br/>
Service1 MyService = new Service1();<br/>
// Call the GetData method in the Web Service<br/>
DataSet ds = MyService.GetData();<br/>
// Bind the DataSet to the Grid<br/>
dataGrid.SetDataBinding(ds , &quot;stock&quot;);<br/>
}
</en-note>      