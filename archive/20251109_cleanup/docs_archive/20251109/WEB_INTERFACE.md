# ğŸ“± Web ç•Œé¢ä½¿ç”¨æŒ‡å—

## åŠŸèƒ½æ¦‚è§ˆ

Article Classifier Web ç•Œé¢æä¾›äº†å‹å¥½çš„å›¾å½¢åŒ–ç•Œé¢ï¼Œç”¨äºæµè§ˆå’Œç®¡ç†å·²åˆ†ç±»çš„æ–‡ç« ã€‚

### ä¸»è¦åŠŸèƒ½

- ğŸ  **é¦–é¡µ** - å±•ç¤ºåˆ†ç±»æ ‘å’Œç»Ÿè®¡ä¿¡æ¯
- ğŸ“ **åˆ†ç±»æµè§ˆ** - æŒ‰åˆ†ç±»æŸ¥çœ‹æ–‡ç« åˆ—è¡¨
- ğŸ“„ **æ–‡ç« è¯¦æƒ…** - æŸ¥çœ‹å®Œæ•´æ–‡ç« å†…å®¹å’Œå…ƒæ•°æ®
- âœï¸ **æ–‡ç« ç¼–è¾‘** - ä¿®æ”¹æ–‡ç« çš„åˆ†ç±»ã€å…³é”®è¯ã€æ‘˜è¦ç­‰
- âœ¨ **å†…å®¹é‡æ’** - ä½¿ç”¨ LLM é‡æ–°æ’ç‰ˆæ··ä¹±çš„æ–‡ç« æ ¼å¼ï¼ˆæ–°åŠŸèƒ½ï¼‰
- ğŸ” **æœç´¢åŠŸèƒ½** - æŒ‰æ ‡é¢˜ã€å…³é”®è¯ã€å†…å®¹æœç´¢æ–‡ç« 

---

## å¿«é€Ÿå¯åŠ¨

### 1. å®‰è£…ä¾èµ–

ç¡®ä¿å·²å®‰è£… Flaskï¼š

```bash
pip install flask
# æˆ–ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ
./venv/bin/pip install flask
```

### 2. å¯åŠ¨ Web æœåŠ¡

```bash
python scripts/run_web.py
# æˆ–ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ
./venv/bin/python scripts/run_web.py
```

### 3. è®¿é—®ç•Œé¢

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š

```
http://localhost:7888
```

**æ³¨æ„**ï¼šç«¯å£ 7888 æ˜¯ä¸ºäº†é¿å…ä¸ macOS AirDrop çš„ 5000 ç«¯å£å†²çªã€‚

---

## é…ç½®é€‰é¡¹

åœ¨ `config.yaml` ä¸­é…ç½® Web ç•Œé¢ï¼š

```yaml
web:
  host: "0.0.0.0"          # ç›‘å¬åœ°å€ï¼ˆ0.0.0.0 è¡¨ç¤ºæ‰€æœ‰ç½‘ç»œæ¥å£ï¼‰
  port: 7888               # ç«¯å£å·
  debug: false             # è°ƒè¯•æ¨¡å¼ï¼ˆç”Ÿäº§ç¯å¢ƒè¯·è®¾ä¸º falseï¼‰
  articles_per_page: 20    # æ¯é¡µæ˜¾ç¤ºçš„æ–‡ç« æ•°é‡
```

---

## åŠŸèƒ½è¯¦è§£

### é¦–é¡µ

- **ç»Ÿè®¡å¡ç‰‡**ï¼šæ˜¾ç¤ºæ€»æ–‡ç« æ•°å’Œæ€»åˆ†ç±»æ•°
- **åˆ†ç±»æ ‘**ï¼šæ ‘å½¢ç»“æ„å±•ç¤ºæ‰€æœ‰åˆ†ç±»
  - ç‚¹å‡»åˆ†ç±»åç§°æŸ¥çœ‹è¯¥åˆ†ç±»ä¸‹çš„æ–‡ç« 
  - æ•°å­—å¾½ç« æ˜¾ç¤ºæ¯ä¸ªåˆ†ç±»çš„æ–‡ç« æ•°é‡

### åˆ†ç±»æµè§ˆé¡µ

- **é¢åŒ…å±‘å¯¼èˆª**ï¼šæ˜¾ç¤ºå½“å‰åˆ†ç±»è·¯å¾„
- **æ’åºé€‰é¡¹**ï¼š
  - æŒ‰æ—¶é—´æ’åºï¼ˆé»˜è®¤ï¼‰
  - æŒ‰ç½®ä¿¡åº¦æ’åº
- **æ–‡ç« åˆ—è¡¨**ï¼š
  - æ˜¾ç¤ºæ ‡é¢˜ã€æ‘˜è¦ã€å…³é”®è¯ã€ç½®ä¿¡åº¦
  - ç‚¹å‡»æ–‡ç« æ ‡é¢˜æŸ¥çœ‹è¯¦æƒ…
- **åˆ†é¡µåŠŸèƒ½**ï¼šæ–¹ä¾¿æµè§ˆå¤§é‡æ–‡ç« 

### æ–‡ç« è¯¦æƒ…é¡µ

æ˜¾ç¤ºå®Œæ•´çš„æ–‡ç« ä¿¡æ¯ï¼š

- **å…ƒæ•°æ®**ï¼š
  - åˆ†ç±»è·¯å¾„ï¼ˆå¯ç‚¹å‡»è·³è½¬ï¼‰
  - ç½®ä¿¡åº¦
  - åˆ›å»ºæ—¶é—´
  - æ–‡ä»¶æ ¼å¼å’Œå¤§å°
  - å…³é”®è¯
  - æ‘˜è¦

- **æ–‡ç« å†…å®¹**ï¼š
  - å®Œæ•´çš„æ–‡ç« æ­£æ–‡
  - æ”¯æŒ HTML/Markdown æ¸²æŸ“

- **æ“ä½œæŒ‰é’®**ï¼š
  - **ç¼–è¾‘æ–‡ç« ** - ä¿®æ”¹åˆ†ç±»ã€å…³é”®è¯ã€æ‘˜è¦ç­‰
  - **é‡æ–°æ’ç‰ˆ** - ä½¿ç”¨ LLM ä¿®æ­£æ··ä¹±çš„æ–‡ç« æ ¼å¼ï¼ˆè½»é‡çº§ï¼Œä¸æ”¹å†™å†…å®¹ï¼‰

### æ–‡ç« ç¼–è¾‘é¡µ

å¯ä¿®æ”¹ä»¥ä¸‹å†…å®¹ï¼š

- **æ‘˜è¦**ï¼šç¼–è¾‘æ–‡ç« æ‘˜è¦
- **å…³é”®è¯**ï¼šæ·»åŠ /åˆ é™¤/ä¿®æ”¹å…³é”®è¯ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰
- **ç½®ä¿¡åº¦**ï¼šè°ƒæ•´åˆ†ç±»ç½®ä¿¡åº¦ (0-1)
- **åˆ†ç±»**ï¼šæ›´æ”¹æ–‡ç« çš„åˆ†ç±»ï¼ˆæ”¯æŒå¤šé€‰ï¼‰

**ä¿å­˜åä¼šåŒæ­¥æ›´æ–°**ï¼š
- PostgreSQL æ•°æ®åº“
- JSON å­˜å‚¨æ–‡ä»¶

### æœç´¢åŠŸèƒ½

- **æœç´¢èŒƒå›´**ï¼š
  - æ–‡ç« æ ‡é¢˜
  - æ–‡ç« æ‘˜è¦
  - å…³é”®è¯

- **æœç´¢æ¡†**ï¼šåœ¨å¯¼èˆªæ å³ä¾§ï¼Œéšæ—¶å¯ç”¨

---

## ä½¿ç”¨æŠ€å·§

### 1. å¿«é€ŸæŸ¥æ‰¾æ–‡ç« 

ä½¿ç”¨å¯¼èˆªæ çš„æœç´¢æ¡†ï¼Œè¾“å…¥å…³é”®è¯å³å¯å¿«é€Ÿå®šä½æ–‡ç« ã€‚

### 2. æ‰¹é‡ç®¡ç†åˆ†ç±»

è™½ç„¶å•ç¯‡æ–‡ç« åªèƒ½æ‰‹åŠ¨ç¼–è¾‘ï¼Œä½†å¯ä»¥é…åˆè„šæœ¬è¿›è¡Œæ‰¹é‡æ“ä½œã€‚

### 3. æŸ¥çœ‹åˆ†ç±»ç»Ÿè®¡

é¦–é¡µçš„åˆ†ç±»æ ‘ç›´è§‚æ˜¾ç¤ºæ¯ä¸ªåˆ†ç±»çš„æ–‡ç« æ•°é‡ï¼Œæ–¹ä¾¿äº†è§£å†…å®¹åˆ†å¸ƒã€‚

### 4. æ’åºä¼˜åŒ–

åœ¨åˆ†ç±»æµè§ˆé¡µï¼š
- ä½¿ç”¨"æ—¶é—´"æ’åºæŸ¥çœ‹æœ€æ–°æ–‡ç« 
- ä½¿ç”¨"ç½®ä¿¡åº¦"æ’åºæ‰¾å‡ºåˆ†ç±»æœ€æ˜ç¡®çš„æ–‡ç« 

### 5. ä½¿ç”¨"é‡æ–°æ’ç‰ˆ"åŠŸèƒ½ âœ¨

**é€‚ç”¨åœºæ™¯**ï¼š
- ä» Evernote å¯¼å‡ºçš„æ··ä¹±æ ¼å¼æ–‡ç« 
- æ®µè½æ–­è¡Œé”™è¯¯çš„æ–‡æ¡£
- åˆ—è¡¨æ ¼å¼ä¸ç»Ÿä¸€çš„å†…å®¹

**ä½¿ç”¨æ­¥éª¤**ï¼š
1. æ‰“å¼€æ–‡ç« è¯¦æƒ…é¡µ
2. ç‚¹å‡»"é‡æ–°æ’ç‰ˆ"æŒ‰é’®
3. ç­‰å¾… 10-20 ç§’ï¼ˆLLM å¤„ç†ä¸­ï¼‰
4. æŸ¥çœ‹æ’ç‰ˆåçš„æ•ˆæœ
5. å¦‚ä¸æ»¡æ„å¯ç‚¹å‡»"æ’¤é”€æ’ç‰ˆ"

**æ’ç‰ˆç‰¹ç‚¹**ï¼š
- âœ… è½»é‡çº§ - ä»…ä¿®æ­£æ ¼å¼ï¼Œä¸æ”¹å†™å†…å®¹
- âœ… ä¿ç•™åŸæ–‡ - ä¸æ”¹å˜è¯­æ°”ã€ç”¨è¯
- âœ… è‡ªåŠ¨ä¿å­˜ - æ’ç‰ˆç»“æœè‡ªåŠ¨ä¿å­˜åˆ°æ•°æ®åº“
- âœ… å¯æ’¤é”€ - æ”¯æŒä¸€é”®æ¢å¤åŸå§‹å†…å®¹

**è¯¦ç»†æ–‡æ¡£**ï¼šå‚è§ [WEB_REFORMAT.md](WEB_REFORMAT.md)

---

## åå°è¿è¡Œ

### ä½¿ç”¨ nohup

```bash
nohup ./venv/bin/python scripts/run_web.py > web.log 2>&1 &
```

### ä½¿ç”¨ screen

```bash
screen -S article-web
./venv/bin/python scripts/run_web.py
# æŒ‰ Ctrl+Aï¼Œç„¶åæŒ‰ D é€€å‡º screen
```

### åœæ­¢æœåŠ¡

```bash
# æŸ¥æ‰¾è¿›ç¨‹
ps aux | grep run_web.py

# æ€æ­»è¿›ç¨‹
kill <PID>

# æˆ–è€…
pkill -f run_web.py
```

---

## æ•…éšœæ’æŸ¥

### ç«¯å£è¢«å ç”¨

å¦‚æœ 7888 ç«¯å£è¢«å ç”¨ï¼Œä¿®æ”¹ `config.yaml`ï¼š

```yaml
web:
  port: 8000  # æ”¹ä¸ºå…¶ä»–ç«¯å£
```

### æ•°æ®åº“è¿æ¥å¤±è´¥

ç¡®ä¿ PostgreSQL æ­£åœ¨è¿è¡Œï¼š

```bash
# macOS
brew services start postgresql

# Linux
sudo systemctl start postgresql
```

æ£€æŸ¥ `.env` æ–‡ä»¶ä¸­çš„æ•°æ®åº“å¯†ç æ˜¯å¦æ­£ç¡®ã€‚

### æ¨¡æ¿æ¸²æŸ“é”™è¯¯

æ¸…é™¤æµè§ˆå™¨ç¼“å­˜æˆ–ä½¿ç”¨éšç§æ¨¡å¼é‡æ–°è®¿é—®ã€‚

### æ–‡ç« å†…å®¹æ˜¾ç¤ºä¸æ­£å¸¸

æ£€æŸ¥ JSON æ–‡ä»¶æ˜¯å¦å®Œæ•´ï¼š

```bash
cat data/json/articles/000001.json | jq .
```

---

## ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

**è­¦å‘Š**ï¼šFlask è‡ªå¸¦çš„å¼€å‘æœåŠ¡å™¨ä¸é€‚åˆç”Ÿäº§ç¯å¢ƒï¼

### æ¨èä½¿ç”¨ Gunicorn

1. å®‰è£… Gunicornï¼š
   ```bash
   pip install gunicorn
   ```

2. å¯åŠ¨æœåŠ¡ï¼š
   ```bash
   gunicorn -w 4 -b 0.0.0.0:7888 web.app:app
   ```

3. ä½¿ç”¨ systemd ç®¡ç†ï¼ˆæ¨èï¼‰ï¼š

åˆ›å»º `/etc/systemd/system/article-web.service`ï¼š

```ini
[Unit]
Description=Article Classifier Web Interface
After=network.target

[Service]
Type=simple
User=your_user
WorkingDirectory=/path/to/article-classifier
Environment="PATH=/path/to/article-classifier/venv/bin"
ExecStart=/path/to/article-classifier/venv/bin/gunicorn -w 4 -b 0.0.0.0:7888 web.app:app
Restart=always

[Install]
WantedBy=multi-user.target
```

å¯åŠ¨æœåŠ¡ï¼š

```bash
sudo systemctl start article-web
sudo systemctl enable article-web
```

---

## å®‰å…¨å»ºè®®

### 1. è®¾ç½®é˜²ç«å¢™

ä»…å…è®¸å¿…è¦çš„ IP è®¿é—®ï¼š

```bash
# ä½¿ç”¨ ufw (Ubuntu)
sudo ufw allow from 192.168.1.0/24 to any port 7888
```

### 2. ä½¿ç”¨åå‘ä»£ç†

é€šè¿‡ Nginx æä¾› HTTPSï¼š

```nginx
server {
    listen 443 ssl;
    server_name articles.yourdomain.com;

    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;

    location / {
        proxy_pass http://127.0.0.1:7888;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

### 3. æ·»åŠ èº«ä»½éªŒè¯

å¯ä»¥åœ¨ Flask åº”ç”¨ä¸­æ·»åŠ ç®€å•çš„ HTTP Basic Authï¼š

```python
from flask_httpauth import HTTPBasicAuth
from werkzeug.security import check_password_hash

auth = HTTPBasicAuth()

@auth.verify_password
def verify_password(username, password):
    # æ·»åŠ ç”¨æˆ·éªŒè¯é€»è¾‘
    pass

@app.route('/')
@auth.login_required
def index():
    # ...
```

---

## æ€§èƒ½ä¼˜åŒ–

### 1. å¯ç”¨ç¼“å­˜

å¯¹äºç”Ÿäº§ç¯å¢ƒï¼Œå¯ä»¥ä½¿ç”¨ Flask-Cachingï¼š

```python
from flask_caching import Cache

cache = Cache(app, config={'CACHE_TYPE': 'simple'})

@app.route('/')
@cache.cached(timeout=300)
def index():
    # ...
```

### 2. åˆ†é¡µä¼˜åŒ–

å½“å‰é»˜è®¤æ¯é¡µ 20 ç¯‡ï¼Œå¯æ ¹æ®éœ€è¦è°ƒæ•´ï¼š

```yaml
web:
  articles_per_page: 50  # è°ƒæ•´ä¸º 50
```

### 3. æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–

ç¡®ä¿æ•°æ®åº“ç´¢å¼•æ­£ç¡®ï¼š

```sql
CREATE INDEX idx_articles_created_at ON articles(created_at);
CREATE INDEX idx_article_categories_category_id ON article_categories(category_id);
```

---

## å¸¸è§é—®é¢˜

**Q: å¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ª Web å®ä¾‹å—ï¼Ÿ**

A: å¯ä»¥ï¼Œä½†éœ€è¦ä½¿ç”¨ä¸åŒçš„ç«¯å£ã€‚å»ºè®®ä½¿ç”¨è´Ÿè½½å‡è¡¡å™¨ï¼ˆå¦‚ Nginxï¼‰åˆ†å‘è¯·æ±‚ã€‚

**Q: ç¼–è¾‘æ–‡ç« åéœ€è¦é‡å¯æœåŠ¡å—ï¼Ÿ**

A: ä¸éœ€è¦ï¼Œæ›´æ”¹ä¼šç«‹å³ç”Ÿæ•ˆã€‚

**Q: æ”¯æŒå¯¼å‡ºåŠŸèƒ½å—ï¼Ÿ**

A: å½“å‰ç‰ˆæœ¬ä¸æ”¯æŒï¼Œä½†å¯ä»¥ç›´æ¥è®¿é—® JSON æ–‡ä»¶æˆ–æ•°æ®åº“å¯¼å‡ºã€‚

**Q: å¯ä»¥è‡ªå®šä¹‰ç•Œé¢æ ·å¼å—ï¼Ÿ**

A: å¯ä»¥ï¼Œä¿®æ”¹ `web/static/css/style.css` æ–‡ä»¶å³å¯ã€‚

---

## æœªæ¥è®¡åˆ’

- [ ] ç”¨æˆ·è®¤è¯å’Œæƒé™ç®¡ç†
- [ ] æ‰¹é‡ç¼–è¾‘åŠŸèƒ½
- [ ] ç»Ÿè®¡ä»ªè¡¨æ¿ï¼ˆå›¾è¡¨ï¼‰
- [ ] å¯¼å‡ºåŠŸèƒ½ï¼ˆCSV/Excelï¼‰
- [ ] RESTful API
- [ ] ä¸»é¢˜åˆ‡æ¢ï¼ˆäº®è‰²/æš—è‰²ï¼‰
- [ ] ç§»åŠ¨ç«¯ä¼˜åŒ–

---

## åé¦ˆä¸è´¡çŒ®

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æäº¤ Issue æˆ– Pull Requestã€‚
