{
  "ingest_source": {
    "id": "524da1b8-b49a-46a3-ae91-4153bbb9c4fd",
    "source_type": "evernote_html",
    "source_path": "/Users/tang/workbench/article-classifier/backups/2023年6月/投资/以预测股票涨跌案例入门基于SVM的机器学习.html",
    "collected_at": "2025-11-09T20:05:18.518964Z",
    "external_id": null,
    "title_hint": null,
    "language_hint": "no",
    "captured_at": null,
    "checksum": "cfaef821e18214957eaa3c76628c13250f8ac43362a40b8ab518a8510753e6f8",
    "status": "pending",
    "notes": {
      "batch_id": null
    }
  },
  "note": {
    "id": "02aba99b-f4e4-44f8-a4f9-dc2faaf89b9d",
    "ingest_source_id": "524da1b8-b49a-46a3-ae91-4153bbb9c4fd",
    "canonical_title": "以预测股票涨跌案例入门基于SVM的机器学习",
    "language": "no",
    "ingested_at": "2025-11-09T20:05:18.518970Z",
    "created_at": null,
    "status": "active",
    "importance": 0,
    "attributes": {
      "source_filename": "以预测股票涨跌案例入门基于SVM的机器学习.html"
    }
  },
  "variants": [
    {
      "id": "5adf2571-bb29-4137-8827-ab860abe0105",
      "note_id": "02aba99b-f4e4-44f8-a4f9-dc2faaf89b9d",
      "variant_type": "raw_html",
      "version": 1,
      "created_by": "evernote_ingest:v0",
      "created_at": "2025-11-09T20:05:18.518973Z",
      "content": "---\ntitle: 以预测股票涨跌案例入门基于SVM的机器学习\nupdated: 2021-06-16 22:45:12Z\ncreated: 2021-06-16 22:44:40Z\nauthor: tangyongfeng@gmail.com\n---\n\n\n<en-note><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"color: rgb(8, 8, 8); font-family: &quot;pingfang SC&quot;; --inversion-type-color: simple;\"><a HREF=\"https://cloud.tencent.com/developer/article/1515304\">https://cloud.tencent.com/developer/article/1515304</a></span><br/></div><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">SVM是Support Vector Machine的缩写，中文叫支持向量机，通过它可以对样本数据进行分类。以股票为例，SVM能根据若干特征样本数据，把待预测的目标结果划分成&ldquo;涨&rdquo;和&rdquo;跌&rdquo;两种，从而实现预测股票涨跌的效果。\n</span></div><h4 STYLE=\"padding: 0px; font-size: 14px; box-sizing: border-box; color: rgb(0, 0, 0); font-weight: bold; font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);\"><span STYLE=\"font-size: 14px; box-sizing: border-box; color: rgb(0, 0, 0); font-weight: bold; font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);\">1 通过简单案例了解SVM的分类作用\n</span></h4><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">在Sklearn库里，封装了SVM分类的相关方法，也就是说，我们无需了解其中复杂的算法，即可用它实现基于SVM的分类。通过如下SimpleSVMDemo.py案例，我们来看下通过SVM库实现分类的做法，以及相关方法的调用方式。\n</span></div><div STYLE=\"box-sizing: border-box; padding: 1em; color: rgb(204, 204, 204); background-color: rgb(80, 85, 107); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; overflow: auto; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; overflow-wrap: normal; text-align: left; white-space: pre; word-spacing: 0px; word-break: normal; line-height: 1.5; tab-size: 4; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; -webkit-text-stroke-width: 0px;\"><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1</span>&nbsp;&nbsp;&nbsp; #<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">!</span><span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">/</span>usr<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">/</span>bin<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">/</span>env python</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">2</span>&nbsp;&nbsp;&nbsp; #coding<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span>utf<span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">-8</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">3</span>&nbsp;&nbsp;&nbsp; <span STYLE=\"box-sizing: border-box; color: rgb(204, 153, 205);\">import</span> numpy <span STYLE=\"box-sizing: border-box; color: rgb(204, 153, 205);\">as</span> np</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">4</span>&nbsp;&nbsp;&nbsp; <span STYLE=\"box-sizing: border-box; color: rgb(204, 153, 205);\">import</span> matplotlib<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span>pyplot <span STYLE=\"box-sizing: border-box; color: rgb(204, 153, 205);\">as</span> plt</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">5</span>&nbsp;&nbsp;&nbsp; <span STYLE=\"box-sizing: border-box; color: rgb(204, 153, 205);\">from</span> sklearn <span STYLE=\"box-sizing: border-box; color: rgb(204, 153, 205);\">import</span> svm</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">6</span>&nbsp;&nbsp;&nbsp; #给出平面上的若干点</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">7</span>&nbsp;&nbsp;&nbsp; points <span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span> np<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span>r_<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">-</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1.5</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1.5</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1.8</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0.2</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0.8</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0.7</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">2.2</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">2.8</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">2.5</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">3.5</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">4</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">2</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">8</span>&nbsp;&nbsp;&nbsp; #按<span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0</span>和<span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1</span>标记成两类</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">9</span>&nbsp;&nbsp;&nbsp; typeName <span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span> <span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span></div></div><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">在第5行里，我们引入了基于SVM的库。在第7行，我们定义了若干个点，并在第9行把这些点分成了两类，比如[-1,1]点是第一类，而[4,2]是第二类。\n</span></div><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">这里请注意，在第7行定义点的时候，是通过np.r_方法，把数据转换成&ldquo;列矩阵&rdquo;，这样做的目的是让数据结构满足fit方法的要求。\n</span></div><div STYLE=\"box-sizing: border-box; padding: 1em; color: rgb(204, 204, 204); background-color: rgb(80, 85, 107); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; overflow: auto; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; overflow-wrap: normal; text-align: left; white-space: pre; word-spacing: 0px; word-break: normal; line-height: 1.5; tab-size: 4; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; -webkit-text-stroke-width: 0px;\"><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">10</span>&nbsp; #建立模型</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">11</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; svmTool <span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span> svm<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">SVC</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span>kernel<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;linear&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">12</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; svmTool<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">fit</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span>points<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span>typeName<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span>&nbsp; #传入参数</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">13</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #确立分类的直线</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">14</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sample <span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span> svmTool<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span>coef_<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span> #系数</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; slope <span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span> <span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">-</span>sample<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">/</span>sample<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span>&nbsp; #斜率</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lineX <span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span> np<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">arange</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span><span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">-</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">2</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">5</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span>#获取<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">-</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">2</span>到<span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">5</span>，间距是<span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1</span>的若干数据</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">17</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lineY <span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span> slope<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">*</span>lineX<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">-</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span>svmTool<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span>intercept_<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span><span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">/</span>sample<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span></div></div><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">　　在第11行里，我们创建了基于SVM的对象，并指定该SVM模型采用比较常用的&ldquo;线性核&rdquo;来实现分类操作。\n</span></div><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">在第14行，通过fit训练样本。这里fit方法和之前基于线性回归案例中的fit方法是一样的，只不过这里是基于线性核的相关算法，而之前是基于线性回归的相关算法（比如最小二乘法）。训练完成后，通过第14行和第15行的代码，我们得到了能分隔两类样本的直线，包括直线的斜率和截距，并通过第16行和第17行的代码设置了分隔线的若干个点。\n</span></div><div STYLE=\"box-sizing: border-box; padding: 1em; color: rgb(204, 204, 204); background-color: rgb(80, 85, 107); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; overflow: auto; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; overflow-wrap: normal; text-align: left; white-space: pre; word-spacing: 0px; word-break: normal; line-height: 1.5; tab-size: 4; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; -webkit-text-stroke-width: 0px;\"><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">18</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #画出划分直线</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">19</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; plt<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">plot</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span>lineX<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span>lineY<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span>color<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;blue&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span>label<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;Classified Line&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; plt<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">legend</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span>loc<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;best&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span> #绘制图例</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">21</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; plt<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">scatter</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span>points<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">:</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span>points<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">:</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span>c<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;R&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">22</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; plt<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">show</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span></div></div><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">　　计算完成后，我们通过第19行的plot方法绘制了分隔线，并在第21行通过scatter方法绘制所有的样本点。由于points是&ldquo;列矩阵&rdquo;的数据结构，所以是用points[:,0]来获取绘制点的 x坐标，用points[:,1]来获取y坐标，最后是通过第22行的show方法绘制图形。运行上述代码，我们能看到如下图13.8的效果，从中我们能看到，蓝色的边界线能有效地分隔两类样本。\n</span></div><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">从这个例子中我们能看到，SVM的作用是，根据样本，训练出能划分不同种类数据的边界线，由此实现&ldquo;分类&rdquo;的效果。而且，在根据训练样本确定好边界线的参数后，还能根据其它没有明确种类样本，计算出它的种类，以此实现&ldquo;预测&rdquo;效果。\n</span></div><h4 STYLE=\"padding: 0px; font-size: 14px; box-sizing: border-box; color: rgb(0, 0, 0); font-weight: bold; font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);\"><span STYLE=\"font-size: 14px; box-sizing: border-box; color: rgb(0, 0, 0); font-weight: bold; font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);\">2 数据标准化处理\n</span></h4><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">标准化（normalization）处理是将特征样本按一定算法进行缩放，让它们落在某个范围比较小的区间，同时去掉单位限制，让样本数据转换成无量纲的纯数值。\n</span></div><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">在用机器学习方法进行训练时，一般需要进行标准化处理，原因是Sklearn等库封装的一些机器学习算法对样本有一定的要求，如果有些特征值的数量级偏离大多数特征值的数量级，或者有特征值偏离正态分布，那么预测结果会不准确。\n</span></div><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">需要说明的是，虽然在训练前对样本进行了标准化处理，改变了样本值，但由于在标准化的过程中是用同一个算法对全部样本进行转换，属于&ldquo;数据优化&rdquo;，不会对后继的训练起到不好的作用。\n</span></div><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">这里我们是通过sklearn库提供的preprocessing.scale方法实现标准化，该方法是让特征值减去平均值然后除以标准差。通过如下ScaleDemo.py案例，我们实际用下preprocessing.scale方法。\n</span></div><div STYLE=\"box-sizing: border-box; padding: 1em; color: rgb(204, 204, 204); background-color: rgb(80, 85, 107); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; overflow: auto; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; overflow-wrap: normal; text-align: left; white-space: pre; word-spacing: 0px; word-break: normal; line-height: 1.5; tab-size: 4; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; -webkit-text-stroke-width: 0px;\"><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">!</span><span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">/</span>usr<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">/</span>bin<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">/</span>env python</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">2</span> #coding<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span>utf<span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">-8</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">3</span> <span STYLE=\"box-sizing: border-box; color: rgb(204, 153, 205);\">from</span> sklearn <span STYLE=\"box-sizing: border-box; color: rgb(204, 153, 205);\">import</span> preprocessing</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">4</span> <span STYLE=\"box-sizing: border-box; color: rgb(204, 153, 205);\">import</span> numpy <span STYLE=\"box-sizing: border-box; color: rgb(204, 153, 205);\">as</span> np</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">5</span> </div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">6</span> origVal <span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span> np<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">array</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">10</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">5</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">3</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">8</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">6</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">12</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">14</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">7</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">15</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">9</span> #计算均值</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">10</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; avgOrig <span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span> origVal<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">mean</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span>axis<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">11</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #计算标准差</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">12</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stdOrig<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span>origVal<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">std</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span>axis<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">13</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #减去均值，除以标准差</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">14</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">print</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span>origVal<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">-</span>avgOrig<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span><span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">/</span>stdOrig<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; scaledVal<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span>preprocessing<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">scale</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span>origVal<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #直接输出preprocessing<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span>scale后的结果</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">17</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">print</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span>scaledVal<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span></div></div><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">　　在第6行里，我们初始化了一个长宽各为3的矩阵，在第10行，通过mean方法计算了该矩阵的均值，在第12行则通过std方法计算标准差。\n</span></div><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">第14行是用原始值减去均值，再除以标准差，在第17行，是直接输出preprocessing.scale的结果。第14行和第17行的输出结果相同，均是下值，从中我们验证了标准化的具体做法。\n</span></div><div STYLE=\"box-sizing: border-box; padding: 1em; color: rgb(204, 204, 204); background-color: rgb(80, 85, 107); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; overflow: auto; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; overflow-wrap: normal; text-align: left; white-space: pre; word-spacing: 0px; word-break: normal; line-height: 1.5; tab-size: 4; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; -webkit-text-stroke-width: 0px;\"><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">-</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0.26726124</span> <span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">-</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1.22474487</span> <span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">-</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1.37281295</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">2</span>&nbsp; <span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">-</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1.06904497</span>&nbsp; <span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0.39223227</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">3</span>&nbsp; <span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span> <span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1.33630621</span>&nbsp; <span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1.22474487</span>&nbsp; <span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0.98058068</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span></div></div><h4 STYLE=\"padding: 0px; font-size: 14px; box-sizing: border-box; color: rgb(0, 0, 0); font-weight: bold; font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);\"><span STYLE=\"font-size: 14px; box-sizing: border-box; color: rgb(0, 0, 0); font-weight: bold; font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);\">3 预测股票涨跌\n</span></h4><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">在之前的案例中，我们用基于SVM的方法，通过一维直线来分类二维的点。据此可以进一步推论：通过基于SVM的方法，我们还可以分类具有多个特征值的样本。\n</span></div><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">比如可以通过开盘价、收盘价、最高价、最低价和成交量等特征值，用SVM的算法训练出这些特征值和股票&ldquo;涨&ldquo;和&ldquo;跌&ldquo;的关系，即通过特征值划分指定股票&ldquo;涨&rdquo;和&ldquo;跌&rdquo;的边界，这样的话，一旦输入其它的股票特征数据，即可预测出对应的涨跌情况。在如下的PredictStockBySVM.py案例中，我们给出了基于SVM预测股票涨跌的功能。\n</span></div><div STYLE=\"box-sizing: border-box; padding: 1em; color: rgb(204, 204, 204); background-color: rgb(80, 85, 107); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; overflow: auto; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; overflow-wrap: normal; text-align: left; white-space: pre; word-spacing: 0px; word-break: normal; line-height: 1.5; tab-size: 4; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; -webkit-text-stroke-width: 0px;\"><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">!</span><span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">/</span>usr<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">/</span>bin<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">/</span>env python</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">2</span> #coding<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span>utf<span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">-8</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">3</span> <span STYLE=\"box-sizing: border-box; color: rgb(204, 153, 205);\">import</span> pandas <span STYLE=\"box-sizing: border-box; color: rgb(204, 153, 205);\">as</span> pd </div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">4</span> <span STYLE=\"box-sizing: border-box; color: rgb(204, 153, 205);\">from</span> sklearn <span STYLE=\"box-sizing: border-box; color: rgb(204, 153, 205);\">import</span> svm<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span>preprocessing</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">5</span> <span STYLE=\"box-sizing: border-box; color: rgb(204, 153, 205);\">import</span> matplotlib<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span>pyplot <span STYLE=\"box-sizing: border-box; color: rgb(204, 153, 205);\">as</span> plt</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">6</span> origDf<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span>pd<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">read_csv</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;D:/stockData/ch13/6035052018-09-012019-05-31.csv&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span>encoding<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;gbk&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">7</span> df<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span>origDf<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;Close&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span> <span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;Low&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;Open&apos;</span> <span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;Vol&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;Date&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">8</span> #diff列表示本日和上日收盘价的差</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">9</span> df<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;diff&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span> <span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span> df<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&quot;Close&quot;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">-</span>df<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&quot;Close&quot;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">shift</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">10</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; df<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;diff&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">fillna</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span> inplace <span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span> True<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">11</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #up列表示本日是否上涨<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1</span>表示涨，<span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0</span>表示跌</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">12</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; df<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;up&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span> <span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span> df<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;diff&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span>&nbsp;&nbsp; </div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">13</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; df<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;up&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span>df<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;diff&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">&gt;</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span> <span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span> <span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">14</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; df<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;up&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span>df<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;diff&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">&lt;=</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span> <span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span> <span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #预测值暂且初始化为<span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; df<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;predictForUp&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span> <span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span> <span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0</span></div></div><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">　 第6行里，我们从指定文件读取了包含股票信息的csv文件，该csv格式的文件其实是从网络数据接口获取得到的，具体做法可以参考前面博文。\n</span></div><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">从第9行里，我们设置了df的diff列为本日收盘价和前日收盘价的差值，通过第12行到第14行的代码，我们设置了up列的值，具体是，如果当日股票上涨，即本日收盘价大于前日收盘价，则up值是1，反之如果当日股票下跌，up值则为0。\n</span></div><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">在第16行里，我们在df对象里新建了表示预测结果的predictForUp列，该列的值暂且都设置为0，在后继的代码里，将根据预测结果填充这列的值。\n</span></div><div STYLE=\"box-sizing: border-box; padding: 1em; color: rgb(204, 204, 204); background-color: rgb(80, 85, 107); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; overflow: auto; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; overflow-wrap: normal; text-align: left; white-space: pre; word-spacing: 0px; word-break: normal; line-height: 1.5; tab-size: 4; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; -webkit-text-stroke-width: 0px;\"><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">17</span>&nbsp;&nbsp;&nbsp; #目标值是真实的涨跌情况</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">18</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; target <span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span> df<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;up&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">19</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; length<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">len</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span>df<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trainNum<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">int</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span>length<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">*</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0.8</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">21</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; predictNum<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span>length<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">-</span>trainNum</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">22</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #选择指定列作为特征列</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">23</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; feature<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span>df<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;Close&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span> <span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;High&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span> <span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;Low&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;Open&apos;</span> <span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;Volume&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">24</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #标准化处理特征值</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; feature<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span>preprocessing<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">scale</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span>feature<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span></div></div><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">　　在第18行里，我们设置训练目标值是表示涨跌情况的up列，在第20行，设置了训练集的数量是总量的80%，在第23行则设置了训练的特征值，请注意这里去掉了日期这个不相关的列，而且，在第25行，对特征值进行了标准化处理。\n</span></div><div STYLE=\"box-sizing: border-box; padding: 1em; color: rgb(204, 204, 204); background-color: rgb(80, 85, 107); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; overflow: auto; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; overflow-wrap: normal; text-align: left; white-space: pre; word-spacing: 0px; word-break: normal; line-height: 1.5; tab-size: 4; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; -webkit-text-stroke-width: 0px;\"><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">26</span>&nbsp;&nbsp;&nbsp; #训练集的特征值和目标值</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">27</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; featureTrain<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span>feature<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">:</span>trainNum<span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">-1</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">28</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; targetTrain<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span>target<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">:</span>trainNum<span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">-1</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">29</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; svmTool <span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span> svm<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">SVC</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span>kernel<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;liner&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; svmTool<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">fit</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span>featureTrain<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span>targetTrain<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span></div></div><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">　　在第27行和第28行里，我们通过截取指定行的方式，得到了特征值和目标值的训练集，在第26行里，以线性核的方式创建了SVM分类器对象svmTool。\n</span></div><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">在第30行里，通过fit方法，用特征值和目标值的训练集训练svmTool分类对象。从上文里我们已经看到，训练所用的特征值是开盘收盘价、最高最低价和成交量，训练所用的目标值是描述涨跌情况的up列。在训练完成后，svmTool对象中就包含了能划分股票涨跌的相关参数。\n</span></div><div STYLE=\"box-sizing: border-box; padding: 1em; color: rgb(204, 204, 204); background-color: rgb(80, 85, 107); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; overflow: auto; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; overflow-wrap: normal; text-align: left; white-space: pre; word-spacing: 0px; word-break: normal; line-height: 1.5; tab-size: 4; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; -webkit-text-stroke-width: 0px;\"><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">31</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; predictedIndex<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span>trainNum</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #逐行预测测试集</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">33</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span STYLE=\"box-sizing: border-box; color: rgb(204, 153, 205);\">while</span> predictedIndex<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">&lt;</span>length<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">:</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">34</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; testFeature<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span>feature<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span>predictedIndex<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">:</span>predictedIndex<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">+</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; predictForUp<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span>svmTool<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">predict</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span>testFeature<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span>&nbsp;&nbsp;&nbsp; </div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">36</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; df<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span>ix<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span>predictedIndex<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;predictForUp&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span>predictForUp&nbsp;&nbsp;&nbsp; </div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">37</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; predictedIndex <span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span> predictedIndex<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">+</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">1</span></div></div><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">在第33行的while循环里，我们通过predictedIndex索引值，依次遍历测试集。\n</span></div><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">在遍历过程中，通过第35行的predict方法，用训练好的svmTool分类器，逐行预测测试集中的股票涨跌情况，并在第36行里，把预测结果设置到df对象的predictForUp列中。　　\n</span></div><div STYLE=\"box-sizing: border-box; padding: 1em; color: rgb(204, 204, 204); background-color: rgb(80, 85, 107); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; overflow: auto; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; overflow-wrap: normal; text-align: left; white-space: pre; word-spacing: 0px; word-break: normal; line-height: 1.5; tab-size: 4; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; -webkit-text-stroke-width: 0px;\"><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">38</span>&nbsp;&nbsp;&nbsp; #该对象只包含预测数据，即只包含测试集</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">39</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dfWithPredicted <span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span> df<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span>trainNum<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">:</span>length<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #开始绘图，创建两个子图</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">41</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; figure <span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span> plt<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">figure</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">42</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #创建子图&nbsp;&nbsp;&nbsp;&nbsp; </div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">43</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span>axClose<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span> axUpOrDown<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span> <span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span> figure<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">subplots</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">2</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span> sharex<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span>True<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">44</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dfWithPredicted<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;Close&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">plot</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span>ax<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span>axClose<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dfWithPredicted<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;predictForUp&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">plot</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span>ax<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span>axUpOrDown<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span>color<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&quot;red&quot;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span> label<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;Predicted Data&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">46</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dfWithPredicted<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;up&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">plot</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span>ax<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span>axUpOrDown<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span>color<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&quot;blue&quot;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span>label<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;Real Data&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">47</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; plt<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">legend</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span>loc<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;best&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span> #绘制图例</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">48</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #设置x轴坐标标签和旋转角度</div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">49</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; major_index<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span>dfWithPredicted<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span>index<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span>dfWithPredicted<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span>index<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">%</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">2</span><span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">==</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; major_xtics<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span>dfWithPredicted<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;Date&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span>dfWithPredicted<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span>index<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">%</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">2</span><span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">==</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">0</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">51</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; plt<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">xticks</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span>major_index<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span>major_xtics<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">52</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; plt<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">setp</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span>plt<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">gca</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">get_xticklabels</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">,</span> rotation<span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">30</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span> </div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; plt<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">title</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&quot;通过SVM预测603505的涨跌情况&quot;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">54</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; plt<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span>rcParams<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;font.sans-serif&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span><span STYLE=\"box-sizing: border-box; color: rgb(103, 205, 204);\">=</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">[</span><span STYLE=\"box-sizing: border-box; color: rgb(126, 198, 153);\">&apos;SimHei&apos;</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">]</span></div><div><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; plt<span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">.</span><span STYLE=\"box-sizing: border-box; color: rgb(240, 141, 73);\">show</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">(</span><span STYLE=\"box-sizing: border-box; color: rgb(204, 204, 204);\">)</span></div></div><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">　由于在之前的代码里，我们只设置测试集的predictForUp列，并没有设置训练集的该列数据，所以在第39行里，用切片的手段，把测试集数据放置到dfWithPredicted对象中，请注意这里切片的起始和结束值是测试集的起始和结束索引值。至此完成了数据准备工作，在之后的代码里，我们将用matplotlib库开始绘图。\n</span></div><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">在第43行里，我们通过subplots方法设置了两个子图，并通过sharex=True让这两个子图的x轴具有相同的刻度和标签。在第44行代码里，在axClose子图中，我们用plot方法绘制了收盘价的走势。在第45行代码里，在axUpOrDown子图中，我们绘制了预测到的涨跌情况，而在第46行里，还是在axUpOrDown子图里，绘制了这些天的股票真实的涨跌情况。\n</span></div><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">在第49行到第52行的代码里，我们设置了x标签的文字以及旋转角度，这样做的目的是让标签文字看上去不至于太密集。在第53行里，我们设置了中文标题，由于要显示中文，所以需要第54行的代码，最后在55行通过show方法展示了图片。运行上述代码，能看到如下图所示的效果。\n</span></div><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">其中上图展示了收盘价，下图的蓝色线条表示真实的涨跌情况，0表示跌，1表示上涨，而红色则表示预测后的结果。\n</span></div><h4 STYLE=\"padding: 0px; font-size: 14px; box-sizing: border-box; color: rgb(0, 0, 0); font-weight: bold; font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);\"><span STYLE=\"font-size: 14px; box-sizing: border-box; color: rgb(0, 0, 0); font-weight: bold; font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);\">4 结论\n</span></h4><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">对比一下，虽有偏差，但大体相符。综上所述，本案例是数学角度，演示了通过SVM分类的做法，包括如果划分特征值和目标值，如何对样本数据进行标准化处理，如何用训练数据训练SVM，还有如何用训练后的结果预测分类结果。\n</span></div><h4 STYLE=\"padding: 0px; font-size: 14px; box-sizing: border-box; color: rgb(0, 0, 0); font-weight: bold; font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);\"><span STYLE=\"font-size: 14px; box-sizing: border-box; color: rgb(0, 0, 0); font-weight: bold; font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);\">5 总结和版权说明\n</span></h4><div STYLE=\"padding: 0px; box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;\"><span STYLE=\"box-sizing: border-box; min-height: 24px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;\">本文是给程序员加财商系列，之前还有两篇博文\n</span></div></en-note>      ",
      "content_path": null,
      "diff_base_variant_id": null,
      "metadata": {
        "checksum": "cfaef821e18214957eaa3c76628c13250f8ac43362a40b8ab518a8510753e6f8",
        "path": "/Users/tang/workbench/article-classifier/backups/2023年6月/投资/以预测股票涨跌案例入门基于SVM的机器学习.html"
      }
    },
    {
      "id": "32ce7df4-967c-4387-a8d8-14a4d83c5d6f",
      "note_id": "02aba99b-f4e4-44f8-a4f9-dc2faaf89b9d",
      "variant_type": "clean_text",
      "version": 1,
      "created_by": "evernote_ingest:v0",
      "created_at": "2025-11-09T20:05:18.518977Z",
      "content": "---\ntitle: 以预测股票涨跌案例入门基于SVM的机器学习\nupdated: 2021-06-16 22:45:12Z\ncreated: 2021-06-16 22:44:40Z\nauthor: tangyongfeng@gmail.com\n---\n\nhttps://cloud.tencent.com/developer/article/1515304\nSVM是Support Vector Machine的缩写，中文叫支持向量机，通过它可以对样本数据进行分类。以股票为例，SVM能根据若干特征样本数据，把待预测的目标结果划分成“涨”和”跌”两种，从而实现预测股票涨跌的效果。\n\n1 通过简单案例了解SVM的分类作用\n\n在Sklearn库里，封装了SVM分类的相关方法，也就是说，我们无需了解其中复杂的算法，即可用它实现基于SVM的分类。通过如下SimpleSVMDemo.py案例，我们来看下通过SVM库实现分类的做法，以及相关方法的调用方式。\n\n1\n    #\n!\n/\nusr\n/\nbin\n/\nenv python\n2\n    #coding\n=\nutf\n-8\n3\n   \nimport\n numpy\nas\n np\n4\n   \nimport\n matplotlib\n.\npyplot\nas\n plt\n5\n   \nfrom\n sklearn\nimport\n svm\n6\n    #给出平面上的若干点\n7\n    points\n=\n np\n.\nr_\n[\n-\n1\n,\n1\n]\n,\n[\n1.5\n,\n1.5\n]\n,\n[\n1.8\n,\n0.2\n]\n,\n[\n0.8\n,\n0.7\n]\n,\n[\n2.2\n,\n2.8\n]\n,\n[\n2.5\n,\n3.5\n]\n,\n[\n4\n,\n2\n]\n8\n    #按\n0\n和\n1\n标记成两类\n9\n    typeName\n=\n\n[\n0\n,\n0\n,\n0\n,\n0\n,\n1\n,\n1\n,\n1\n]\n在第5行里，我们引入了基于SVM的库。在第7行，我们定义了若干个点，并在第9行把这些点分成了两类，比如[-1,1]点是第一类，而[4,2]是第二类。\n\n这里请注意，在第7行定义点的时候，是通过np.r_方法，把数据转换成“列矩阵”，这样做的目的是让数据结构满足fit方法的要求。\n\n10\n  #建立模型\n11\n        svmTool\n=\n svm\n.\nSVC\n(\nkernel\n=\n'linear'\n)\n12\n        svmTool\n.\nfit\n(\npoints\n,\ntypeName\n)\n  #传入参数\n13\n        #确立分类的直线\n14\n        sample\n=\n svmTool\n.\ncoef_\n[\n0\n]\n #系数\n15\n        slope\n=\n\n-\nsample\n[\n0\n]\n/\nsample\n[\n1\n]\n  #斜率\n16\n        lineX\n=\n np\n.\narange\n(\n-\n2\n,\n5\n,\n1\n)\n\n-\n2\n到\n5\n，间距是\n1\n的若干数据\n17\n        lineY\n=\n slope\n*\nlineX\n-\n(\nsvmTool\n.\nintercept_\n[\n0\n]\n)\n/\nsample\n[\n1\n]\n　　在第11行里，我们创建了基于SVM的对象，并指定该SVM模型采用比较常用的“线性核”来实现分类操作。\n\n在第14行，通过fit训练样本。这里fit方法和之前基于线性回归案例中的fit方法是一样的，只不过这里是基于线性核的相关算法，而之前是基于线性回归的相关算法（比如最小二乘法）。训练完成后，通过第14行和第15行的代码，我们得到了能分隔两类样本的直线，包括直线的斜率和截距，并通过第16行和第17行的代码设置了分隔线的若干个点。\n\n18\n      #画出划分直线\n19\n        plt\n.\nplot\n(\nlineX\n,\nlineY\n,\ncolor\n=\n'blue'\n,\nlabel\n=\n'Classified Line'\n)\n20\n        plt\n.\nlegend\n(\nloc\n=\n'best'\n)\n #绘制图例\n21\n        plt\n.\nscatter\n(\npoints\n[\n:\n,\n0\n]\n,\npoints\n[\n:\n,\n1\n]\n,\nc\n=\n'R'\n)\n22\n        plt\n.\nshow\n(\n)\n　　计算完成后，我们通过第19行的plot方法绘制了分隔线，并在第21行通过scatter方法绘制所有的样本点。由于points是“列矩阵”的数据结构，所以是用points[:,0]来获取绘制点的 x坐标，用points[:,1]来获取y坐标，最后是通过第22行的show方法绘制图形。运行上述代码，我们能看到如下图13.8的效果，从中我们能看到，蓝色的边界线能有效地分隔两类样本。\n\n从这个例子中我们能看到，SVM的作用是，根据样本，训练出能划分不同种类数据的边界线，由此实现“分类”的效果。而且，在根据训练样本确定好边界线的参数后，还能根据其它没有明确种类样本，计算出它的种类，以此实现“预测”效果。\n\n2 数据标准化处理\n\n标准化（normalization）处理是将特征样本按一定算法进行缩放，让它们落在某个范围比较小的区间，同时去掉单位限制，让样本数据转换成无量纲的纯数值。\n\n在用机器学习方法进行训练时，一般需要进行标准化处理，原因是Sklearn等库封装的一些机器学习算法对样本有一定的要求，如果有些特征值的数量级偏离大多数特征值的数量级，或者有特征值偏离正态分布，那么预测结果会不准确。\n\n需要说明的是，虽然在训练前对样本进行了标准化处理，改变了样本值，但由于在标准化的过程中是用同一个算法对全部样本进行转换，属于“数据优化”，不会对后继的训练起到不好的作用。\n\n这里我们是通过sklearn库提供的preprocessing.scale方法实现标准化，该方法是让特征值减去平均值然后除以标准差。通过如下ScaleDemo.py案例，我们实际用下preprocessing.scale方法。\n\n1\n       #\n!\n/\nusr\n/\nbin\n/\nenv python\n2\n #coding\n=\nutf\n-8\n3\n\nfrom\n sklearn\nimport\n preprocessing\n4\n\nimport\n numpy\nas\n np\n5\n\n6\n origVal\n=\n np\n.\narray\n(\n[\n10\n,\n5\n,\n3\n]\n,\n7\n                   \n[\n8\n,\n6\n,\n12\n]\n,\n8\n                   \n[\n14\n,\n7\n,\n15\n]\n)\n9\n #计算均值\n10\n        avgOrig\n=\n origVal\n.\nmean\n(\naxis\n=\n0\n)\n11\n        #计算标准差\n12\n        stdOrig\n=\norigVal\n.\nstd\n(\naxis\n=\n0\n)\n13\n        #减去均值，除以标准差\n14\n       \nprint\n(\norigVal\n-\navgOrig\n)\n/\nstdOrig\n)\n15\n        scaledVal\n=\npreprocessing\n.\nscale\n(\norigVal\n)\n16\n        #直接输出preprocessing\n.\nscale后的结果\n17\n       \nprint\n(\nscaledVal\n)\n　　在第6行里，我们初始化了一个长宽各为3的矩阵，在第10行，通过mean方法计算了该矩阵的均值，在第12行则通过std方法计算标准差。\n\n第14行是用原始值减去均值，再除以标准差，在第17行，是直接输出preprocessing.scale的结果。第14行和第17行的输出结果相同，均是下值，从中我们验证了标准化的具体做法。\n\n1\n     \n[\n-\n0.26726124\n\n-\n1.22474487\n\n-\n1.37281295\n]\n2\n \n[\n-\n1.06904497\n \n0\n.\n         \n0.39223227\n]\n3\n \n[\n\n1.33630621\n \n1.22474487\n \n0.98058068\n]\n3 预测股票涨跌\n\n在之前的案例中，我们用基于SVM的方法，通过一维直线来分类二维的点。据此可以进一步推论：通过基于SVM的方法，我们还可以分类具有多个特征值的样本。\n\n比如可以通过开盘价、收盘价、最高价、最低价和成交量等特征值，用SVM的算法训练出这些特征值和股票“涨“和“跌“的关系，即通过特征值划分指定股票“涨”和“跌”的边界，这样的话，一旦输入其它的股票特征数据，即可预测出对应的涨跌情况。在如下的PredictStockBySVM.py案例中，我们给出了基于SVM预测股票涨跌的功能。\n\n1\n        #\n!\n/\nusr\n/\nbin\n/\nenv python\n2\n #coding\n=\nutf\n-8\n3\n\nimport\n pandas\nas\n pd\n4\n\nfrom\n sklearn\nimport\n svm\n,\npreprocessing\n5\n\nimport\n matplotlib\n.\npyplot\nas\n plt\n6\n origDf\n=\npd\n.\nread_csv\n(\n'D:/stockData/ch13/6035052018-09-012019-05-31.csv'\n,\nencoding\n=\n'gbk'\n)\n7\n df\n=\norigDf\n[\n'Close'\n,\n\n'Low'\n,\n'Open'\n\n,\n'Vol'\n,\n'Date'\n]\n8\n #diff列表示本日和上日收盘价的差\n9\n df\n[\n'diff'\n]\n\n=\n df\n[\n\"Close\"\n]\n-\ndf\n[\n\"Close\"\n]\n.\nshift\n(\n1\n)\n10\n        df\n[\n'diff'\n]\n.\nfillna\n(\n0\n,\n inplace\n=\n True\n)\n11\n        #up列表示本日是否上涨\n,\n1\n表示涨，\n0\n表示跌\n12\n        df\n[\n'up'\n]\n\n=\n df\n[\n'diff'\n]\n  \n13\n        df\n[\n'up'\n]\n[\ndf\n[\n'diff'\n]\n>\n0\n]\n\n=\n\n1\n14\n        df\n[\n'up'\n]\n[\ndf\n[\n'diff'\n]\n<=\n0\n]\n\n=\n\n0\n15\n        #预测值暂且初始化为\n0\n16\n        df\n[\n'predictForUp'\n]\n\n=\n\n0\n　 第6行里，我们从指定文件读取了包含股票信息的csv文件，该csv格式的文件其实是从网络数据接口获取得到的，具体做法可以参考前面博文。\n\n从第9行里，我们设置了df的diff列为本日收盘价和前日收盘价的差值，通过第12行到第14行的代码，我们设置了up列的值，具体是，如果当日股票上涨，即本日收盘价大于前日收盘价，则up值是1，反之如果当日股票下跌，up值则为0。\n\n在第16行里，我们在df对象里新建了表示预测结果的predictForUp列，该列的值暂且都设置为0，在后继的代码里，将根据预测结果填充这列的值。\n\n17\n    #目标值是真实的涨跌情况\n18\n        target\n=\n df\n[\n'up'\n]\n19\n        length\n=\nlen\n(\ndf\n)\n20\n        trainNum\n=\nint\n(\nlength\n*\n0.8\n)\n21\n        predictNum\n=\nlength\n-\ntrainNum\n22\n        #选择指定列作为特征列\n23\n        feature\n=\ndf\n[\n'Close'\n,\n\n'High'\n,\n\n'Low'\n,\n'Open'\n\n,\n'Volume'\n]\n24\n        #标准化处理特征值\n25\n        feature\n=\npreprocessing\n.\nscale\n(\nfeature\n)\n　　在第18行里，我们设置训练目标值是表示涨跌情况的up列，在第20行，设置了训练集的数量是总量的80%，在第23行则设置了训练的特征值，请注意这里去掉了日期这个不相关的列，而且，在第25行，对特征值进行了标准化处理。\n\n26\n    #训练集的特征值和目标值\n27\n        featureTrain\n=\nfeature\n[\n1\n:\ntrainNum\n-1\n]\n28\n        targetTrain\n=\ntarget\n[\n1\n:\ntrainNum\n-1\n]\n29\n        svmTool\n=\n svm\n.\nSVC\n(\nkernel\n=\n'liner'\n)\n30\n        svmTool\n.\nfit\n(\nfeatureTrain\n,\ntargetTrain\n)\n　　在第27行和第28行里，我们通过截取指定行的方式，得到了特征值和目标值的训练集，在第26行里，以线性核的方式创建了SVM分类器对象svmTool。\n\n在第30行里，通过fit方法，用特征值和目标值的训练集训练svmTool分类对象。从上文里我们已经看到，训练所用的特征值是开盘收盘价、最高最低价和成交量，训练所用的目标值是描述涨跌情况的up列。在训练完成后，svmTool对象中就包含了能划分股票涨跌的相关参数。\n\n31\n        predictedIndex\n=\ntrainNum\n32\n        #逐行预测测试集\n33\n       \nwhile\n predictedIndex\n<\nlength\n:\n34\n            testFeature\n=\nfeature\n[\npredictedIndex\n:\npredictedIndex\n+\n1\n]\n           \n35\n            predictForUp\n=\nsvmTool\n.\npredict\n(\ntestFeature\n)\n   \n36\n            df\n.\nix\n[\npredictedIndex\n,\n'predictForUp'\n]\n=\npredictForUp   \n37\n            predictedIndex\n=\n predictedIndex\n+\n1\n在第33行的while循环里，我们通过predictedIndex索引值，依次遍历测试集。\n\n在遍历过程中，通过第35行的predict方法，用训练好的svmTool分类器，逐行预测测试集中的股票涨跌情况，并在第36行里，把预测结果设置到df对象的predictForUp列中。　　\n\n38\n    #该对象只包含预测数据，即只包含测试集\n39\n        dfWithPredicted\n=\n df\n[\ntrainNum\n:\nlength\n]\n40\n        #开始绘图，创建两个子图\n41\n        figure\n=\n plt\n.\nfigure\n(\n)\n42\n        #创建子图    \n43\n       \n(\naxClose\n,\n axUpOrDown\n)\n\n=\n figure\n.\nsubplots\n(\n2\n,\n sharex\n=\nTrue\n)\n44\n        dfWithPredicted\n[\n'Close'\n]\n.\nplot\n(\nax\n=\naxClose\n)\n45\n        dfWithPredicted\n[\n'predictForUp'\n]\n.\nplot\n(\nax\n=\naxUpOrDown\n,\ncolor\n=\n\"red\"\n,\n label\n=\n'Predicted Data'\n)\n46\n        dfWithPredicted\n[\n'up'\n]\n.\nplot\n(\nax\n=\naxUpOrDown\n,\ncolor\n=\n\"blue\"\n,\nlabel\n=\n'Real Data'\n)\n47\n        plt\n.\nlegend\n(\nloc\n=\n'best'\n)\n #绘制图例\n48\n        #设置x轴坐标标签和旋转角度\n49\n        major_index\n=\ndfWithPredicted\n.\nindex\n[\ndfWithPredicted\n.\nindex\n%\n2\n==\n0\n]\n50\n        major_xtics\n=\ndfWithPredicted\n[\n'Date'\n]\n[\ndfWithPredicted\n.\nindex\n%\n2\n==\n0\n]\n51\n        plt\n.\nxticks\n(\nmajor_index\n,\nmajor_xtics\n)\n52\n        plt\n.\nsetp\n(\nplt\n.\ngca\n(\n)\n.\nget_xticklabels\n(\n)\n,\n rotation\n=\n30\n)\n\n53\n        plt\n.\ntitle\n(\n\"通过SVM预测603505的涨跌情况\"\n)\n54\n        plt\n.\nrcParams\n[\n'font.sans-serif'\n]\n=\n[\n'SimHei'\n]\n55\n        plt\n.\nshow\n(\n)\n　由于在之前的代码里，我们只设置测试集的predictForUp列，并没有设置训练集的该列数据，所以在第39行里，用切片的手段，把测试集数据放置到dfWithPredicted对象中，请注意这里切片的起始和结束值是测试集的起始和结束索引值。至此完成了数据准备工作，在之后的代码里，我们将用matplotlib库开始绘图。\n\n在第43行里，我们通过subplots方法设置了两个子图，并通过sharex=True让这两个子图的x轴具有相同的刻度和标签。在第44行代码里，在axClose子图中，我们用plot方法绘制了收盘价的走势。在第45行代码里，在axUpOrDown子图中，我们绘制了预测到的涨跌情况，而在第46行里，还是在axUpOrDown子图里，绘制了这些天的股票真实的涨跌情况。\n\n在第49行到第52行的代码里，我们设置了x标签的文字以及旋转角度，这样做的目的是让标签文字看上去不至于太密集。在第53行里，我们设置了中文标题，由于要显示中文，所以需要第54行的代码，最后在55行通过show方法展示了图片。运行上述代码，能看到如下图所示的效果。\n\n其中上图展示了收盘价，下图的蓝色线条表示真实的涨跌情况，0表示跌，1表示上涨，而红色则表示预测后的结果。\n\n4 结论\n\n对比一下，虽有偏差，但大体相符。综上所述，本案例是数学角度，演示了通过SVM分类的做法，包括如果划分特征值和目标值，如何对样本数据进行标准化处理，如何用训练数据训练SVM，还有如何用训练后的结果预测分类结果。\n\n5 总结和版权说明\n\n本文是给程序员加财商系列，之前还有两篇博文",
      "content_path": null,
      "diff_base_variant_id": null,
      "metadata": {
        "language": "no",
        "length": 7796,
        "rule_count": 3,
        "applied_rules": [
          {
            "rule_id": "social_handles",
            "description": "Drop standalone social handles and hashtags",
            "note": "removed social handle only lines"
          },
          {
            "rule_id": "dedupe_lines",
            "description": "Collapse adjacent duplicate lines",
            "note": "collapsed duplicate adjacent lines"
          },
          {
            "rule_id": "whitespace",
            "description": "Normalize whitespace",
            "note": "collapsed whitespace"
          }
        ]
      }
    }
  ],
  "extractions": [],
  "journal": {
    "id": "ba606ca5-0098-4ced-86a6-c98ebcb112fa",
    "note_id": "02aba99b-f4e4-44f8-a4f9-dc2faaf89b9d",
    "stage": "ingest",
    "agent_id": "evernote_ingest:v0",
    "started_at": "2025-11-09T20:05:18.518984Z",
    "finished_at": "2025-11-09T20:05:18.518984Z",
    "status": "success",
    "input_ref": {
      "task_id": "11ae6f77-c61c-4038-a910-696a7c1a0382",
      "source_path": "/Users/tang/workbench/article-classifier/backups/2023年6月/投资/以预测股票涨跌案例入门基于SVM的机器学习.html",
      "checksum": "cfaef821e18214957eaa3c76628c13250f8ac43362a40b8ab518a8510753e6f8"
    },
    "output_ref": {
      "ingest_source": "524da1b8-b49a-46a3-ae91-4153bbb9c4fd",
      "note": "02aba99b-f4e4-44f8-a4f9-dc2faaf89b9d",
      "variants": [
        "5adf2571-bb29-4137-8827-ab860abe0105",
        "32ce7df4-967c-4387-a8d8-14a4d83c5d6f"
      ]
    },
    "error_detail": null
  }
}