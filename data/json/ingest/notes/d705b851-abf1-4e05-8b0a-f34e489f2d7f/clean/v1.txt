---
title: dataGridView
updated: 2013-06-18 04:32:46Z
created: 2013-06-16 15:11:50Z
tags:
  - c#
---

 public static readonly string SQLconnString = "Data Source=TANG-LEPTOP\\SQLEXPRESS;Initial Catalog=health;Integrated Security=True";
 
private

void

Form1_Load(

object

sender,

EventArgs

e)
        {
            dataGridView1.Columns.Add(CreateCheckInfoColumn());
        }
       
DataGridViewComboBoxColumn

CreateCheckInfoColumn()
        {
           
DataGridViewComboBoxColumn

combo =

new

DataGridViewComboBoxColumn

();
           
SqlCommand

sqlComm = InitDatabase(SQLconnString);
            sqlComm.CommandType =

CommandType
.Text;
            sqlComm.CommandText =

"select checkName from checklist;"
;
           
if

(sqlComm.Connection.State ==

ConnectionState
.Open)
            {
               
SqlDataReader

dr = sqlComm.ExecuteReader();
               
List
<

string
> _buff_list =

new

List
<

string
>();
               
while

(dr.Read())
                {
                   _buff_list.Add((

string
)dr[

"checkName"
]);
                }
                combo.DataSource = _buff_list;      
                combo.DataPropertyName =

"check info"
;
                combo.Name =

"checkinfo"
;
                sqlComm.Connection.Close();
            }
           
return

combo;
        }
       
SqlCommand

InitDatabase(

string

ConnString)
        {
           
SqlConnection

sqlConn=

new

SqlConnection

(ConnString);
            sqlConn.Open();
           
SqlCommand

sqlComm = sqlConn.CreateCommand();
           
return

sqlComm;
        }