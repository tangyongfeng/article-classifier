{
  "ingest_source": {
    "id": "2fc21783-1f1f-4f6f-a4e0-2dc2bb7af974",
    "source_type": "evernote_html",
    "source_path": "backups/2023年6月/IT技术/Pandas DataFrame数据操作.html",
    "collected_at": "2025-11-10T15:43:31.144993Z",
    "external_id": null,
    "title_hint": null,
    "language_hint": "en",
    "captured_at": null,
    "checksum": "296d914030069190cae827ba93d4d3c202aeabb4864b7a8efe74dd4747b58828",
    "status": "pending",
    "notes": {
      "batch_id": "phase2-backfill-202306"
    }
  },
  "note": {
    "id": "07aed9f3-8898-4238-8b7d-ea5f135833ae",
    "ingest_source_id": "2fc21783-1f1f-4f6f-a4e0-2dc2bb7af974",
    "canonical_title": "Pandas DataFrame数据操作",
    "language": "en",
    "ingested_at": "2025-11-10T15:43:31.145000Z",
    "created_at": null,
    "status": "active",
    "importance": 0,
    "attributes": {
      "source_filename": "Pandas DataFrame数据操作.html"
    }
  },
  "variants": [
    {
      "id": "f8d22a5d-1c45-4ded-95a8-f36cd0765f3b",
      "note_id": "07aed9f3-8898-4238-8b7d-ea5f135833ae",
      "variant_type": "raw_html",
      "version": 1,
      "created_by": "evernote_ingest:v0",
      "created_at": "2025-11-10T15:43:31.145004Z",
      "content": "---\ntitle: Pandas DataFrame数据操作\nupdated: 2022-10-07 11:11:53Z\ncreated: 2021-06-22 20:16:28Z\nauthor: tangyongfeng@gmail.com\ntags:\n  - pandas\n  - python\n---\n\n\n<en-note><div><b><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\">一、显示和数据获得</span></span></span></b></div><div><br/></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\">&nbsp;&nbsp; 第一列&nbsp; 第二列&nbsp; 第三列</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> 0&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 7 &nbsp; 12</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> 1&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 8 &nbsp; 13</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> 2&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp; 9 &nbsp; 14</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> 3&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp; 0 &nbsp; 15</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> 4&nbsp;&nbsp;&nbsp; 5 &nbsp; 10 &nbsp; 16</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> 5&nbsp;&nbsp;&nbsp; 6 &nbsp; 11 &nbsp; 17</span></span></span></div><div><br/></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">1、获得整行 ,df[2:3] &nbsp; 注，[2:3]为行号</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">2、获得整列,df[&ldquo;第二列&ldquo;] &nbsp; 注,列名</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">3、获得具体数值，</span></span> <span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\">df.at[4<span STYLE=\"color:rgb(0, 0, 0);\">,&apos;第三列&rsquo;]</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\">4、获得最后一行，df.</span></span></span><span STYLE=\"color:rgb(55, 58, 60);\">iloc[-k:] </span></div><div><span STYLE=\"color:rgb(55, 58, 60);\">5、获得最后一行的某个值 </span><span STYLE=\"color:rgb(0, 0, 0);\">a.loc[a.index[-1]][&apos;第七列&apos;]</span></div><div><span STYLE=\"color:rgb(0, 0, 0);\">6、显示所有的列名&nbsp; &nbsp;  </span>df.columns.values.tolist()</div><div><br/></div><div><br/></div><div><b><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">二、添加</span></span></b></div><div><br/></div><div><br/></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">1、添加行</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\">df.loc[7]=[22,23,24] &nbsp; &nbsp; 注：其中7为索引，可以是任何值，但是不能宽度</span><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">超过列数</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">2、添加列</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\">df[&apos;第四列&apos;]=[25,26,27,28,29,30,31] 其中&ldquo;第四列&ldquo; 是新加的列名，数据长度需要和行数相同</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\">3、追加数据表</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\">data={&apos;a&apos;:[1,2,3],&apos;b&apos;:[1,2,3],&apos;c&apos;:[1,2,3],&apos;d&apos;:[1,2,3]}</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> new_df=pd.DataFrame(data)</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\">result=df.append(new_df,ignore_index=True)</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">注意：返回的结果才有意义，原数据df没有变化，和list不一样</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">可以随意追加，有相同的列则合并相同的列，没有相同的列，就把不同的列单独放置，空白数据补NaN</span></span></span></div><div><br/></div><div><br/></div><div><b><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">三、修改</span></span></b></div><div><br/></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\">df.at[4,&apos;第二列&apos;]=99 &nbsp; 可以改变所在值的数据类型</span></span></span></div><div><br/></div><div><b><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">四、搜索</span></span></b></div><div><br/></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 11px;\"><span STYLE=\"color:rgb(0, 0, 0);\">1、搜索方法</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 18px;\"><span STYLE=\"color:rgb(0, 0, 0);\">result=df.loc[<u>result[&apos;c&apos;]&gt;1,</u>&apos;d&rsquo;]</span></span></span></div><div><br/></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\">结果 &nbsp; &nbsp; &nbsp;原集 &nbsp; &nbsp; 搜索条件 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;目标列</span></span></span></div><div><br/></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 11px;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">&nbsp; &nbsp;a&nbsp; b&nbsp; c&nbsp; d</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 11px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> 0&nbsp; 1&nbsp; 1&nbsp; 1&nbsp; 1</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 11px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> 1&nbsp; 2&nbsp; 2&nbsp; 2&nbsp; 2</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 11px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> 2&nbsp; 3&nbsp; 3&nbsp; 3&nbsp; 3</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 11px;\"><span STYLE=\"color:rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; b &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; d&nbsp;&nbsp;&nbsp; c</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 11px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> 0&nbsp; -1.506916 -1.607647 -1.570993&nbsp; NaN</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 11px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> 1 &nbsp; 0.112362 -0.953487 -0.471071&nbsp; NaN</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 11px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> 2 &nbsp; 0.594953 -0.420228 -0.548113&nbsp; NaN</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 11px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> 3 &nbsp; 1.344631 -0.300843&nbsp; 1.586554&nbsp; NaN</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 11px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> 4&nbsp; -0.697381 -1.376900 -1.431262&nbsp; NaN</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 11px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> 5&nbsp; -1.134424&nbsp; 0.213686&nbsp; 0.822630&nbsp; NaN</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 11px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> 6 &nbsp; 0.697541 -0.580436 -0.657448&nbsp; NaN</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 11px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> 7&nbsp; -0.501792&nbsp; 1.038440&nbsp; 0.558066&nbsp; NaN</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 11px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> 8&nbsp; -0.810737 -0.534607 -0.623260&nbsp; NaN</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 11px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> 9 &nbsp; 0.909491 -0.537751 -0.939393&nbsp; NaN</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 11px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> 10&nbsp; 1.000000&nbsp; 1.000000&nbsp; 1.000000&nbsp; 1.0</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 11px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> 11&nbsp; 2.000000&nbsp; 2.000000&nbsp; 2.000000&nbsp; 2.0</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 11px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> 12&nbsp; 3.000000&nbsp; 3.000000&nbsp; 3.000000&nbsp; 3.0</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 11px;\"><span STYLE=\"color:rgb(0, 0, 0);\">re=result.loc[result[&apos;c&apos;]&gt;1,&apos;d&apos;]</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 11px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> 11&nbsp;&nbsp;&nbsp; 2.0</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 11px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> 12&nbsp;&nbsp;&nbsp; 3.0</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 11px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> Name: d, dtype: float64</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 11px;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">re.tolist()</span></span></span></div><div><br/></div><div><b><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">2、搜索结果</span></span></b></div><div><b><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">如果df.empty为true，则为空，反之False</span></span></b></div><div><b><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\">四、删除列</span></span></span></b></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 11px;\"><span STYLE=\"color:rgb(0, 0, 0);\">result=result.drop(index=(result.shape[0]-1))</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 11px;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">删除最后一行，注意，返回的结果才是删除之后的内容，和list不同，被可以做成了所见非所得</span></span></span></div><div><b><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\">四、表合并</span></span></span></b></div><div><br/></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\">data={</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;第一列&quot;:[1,2,3,4,5,6],</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;第五列&quot;:[32,33,34,35,36,37],</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;第六列&quot;:[38,39,40,41,42,43],</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;第七列&quot;:[44,45,46,47,48,49]</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> }</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\"> df1=pd.DataFrame(data)</span></span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\">df= (pd.merge(df,df1,on=&apos;第一列&lsquo;)) &nbsp;&nbsp;</span><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">on 为关联的那一个列</span></span></span></div><div><br/></div><div><br/></div><div><b><span STYLE=\"font-family: Menlo;\"><span STYLE=\"font-size: 14px;\"><span STYLE=\"color:rgb(0, 0, 0);\">五、存数据库</span></span></span></b></div><div STYLE=\"--en-codeblock:true;box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\"><div>pandas.read_sql(sql, con, index_col=None, coerce_float=True, params=None, parse_dates=None, columns=None, chunksize=None)</div><div><br/></div><div>DataFrame.to_sql(name, con, flavor=None, schema=None, if_exists=&apos;fail&apos;, index=True, index_label=None, chunksize=None, dtype=None)</div><div><br/></div><div>if_exists=&apos;replace&apos;，如果存在指定表(name)，则替换。</div><div>if_exists=&apos;append&apos;，如果存在指定表(name)，则追加。</div><div>if_exists=&apos;fail&apos;，如果存在指定表(name)，则写入失败。</div><div>chunksize，例如chunksize = 1000，每次处理1000条，避免数据量过大。</div><div><br/></div><div>cx = sqlite3.connect(&quot;E:/test.db&quot;)：建立与数据库的连接，如果数据库不存在则建立数据库</div><div>con = sqlite3.connect(&quot;:memory:&quot;)：将数据库建在内存中</div><div><br/></div><div>commit()：事务提交。设置isolation_level=None，则为自动提交</div><div>rollback()：事务回滚</div><div>close()：关闭一个数据库连接</div><div>cursor()：创建一个游标</div><div><br/></div><div>cu=cx.cursor()：获取游标。以下为游标方法：</div><div><br/></div><div>execute()：执行sql语句</div><div>executemany：执行多条sql语句</div><div>close()：关闭游标</div><div>fetchone()：从结果中取一条记录，并将游标指向下一条记录</div><div>fetchmany()：从结果中取多条记录</div><div>fetchall()：从结果中取出所有记录</div><div>scroll()：游标滚动</div></div><div><br/></div><div><b>六、读数据库</b></div><div STYLE=\"--en-codeblock:true;box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\"><div>import sqlite3</div><div>import pandas as pd</div><div>con = sqlite3.connect(&apos;./DataBase/weather_stations.db&apos;)</div><div>cursor = con.execute(&apos;select * from station_data&apos;)</div><div>rows = cursor.fetchall()</div><div>df = pd.DataFrame(rows, columns=[x[0] for x in cursor.description])</div></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">程序～～～～～～～～～～～～～～～</span></span></div><div><br/></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">import pandas as pd</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">import sqlalchemy </span></span></div><div><br/></div><div><br/></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">a=[1,2,3,4,5]</span></span></div><div><br/></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">myvar = pd.Series(a,index=[&apos;a&apos;,&apos;b&apos;,&apos;c&apos;,&apos;d&apos;,&apos;e&apos;],name=&apos;test&apos;)</span></span></div><div><br/></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (myvar[&apos;a&apos;])</span></span></div><div><br/></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">data=[{&apos;a&apos;:1,&apos;b&apos;:2},{&apos;a&apos;:5,&apos;b&apos;:10,&apos;c&apos;:20}]</span></span></div><div><br/></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">df =pd.DataFrame(data)</span></span></div><div><br/></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (df)</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (&apos;----------&apos;)</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (df.loc[0])</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (&apos;----------&apos;)</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (&apos;----------&apos;)</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (&apos;----------&apos;)</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (&apos;------显示----&apos;)</span></span></div><div><br/></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">data={</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">&nbsp;&nbsp;&nbsp;&nbsp;&quot;第一列&quot;:[1,2,3,4,5,6],</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">&nbsp;&nbsp;&nbsp;&nbsp;&quot;第二列&quot;:[7,8,9,0,10,11],</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">&nbsp;&nbsp;&nbsp;&nbsp;&quot;第三列&quot;:[12,13,14,15,16,17]</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">}</span></span></div><div><br/></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">df = pd.DataFrame(data,index=[&quot;第一行&quot;,&quot;第二行&quot;,&quot;第三行&quot;,&quot;第四行&quot;,&quot;第五行&quot;,&quot;第六行&quot;])</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">df = pd.DataFrame(data)</span></span></div><div><br/></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (df)</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (&apos;----------&apos;)</span></span></div><div><br/></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (&apos;df[&quot;第二列&quot;]&apos;)</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (df[&quot;第二列&quot;])</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (&apos;df[2:3]&apos;)</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (df[2:3])</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (&apos;df.第三列&apos;)</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (df.第三列)</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (&quot;df.at[4,&apos;第三列&apos;]&quot;)</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (df.at[4,&apos;第三列&apos;])</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (&apos;----添加------&apos;)</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">df.loc[7]=[22,23,24]</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (df)</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (&apos;----------&apos;)</span></span></div><div><br/></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">df[&apos;第四列&apos;]=[25,26,27,28,29,30,31]</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (df)</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (&apos;---------更改----------&apos;)</span></span></div><div><br/></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">df.at[4,&apos;第二列&apos;]=99</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (&quot;df.at[4,&apos;第二列&apos;]=99&quot;)</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (df)</span></span></div><div><br/></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (&apos;---------表合并----------&apos;)</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">data={</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">&nbsp;&nbsp;&nbsp;&nbsp;&quot;第一列&quot;:[1,2,3,4,5,6],</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">&nbsp;&nbsp;&nbsp;&nbsp;&quot;第五列&quot;:[32,33,34,35,36,37],</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">&nbsp;&nbsp;&nbsp;&nbsp;&quot;第六列&quot;:[38,39,40,41,42,43],</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">&nbsp;&nbsp;&nbsp;&nbsp;&quot;第七列&quot;:[44,45,46,47,48,49]</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">}</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">df1=pd.DataFrame(data)</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (df1)</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">df= (pd.merge(df,df1,on=&apos;第一列&apos;))</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (df)</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">print (&apos;---------to_sql----------&apos;)</span></span></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">conn=sqlalchemy.create_engine(&quot;mysql+</span><a HREF=\"pymysql://tang:abcd1234@db/stock?charset=utf8\" REV=\"en_rl_none\">pymysql://tang:abcd1234@db/stock?charset=utf8</a><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">&quot;)</span></span></div><div><br/></div><div><span STYLE=\"font-family: Menlo;\"><span STYLE=\"color:rgb(0, 0, 0);--inversion-type-color:simple;\">df.to_sql(&apos;test_table&apos;,con=conn,if_exists=&apos;replace&apos;,index=True)</span></span></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></en-note>      ",
      "content_path": null,
      "diff_base_variant_id": null,
      "metadata": {
        "checksum": "296d914030069190cae827ba93d4d3c202aeabb4864b7a8efe74dd4747b58828",
        "path": "backups/2023年6月/IT技术/Pandas DataFrame数据操作.html"
      }
    },
    {
      "id": "1fc9ad52-3aa3-48c2-971b-518be691e3d8",
      "note_id": "07aed9f3-8898-4238-8b7d-ea5f135833ae",
      "variant_type": "clean_text",
      "version": 1,
      "created_by": "evernote_ingest:v0",
      "created_at": "2025-11-10T15:43:31.145008Z",
      "content": "---\ntitle: Pandas DataFrame数据操作\nupdated: 2022-10-07 11:11:53Z\ncreated: 2021-06-22 20:16:28Z\nauthor: tangyongfeng@gmail.com\ntags:\n  - pandas\n  - python\n---\n\n一、显示和数据获得\n   第一列  第二列  第三列\n 0    1    7   12\n 1    2    8   13\n 2    3    9   14\n 3    4    0   15\n 4    5   10   16\n 5    6   11   17\n1、获得整行 ,df[2:3]   注，[2:3]为行号\n2、获得整列,df[“第二列“]   注,列名\n3、获得具体数值，\n\ndf.at[4\n,'第三列’]\n4、获得最后一行，df.\niloc[-k:]\n5、获得最后一行的某个值\na.loc[a.index[-1]]['第七列']\n6、显示所有的列名    \ndf.columns.values.tolist()\n二、添加\n1、添加行\ndf.loc[7]=[22,23,24]     注：其中7为索引，可以是任何值，但是不能宽度\n超过列数\n2、添加列\ndf['第四列']=[25,26,27,28,29,30,31] 其中“第四列“ 是新加的列名，数据长度需要和行数相同\n3、追加数据表\ndata={'a':[1,2,3],'b':[1,2,3],'c':[1,2,3],'d':[1,2,3]}\n new_df=pd.DataFrame(data)\nresult=df.append(new_df,ignore_index=True)\n注意：返回的结果才有意义，原数据df没有变化，和list不一样\n可以随意追加，有相同的列则合并相同的列，没有相同的列，就把不同的列单独放置，空白数据补NaN\n三、修改\ndf.at[4,'第二列']=99   可以改变所在值的数据类型\n四、搜索\n1、搜索方法\nresult=df.loc[\nresult['c']>1,\n'd’]\n结果      原集     搜索条件            目标列\n   a  b  c  d\n 0  1  1  1  1\n 1  2  2  2  2\n 2  3  3  3  3\n           a         b         d    c\n 0  -1.506916 -1.607647 -1.570993  NaN\n 1   0.112362 -0.953487 -0.471071  NaN\n 2   0.594953 -0.420228 -0.548113  NaN\n 3   1.344631 -0.300843  1.586554  NaN\n 4  -0.697381 -1.376900 -1.431262  NaN\n 5  -1.134424  0.213686  0.822630  NaN\n 6   0.697541 -0.580436 -0.657448  NaN\n 7  -0.501792  1.038440  0.558066  NaN\n 8  -0.810737 -0.534607 -0.623260  NaN\n 9   0.909491 -0.537751 -0.939393  NaN\n 10  1.000000  1.000000  1.000000  1.0\n 11  2.000000  2.000000  2.000000  2.0\n 12  3.000000  3.000000  3.000000  3.0\nre=result.loc[result['c']>1,'d']\n 11    2.0\n 12    3.0\n Name: d, dtype: float64\nre.tolist()\n2、搜索结果\n如果df.empty为true，则为空，反之False\n四、删除列\nresult=result.drop(index=(result.shape[0]-1))\n删除最后一行，注意，返回的结果才是删除之后的内容，和list不同，被可以做成了所见非所得\n四、表合并\ndata={\n        \"第一列\":[1,2,3,4,5,6],\n        \"第五列\":[32,33,34,35,36,37],\n        \"第六列\":[38,39,40,41,42,43],\n        \"第七列\":[44,45,46,47,48,49]\n }\n df1=pd.DataFrame(data)\ndf= (pd.merge(df,df1,on='第一列‘))   \non 为关联的那一个列\n五、存数据库\npandas.read_sql(sql, con, index_col=None, coerce_float=True, params=None, parse_dates=None, columns=None, chunksize=None)\nDataFrame.to_sql(name, con, flavor=None, schema=None, if_exists='fail', index=True, index_label=None, chunksize=None, dtype=None)\nif_exists='replace'，如果存在指定表(name)，则替换。\nif_exists='append'，如果存在指定表(name)，则追加。\nif_exists='fail'，如果存在指定表(name)，则写入失败。\nchunksize，例如chunksize = 1000，每次处理1000条，避免数据量过大。\ncx = sqlite3.connect(\"E:/test.db\")：建立与数据库的连接，如果数据库不存在则建立数据库\ncon = sqlite3.connect(\":memory:\")：将数据库建在内存中\ncommit()：事务提交。设置isolation_level=None，则为自动提交\nrollback()：事务回滚\nclose()：关闭一个数据库连接\ncursor()：创建一个游标\ncu=cx.cursor()：获取游标。以下为游标方法：\nexecute()：执行sql语句\nexecutemany：执行多条sql语句\nclose()：关闭游标\nfetchone()：从结果中取一条记录，并将游标指向下一条记录\nfetchmany()：从结果中取多条记录\nfetchall()：从结果中取出所有记录\nscroll()：游标滚动\n六、读数据库\nimport sqlite3\nimport pandas as pd\ncon = sqlite3.connect('./DataBase/weather_stations.db')\ncursor = con.execute('select * from station_data')\nrows = cursor.fetchall()\ndf = pd.DataFrame(rows, columns=[x[0] for x in cursor.description])\n程序～～～～～～～～～～～～～～～\nimport pandas as pd\nimport sqlalchemy\na=[1,2,3,4,5]\nmyvar = pd.Series(a,index=['a','b','c','d','e'],name='test')\nprint (myvar['a'])\ndata=[{'a':1,'b':2},{'a':5,'b':10,'c':20}]\ndf =pd.DataFrame(data)\nprint (df)\nprint ('----------')\nprint (df.loc[0])\nprint ('----------')\nprint ('------显示----')\ndata={\n    \"第一列\":[1,2,3,4,5,6],\n    \"第二列\":[7,8,9,0,10,11],\n    \"第三列\":[12,13,14,15,16,17]\n}\ndf = pd.DataFrame(data,index=[\"第一行\",\"第二行\",\"第三行\",\"第四行\",\"第五行\",\"第六行\"])\ndf = pd.DataFrame(data)\nprint (df)\nprint ('----------')\nprint ('df[\"第二列\"]')\nprint (df[\"第二列\"])\nprint ('df[2:3]')\nprint (df[2:3])\nprint ('df.第三列')\nprint (df.第三列)\nprint (\"df.at[4,'第三列']\")\nprint (df.at[4,'第三列'])\nprint ('----添加------')\ndf.loc[7]=[22,23,24]\nprint (df)\nprint ('----------')\ndf['第四列']=[25,26,27,28,29,30,31]\nprint (df)\nprint ('---------更改----------')\ndf.at[4,'第二列']=99\nprint (\"df.at[4,'第二列']=99\")\nprint (df)\nprint ('---------表合并----------')\ndata={\n    \"第一列\":[1,2,3,4,5,6],\n    \"第五列\":[32,33,34,35,36,37],\n    \"第六列\":[38,39,40,41,42,43],\n    \"第七列\":[44,45,46,47,48,49]\n}\ndf1=pd.DataFrame(data)\nprint (df1)\ndf= (pd.merge(df,df1,on='第一列'))\nprint (df)\nprint ('---------to_sql----------')\nconn=sqlalchemy.create_engine(\"mysql+\npymysql://tang:abcd1234@db/stock?charset=utf8\n\")\ndf.to_sql('test_table',con=conn,if_exists='replace',index=True)",
      "content_path": null,
      "diff_base_variant_id": null,
      "metadata": {
        "language": "en",
        "length": 4328,
        "rule_count": 2,
        "applied_rules": [
          {
            "rule_id": "dedupe_lines",
            "description": "Collapse adjacent duplicate lines",
            "note": "collapsed duplicate adjacent lines"
          },
          {
            "rule_id": "whitespace",
            "description": "Normalize whitespace",
            "note": "collapsed whitespace"
          }
        ]
      }
    }
  ],
  "extractions": [],
  "journal": {
    "id": "4b0ffcac-6c3c-4c78-bcfb-b61342ea46c0",
    "note_id": "07aed9f3-8898-4238-8b7d-ea5f135833ae",
    "stage": "ingest",
    "agent_id": "evernote_ingest:v0",
    "started_at": "2025-11-10T15:43:31.145015Z",
    "finished_at": "2025-11-10T15:43:31.145015Z",
    "status": "success",
    "input_ref": {
      "task_id": "2e9f72b7-3bc2-4c0f-bd82-e2b662d1de6a",
      "source_path": "backups/2023年6月/IT技术/Pandas DataFrame数据操作.html",
      "checksum": "296d914030069190cae827ba93d4d3c202aeabb4864b7a8efe74dd4747b58828"
    },
    "output_ref": {
      "ingest_source": "2fc21783-1f1f-4f6f-a4e0-2dc2bb7af974",
      "note": "07aed9f3-8898-4238-8b7d-ea5f135833ae",
      "variants": [
        "f8d22a5d-1c45-4ded-95a8-f36cd0765f3b",
        "1fc9ad52-3aa3-48c2-971b-518be691e3d8"
      ]
    },
    "error_detail": null
  }
}