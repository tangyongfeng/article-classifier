---
title: GSM Hacker详解(SMS) | Jarett's Blog
updated: 2016-04-02 16:13:07Z
created: 2016-04-02 16:13:07Z
source: https://www.nigesb.com/gsm-hacker-abhout-sms-sniffer.html
---

最近GSM的话题又被炒了起来，顺便带火了我去年的一篇文章，都是几年前的东西了，重提也没什么意思。因为一直觉得这个话题很敏感，所以也不喜欢说啥，但是最近有人已经在乌云发了，但是有些地方语焉不详。反正都已经公开了，那么我就说细点了。更讨厌的是某些组织长期只发截图不发细节，呵呵。

本文将以运行在虚拟机的Kali最新版本1.05为系统，实现GSM的嗅探，硬件什么的我就不具体说了，提到的那篇最火的文章已经提过了，我用的就是下面点破东西。

?
Moto C188手机一部
手机配套耳机线一根
杜邦线若干
CP2102模块一个

我的连接线是自己通过DIY手机的耳机制作而成的，看起来很山寨外带一点DIY感，恩，现在貌似有现成的卖，10块钱，贵是贵，省了不少事，自己看着办了。

首先的首先需要建立Arm代码的编译环境，没有编译环境，就无法对osmocombb等进行编译了。可以参照这个文档：

http://bb.osmocom.org/trac/wiki/GnuArmToolchain

不过有些步骤上面的文档还是漏掉的了可能会导致后面的编译失败，下面贴上完整的步骤，默认目录在Root下：

2015年12月11日更新：使用了第三个版本的脚本，在Kali2下测试通过

?
sudo

apt-get
install

build-essential libgmp3-dev libmpfr-dev libx11-6 libx11-dev texinfo flex bison libncurses5 libncurses5-dbg libncurses5-dev libncursesw5 libncursesw5-dbg libncursesw5-dev zlibc zlib1g-dev libmpfr4 libmpc-dev
mkdir

armtoolchain
cd

armtoolchain/
wget http:
//bb
.osmocom.org
/trac/raw-attachment/wiki/GnuArmToolchain/gnu-arm-build
.3.sh
mkdir

build
install

src
cd

src
wget http:
//ftp
.gnu.org
/gnu/gcc/gcc-4
.8.2
/gcc-4
.8.2.
tar
.bz2
wget http:
//ftp
.gnu.org
/gnu/binutils/binutils-2
.21.1a.
tar
.bz2
wget
ftp
:
//sources
.redhat.com
/pub/newlib/newlib-1
.19.0.
tar
.gz
cd

..
.
/gnu-arm-build
.3.sh

看到提示

?
Press ^C now if you do NOT want to do this.

回车，然后漫长地等待后，叫你把路径加入系统变量，简单

?
echo

"export PATH=\$PATH:/root/armtoolchain/install/bin"
>>
/root/
.bashrc
source

/root/
.bashrc

最后一句不执行的话，系统变量不会马上生效，会导致后面的编译失败。接着开始把osmocombb的源码git到本地并且选择好需要的分支进行编译。

?
cd

~ 
git clone git:
//git
.osmocom.org
/osmocom-bb
.git 
git clone git:
//git
.osmocom.org
/libosmocore
.git
cd

~
/libosmocore
sudo

apt-get
install

build-essential libtool shtool autoconf automake git-core pkg-config
make

gcc libpcsclite-dev libtalloc-dev
autoreconf -i 
.
/configure
 
make
 
sudo

make

install
cd

~
/osmocom-bb
 
git checkout --track origin
/luca/gsmmap
cd

src 
make

到此，我们前戏就算完成了，可以插入了，小心翼翼地把你的USB2TTL模块亲亲送入USB口，然后连接到虚拟机里面去。模块上面的灯应该会哔吥哔吥地一闪一闪了，使用lsmod可以看到cp2102模块。在Kali中新开4个命令行窗口，我们会需要这四个窗口来运行不同的命令。

首先在第一个窗口中输入

?
cd

~
/osmocom-bb/src/host/osmocon/
 
.
/osmocon

-m c123xor -p
/dev/ttyUSB0

../..
/target/firmware/board/compal_e88/layer1
.compalram.bin

然后轻按一下手机的小G点，也就是手机的开关键，就会发现命令行窗口中源源不断地蹦出如下字符，手机也有了显示。

第二步，扫描查找附近的基站，第二个窗口输入

?
cd

~
/osmocom-bb/src/host/layer23/src/misc/
.
/cell_log

-O

就会发现源源不断地有附近的基站信息输出了，包含了其运营商名称。

第三步，对指定信道号进行嗅探，要真的开始搞基了，但是我们的机只有一部而且是便宜货，具体理论解释可以看下面的图，因此只能一机对一信道，我们要选择某个信道号，开什么玩笑，当然是选择自己手机的信道号啦，读书人，不能乱搞。

我们需要知道自己手机目前连接基站的ARFCN，一般手机都有工程模式，以Iphone为例，在拨号键盘输入：

?
*3001#12345#*

有关ARFCN问题，上个表：

频段

名称

信道号

上行(MHz)

下行(MHz)

其他

GSM 850

GSM 850

128 – 251

824,0 – 849,0

869,0 – 894,0

美国
,
南美洲
国家 和
亚洲
部分国家。

GSM 900

P-GSM 900

1-124

890,0 – 915,0

935,0 – 960,0

GSM最先实现的频段，也是使用最广的频段。

E-GSM 900

975 – 1023

880,0 – 890,0

925,0 – 935,0

900M扩展频段

R-GSM 900

n/a

876,0 – 880,0

921,0 – 925,0

铁路GSM（GSM-R），为铁路调度通信系统开发的特殊版本。

GSM1800

GSM 1800

512 – 885

1710,0 – 1785,0

1805,0 – 1880,0

适用于对信道容量需求大的市场，应用范围仅次于900M。

GSM1900

GSM 1900

512 – 810

1850,0 – 1910,0

1930,0 – 1990,0

主要用于美洲国家，由于有频率重叠，与1800M系统不兼容。

进入工程模式后，选择GSM Cell Environment->GSM Cell Info->GSM Serving Cell,就可以看到目前手机连接的基站ARFCN值了，应该在第二步中，也能看到这个ID存在。其他手机的命令

?
Samsung (Android): *#*#197328640#*#* or *#0011#
iPhone (all): *3001#12345#*
HTC (Android): *#*#7262626#*#*

那么就大胆地丢出你的肥皂吧,把THE_ATFCN_ID换成你查到的手机正在使用的ID

?
cd

~
/osmocom-bb/src/host/layer23/src/misc/
.
/ccch_scan

-i 127.0.0.1 -a THE_ARFCN_ID

第四步，使用wireshark进行本地抓包，这时候的GSM协议已经被封装上了TCP-IP，可以在本地用wireshark抓到。

?
wireshark -k -i lo -f
'port 4729'

筛选一下，选择gsm_sms，想办法召唤一条短信过来，你就会在wireshark上看到了。恩听说很多人一买就是半打以上，周围基站一网打尽，一机对一基嘛。

你可能喜欢
GSM Hacker资料汇总
一个简单SMS解码库osomcom_sms_decode
TL-WR340G无线路由器拒绝服务漏洞
gerix wifi cracker 2发布，支持Kali和Kali 2
Linux下的RFID，简介nfc-mfclassic的使用

本文标题：
GSM Hacker详解(SMS)
本文链接：
https://www.nigesb.com/gsm-hacker-abhout-sms-sniffer.html
订阅本站：
http://www.nigesb.com/feed
转载请注明来源，如果喜欢本站可以Feed订阅本站。