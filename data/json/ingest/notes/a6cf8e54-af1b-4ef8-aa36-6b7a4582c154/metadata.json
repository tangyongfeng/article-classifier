{
  "ingest_source": {
    "id": "9683d2f1-64d5-4c8a-85d3-59736bfd5d2f",
    "source_type": "evernote_html",
    "source_path": "backups/2023年6月/IT技术/SQLiteDatabase.cs.html",
    "collected_at": "2025-11-10T15:43:31.259168Z",
    "external_id": null,
    "title_hint": null,
    "language_hint": "en",
    "captured_at": null,
    "checksum": "cb128fdda991f85645965e27d43c006b61f0223cd681f2526c482fccd03d26c1",
    "status": "pending",
    "notes": {
      "batch_id": "phase2-backfill-202306"
    }
  },
  "note": {
    "id": "a6cf8e54-af1b-4ef8-aa36-6b7a4582c154",
    "ingest_source_id": "9683d2f1-64d5-4c8a-85d3-59736bfd5d2f",
    "canonical_title": "SQLiteDatabase.cs",
    "language": "en",
    "ingested_at": "2025-11-10T15:43:31.259172Z",
    "created_at": null,
    "status": "active",
    "importance": 0,
    "attributes": {
      "source_filename": "SQLiteDatabase.cs.html"
    }
  },
  "variants": [
    {
      "id": "51a74d25-d306-4280-bc6d-d4fb656542e3",
      "note_id": "a6cf8e54-af1b-4ef8-aa36-6b7a4582c154",
      "variant_type": "raw_html",
      "version": 1,
      "created_by": "evernote_ingest:v0",
      "created_at": "2025-11-10T15:43:31.259175Z",
      "content": "---\ntitle: SQLiteDatabase.cs\nupdated: 2013-06-08 07:55:50Z\ncreated: 2013-06-08 07:55:42Z\ntags:\n  - SQLite\n  - c#\n---\n\n\n\n\n<en-note STYLE=\"word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;\">\nusing System;<br/>\nusing System.Collections.Generic;<br/>\nusing System.Data;<br/>\nusing System.Data.SQLite;<br/>\nusing System.Windows.Forms;<br/><br/>\nclass SQLiteDatabase<br/>\n{<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; String dbConnection;<br/><br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; ///&nbsp;&nbsp;&nbsp;&nbsp; Default Constructor for SQLiteDatabase Class.<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; public SQLiteDatabase()<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbConnection = &quot;Data Source=recipes.s3db&quot;;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; }<br/><br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; ///&nbsp;&nbsp;&nbsp;&nbsp; Single Param Constructor for specifying the DB file.<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=&quot;inputFile&quot;&gt;The File containing the DB&lt;/param&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; public SQLiteDatabase(String inputFile)<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbConnection = String.Format(&quot;Data Source={0}&quot;, inputFile);<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; }<br/><br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; ///&nbsp;&nbsp;&nbsp;&nbsp; Single Param Constructor for specifying advanced connection options.<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=&quot;connectionOpts&quot;&gt;A dictionary containing all desired options and their values&lt;/param&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; public SQLiteDatabase(Dictionary&lt;String, String&gt; connectionOpts)<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String str = &quot;&quot;;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach (KeyValuePair&lt;String, String&gt; row in connectionOpts)<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str += String.Format(&quot;{0}={1}; &quot;, row.Key, row.Value);<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str = str.Trim().Substring(0, str.Length - 1);<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbConnection = str;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; }<br/><br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; ///&nbsp;&nbsp;&nbsp;&nbsp; Allows the programmer to run a query against the Database.<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=&quot;sql&quot;&gt;The SQL to run&lt;/param&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;returns&gt;A DataTable containing the result set.&lt;/returns&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; public DataTable GetDataTable(string sql)<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataTable dt = new DataTable();<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SQLiteConnection cnn = new SQLiteConnection(dbConnection);<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cnn.Open();<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SQLiteCommand mycommand = new SQLiteCommand(cnn);<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mycommand.CommandText = sql;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SQLiteDataReader reader = mycommand.ExecuteReader();<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dt.Load(reader);<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reader.Close();<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cnn.Close();<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (Exception e)<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw new Exception(e.Message);<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return dt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; }<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; ///&nbsp;&nbsp;&nbsp;&nbsp; Allows the programmer to interact with the database for purposes other than a query.<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=&quot;sql&quot;&gt;The SQL to be run.&lt;/param&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;returns&gt;An Integer containing the number of rows updated.&lt;/returns&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; public int ExecuteNonQuery(string sql)<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SQLiteConnection cnn = new SQLiteConnection(dbConnection);<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cnn.Open();<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SQLiteCommand mycommand = new SQLiteCommand(cnn);<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mycommand.CommandText = sql;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int rowsUpdated = mycommand.ExecuteNonQuery();<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cnn.Close();<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return rowsUpdated;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; }<br/><br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; ///&nbsp;&nbsp;&nbsp;&nbsp; Allows the programmer to retrieve single items from the DB.<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=&quot;sql&quot;&gt;The query to run.&lt;/param&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;returns&gt;A string.&lt;/returns&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; public string ExecuteScalar(string sql)<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SQLiteConnection cnn = new SQLiteConnection(dbConnection);<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cnn.Open();<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SQLiteCommand mycommand = new SQLiteCommand(cnn);<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mycommand.CommandText = sql;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object value = mycommand.ExecuteScalar();<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cnn.Close();<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (value != null)<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return value.ToString();<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return &quot;&quot;;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; }<br/><br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; ///&nbsp;&nbsp;&nbsp;&nbsp; Allows the programmer to easily update rows in the DB.<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=&quot;tableName&quot;&gt;The table to update.&lt;/param&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=&quot;data&quot;&gt;A dictionary containing Column names and their new values.&lt;/param&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=&quot;where&quot;&gt;The where clause for the update statement.&lt;/param&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;returns&gt;A boolean true or false to signify success or failure.&lt;/returns&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; public bool Update(String tableName, Dictionary&lt;String, String&gt; data, String where)<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String vals = &quot;&quot;;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Boolean returnCode = true;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (data.Count &gt;= 1)<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach (KeyValuePair&lt;String, String&gt; val in data)<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; vals += String.Format(&quot; {0} = &apos;{1}&apos;,&quot;, val.Key.ToString(), val.Value.ToString());<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; vals = vals.Substring(0, vals.Length - 1);<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.ExecuteNonQuery(String.Format(&quot;update {0} set {1} where {2};&quot;, tableName, vals, where));<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; returnCode = false;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return returnCode;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; }<br/><br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; ///&nbsp;&nbsp;&nbsp;&nbsp; Allows the programmer to easily delete rows from the DB.<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=&quot;tableName&quot;&gt;The table from which to delete.&lt;/param&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=&quot;where&quot;&gt;The where clause for the delete.&lt;/param&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;returns&gt;A boolean true or false to signify success or failure.&lt;/returns&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; public bool Delete(String tableName, String where)<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Boolean returnCode = true;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.ExecuteNonQuery(String.Format(&quot;delete from {0} where {1};&quot;, tableName, where));<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (Exception fail)<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MessageBox.Show(fail.Message);<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; returnCode = false;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return returnCode;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; }<br/><br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; ///&nbsp;&nbsp;&nbsp;&nbsp; Allows the programmer to easily insert into the DB<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=&quot;tableName&quot;&gt;The table into which we insert the data.&lt;/param&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=&quot;data&quot;&gt;A dictionary containing the column names and data for the insert.&lt;/param&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;returns&gt;A boolean true or false to signify success or failure.&lt;/returns&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; public bool Insert(String tableName, Dictionary&lt;String, String&gt; data)<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String columns = &quot;&quot;;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String values = &quot;&quot;;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Boolean returnCode = true;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach (KeyValuePair&lt;String, String&gt; val in data)<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; columns += String.Format(&quot; {0},&quot;, val.Key.ToString());<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; values += String.Format(&quot; &apos;{0}&apos;,&quot;, val.Value);<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; columns = columns.Substring(0, columns.Length - 1);<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; values = values.Substring(0, values.Length - 1);<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.ExecuteNonQuery(String.Format(&quot;insert into {0}({1}) values({2});&quot;, tableName, columns, values));<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(Exception fail)<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MessageBox.Show(fail.Message);<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; returnCode = false;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return returnCode;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; }<br/><br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; ///&nbsp;&nbsp;&nbsp;&nbsp; Allows the programmer to easily delete all data from the DB.<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;returns&gt;A boolean true or false to signify success or failure.&lt;/returns&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; public bool ClearDB()<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataTable tables;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tables = this.GetDataTable(&quot;select NAME from SQLITE_MASTER where type=&apos;table&apos; order by NAME;&quot;);<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach (DataRow table in tables.Rows)<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.ClearTable(table[&quot;NAME&quot;].ToString());<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; }<br/><br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; ///&nbsp;&nbsp;&nbsp;&nbsp; Allows the user to easily clear all data from a specific table.<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=&quot;table&quot;&gt;The name of the table to clear.&lt;/param&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;returns&gt;A boolean true or false to signify success or failure.&lt;/returns&gt;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; public bool ClearTable(String table)<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.ExecuteNonQuery(String.Format(&quot;delete from {0};&quot;, table));<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false;<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>\n&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>\n}<br/><br/></en-note>      ",
      "content_path": null,
      "diff_base_variant_id": null,
      "metadata": {
        "checksum": "cb128fdda991f85645965e27d43c006b61f0223cd681f2526c482fccd03d26c1",
        "path": "backups/2023年6月/IT技术/SQLiteDatabase.cs.html"
      }
    },
    {
      "id": "c5d25a99-bbaf-4fef-9626-c8380b3394b9",
      "note_id": "a6cf8e54-af1b-4ef8-aa36-6b7a4582c154",
      "variant_type": "clean_text",
      "version": 1,
      "created_by": "evernote_ingest:v0",
      "created_at": "2025-11-10T15:43:31.259178Z",
      "content": "---\ntitle: SQLiteDatabase.cs\nupdated: 2013-06-08 07:55:50Z\ncreated: 2013-06-08 07:55:42Z\ntags:\n  - SQLite\n  - c#\n---\n\nusing System;\n\nusing System.Collections.Generic;\n\nusing System.Data;\n\nusing System.Data.SQLite;\n\nusing System.Windows.Forms;\n\nclass SQLiteDatabase\n\n{\n\n     String dbConnection;\n\n     /// <summary>\n\n     ///     Default Constructor for SQLiteDatabase Class.\n\n     /// </summary>\n\n     public SQLiteDatabase()\n\n     {\n\n          dbConnection = \"Data Source=recipes.s3db\";\n\n     }\n\n     /// <summary>\n\n     ///     Single Param Constructor for specifying the DB file.\n\n     /// </summary>\n\n     /// <param name=\"inputFile\">The File containing the DB</param>\n\n     public SQLiteDatabase(String inputFile)\n\n     {\n\n          dbConnection = String.Format(\"Data Source={0}\", inputFile);\n\n     }\n\n     /// <summary>\n\n     ///     Single Param Constructor for specifying advanced connection options.\n\n     /// </summary>\n\n     /// <param name=\"connectionOpts\">A dictionary containing all desired options and their values</param>\n\n     public SQLiteDatabase(Dictionary<String, String> connectionOpts)\n\n     {\n\n          String str = \"\";\n\n          foreach (KeyValuePair<String, String> row in connectionOpts)\n\n          {\n\n               str += String.Format(\"{0}={1}; \", row.Key, row.Value);\n\n          }\n\n          str = str.Trim().Substring(0, str.Length - 1);\n\n          dbConnection = str;\n\n     }\n\n     /// <summary>\n\n     ///     Allows the programmer to run a query against the Database.\n\n     /// </summary>\n\n     /// <param name=\"sql\">The SQL to run</param>\n\n     /// <returns>A DataTable containing the result set.</returns>\n\n     public DataTable GetDataTable(string sql)\n\n     {\n\n          DataTable dt = new DataTable();\n\n          try\n\n          {\n\n               SQLiteConnection cnn = new SQLiteConnection(dbConnection);\n\n               cnn.Open();\n\n               SQLiteCommand mycommand = new SQLiteCommand(cnn);\n\n               mycommand.CommandText = sql;\n\n               SQLiteDataReader reader = mycommand.ExecuteReader();\n\n               dt.Load(reader);\n\n               reader.Close();\n\n               cnn.Close();\n\n          }\n\n          catch (Exception e)\n\n          {\n\n               throw new Exception(e.Message);\n\n          }\n\n          return dt;\n\n     }\n\n     /// <summary>\n\n     ///     Allows the programmer to interact with the database for purposes other than a query.\n\n     /// </summary>\n\n     /// <param name=\"sql\">The SQL to be run.</param>\n\n     /// <returns>An Integer containing the number of rows updated.</returns>\n\n     public int ExecuteNonQuery(string sql)\n\n     {\n\n          SQLiteConnection cnn = new SQLiteConnection(dbConnection);\n\n          cnn.Open();\n\n          SQLiteCommand mycommand = new SQLiteCommand(cnn);\n\n          mycommand.CommandText = sql;\n\n          int rowsUpdated = mycommand.ExecuteNonQuery();\n\n          cnn.Close();\n\n          return rowsUpdated;\n\n     }\n\n     /// <summary>\n\n     ///     Allows the programmer to retrieve single items from the DB.\n\n     /// </summary>\n\n     /// <param name=\"sql\">The query to run.</param>\n\n     /// <returns>A string.</returns>\n\n     public string ExecuteScalar(string sql)\n\n     {\n\n          SQLiteConnection cnn = new SQLiteConnection(dbConnection);\n\n          cnn.Open();\n\n          SQLiteCommand mycommand = new SQLiteCommand(cnn);\n\n          mycommand.CommandText = sql;\n\n          object value = mycommand.ExecuteScalar();\n\n          cnn.Close();\n\n          if (value != null)\n\n          {\n\n               return value.ToString();\n\n          }\n\n          return \"\";\n\n     }\n\n     /// <summary>\n\n     ///     Allows the programmer to easily update rows in the DB.\n\n     /// </summary>\n\n     /// <param name=\"tableName\">The table to update.</param>\n\n     /// <param name=\"data\">A dictionary containing Column names and their new values.</param>\n\n     /// <param name=\"where\">The where clause for the update statement.</param>\n\n     /// <returns>A boolean true or false to signify success or failure.</returns>\n\n     public bool Update(String tableName, Dictionary<String, String> data, String where)\n\n     {\n\n          String vals = \"\";\n\n          Boolean returnCode = true;\n\n          if (data.Count >= 1)\n\n          {\n\n               foreach (KeyValuePair<String, String> val in data)\n\n               {\n\n                    vals += String.Format(\" {0} = '{1}',\", val.Key.ToString(), val.Value.ToString());\n\n               }\n\n               vals = vals.Substring(0, vals.Length - 1);\n\n          }\n\n          try\n\n          {\n\n               this.ExecuteNonQuery(String.Format(\"update {0} set {1} where {2};\", tableName, vals, where));\n\n          }\n\n          catch\n\n          {\n\n               returnCode = false;\n\n          }\n\n          return returnCode;\n\n     }\n\n     /// <summary>\n\n     ///     Allows the programmer to easily delete rows from the DB.\n\n     /// </summary>\n\n     /// <param name=\"tableName\">The table from which to delete.</param>\n\n     /// <param name=\"where\">The where clause for the delete.</param>\n\n     /// <returns>A boolean true or false to signify success or failure.</returns>\n\n     public bool Delete(String tableName, String where)\n\n     {\n\n          Boolean returnCode = true;\n\n          try\n\n          {\n\n               this.ExecuteNonQuery(String.Format(\"delete from {0} where {1};\", tableName, where));\n\n          }\n\n          catch (Exception fail)\n\n          {\n\n               MessageBox.Show(fail.Message);\n\n               returnCode = false;\n\n          }\n\n          return returnCode;\n\n     }\n\n     /// <summary>\n\n     ///     Allows the programmer to easily insert into the DB\n\n     /// </summary>\n\n     /// <param name=\"tableName\">The table into which we insert the data.</param>\n\n     /// <param name=\"data\">A dictionary containing the column names and data for the insert.</param>\n\n     /// <returns>A boolean true or false to signify success or failure.</returns>\n\n     public bool Insert(String tableName, Dictionary<String, String> data)\n\n     {\n\n          String columns = \"\";\n\n          String values = \"\";\n\n          Boolean returnCode = true;\n\n          foreach (KeyValuePair<String, String> val in data)\n\n          {\n\n               columns += String.Format(\" {0},\", val.Key.ToString());\n\n               values += String.Format(\" '{0}',\", val.Value);\n\n          }\n\n          columns = columns.Substring(0, columns.Length - 1);\n\n          values = values.Substring(0, values.Length - 1);\n\n          try\n\n          {\n\n               this.ExecuteNonQuery(String.Format(\"insert into {0}({1}) values({2});\", tableName, columns, values));\n\n          }\n\n          catch(Exception fail)\n\n          {\n\n               MessageBox.Show(fail.Message);\n\n               returnCode = false;\n\n          }\n\n          return returnCode;\n\n     }\n\n     /// <summary>\n\n     ///     Allows the programmer to easily delete all data from the DB.\n\n     /// </summary>\n\n     /// <returns>A boolean true or false to signify success or failure.</returns>\n\n     public bool ClearDB()\n\n     {\n\n          DataTable tables;\n\n          try\n\n          {\n\n               tables = this.GetDataTable(\"select NAME from SQLITE_MASTER where type='table' order by NAME;\");\n\n               foreach (DataRow table in tables.Rows)\n\n               {\n\n                    this.ClearTable(table[\"NAME\"].ToString());\n\n               }\n\n               return true;\n\n          }\n\n          catch\n\n          {\n\n               return false;\n\n          }\n\n     }\n\n     /// <summary>\n\n     ///     Allows the user to easily clear all data from a specific table.\n\n     /// </summary>\n\n     /// <param name=\"table\">The name of the table to clear.</param>\n\n     /// <returns>A boolean true or false to signify success or failure.</returns>\n\n     public bool ClearTable(String table)\n\n     {\n\n          try\n\n          {\n\n               this.ExecuteNonQuery(String.Format(\"delete from {0};\", table));\n\n               return true;\n\n          }\n\n          catch\n\n          {\n\n               return false;\n\n          }\n\n     }      \n\n}",
      "content_path": null,
      "diff_base_variant_id": null,
      "metadata": {
        "language": "en",
        "length": 8046,
        "rule_count": 1,
        "applied_rules": [
          {
            "rule_id": "dedupe_lines",
            "description": "Collapse adjacent duplicate lines",
            "note": "collapsed duplicate adjacent lines"
          }
        ]
      }
    }
  ],
  "extractions": [
    {
      "id": "523819d7-1238-483c-9048-4cd1c37fe943",
      "note_id": "a6cf8e54-af1b-4ef8-aa36-6b7a4582c154",
      "extractor": "llm_enhance:v0#qwen3:30b",
      "payload": {
        "summary": "C#实现的SQLite数据库操作类，提供查询、更新、删除等方法，支持连接配置和数据表操作。",
        "keywords": [
          "SQLite",
          "C#",
          "数据库",
          "类",
          "操作"
        ],
        "action_items": [
          "无"
        ],
        "source": "qwen3:30b",
        "category_path": [
          "商务",
          "技术创新"
        ],
        "new_category_suggestion": null
      },
      "version": 1,
      "created_at": "2025-11-12T03:31:49.783900Z",
      "created_by": "llm_enhance:v0",
      "quality_score": 0.19
    }
  ],
  "journal": {
    "id": "e480742a-714d-4217-836e-b93b7418cac8",
    "note_id": "a6cf8e54-af1b-4ef8-aa36-6b7a4582c154",
    "stage": "ingest",
    "agent_id": "evernote_ingest:v0",
    "started_at": "2025-11-10T15:43:31.259183Z",
    "finished_at": "2025-11-10T15:43:31.259184Z",
    "status": "success",
    "input_ref": {
      "task_id": "3531cc04-4e43-42b4-b0f4-4aff60520234",
      "source_path": "backups/2023年6月/IT技术/SQLiteDatabase.cs.html",
      "checksum": "cb128fdda991f85645965e27d43c006b61f0223cd681f2526c482fccd03d26c1"
    },
    "output_ref": {
      "ingest_source": "9683d2f1-64d5-4c8a-85d3-59736bfd5d2f",
      "note": "a6cf8e54-af1b-4ef8-aa36-6b7a4582c154",
      "variants": [
        "51a74d25-d306-4280-bc6d-d4fb656542e3",
        "c5d25a99-bbaf-4fef-9626-c8380b3394b9"
      ]
    },
    "error_detail": null
  },
  "llm": {
    "status": "success",
    "model": "qwen3:30b",
    "updated_at": "2025-11-12T03:31:49.783649Z",
    "latency_seconds": 22.667951375013217,
    "attempts": 1,
    "summary": {
      "summary": "C#实现的SQLite数据库操作类，提供查询、更新、删除等方法，支持连接配置和数据表操作。",
      "keywords": [
        "SQLite",
        "C#",
        "数据库",
        "类",
        "操作"
      ],
      "action_items": [
        "无"
      ],
      "source": "qwen3:30b",
      "category_path": [
        "商务",
        "技术创新"
      ],
      "new_category_suggestion": null
    },
    "quality": {
      "score": 0.19,
      "metrics": {
        "input_chars": 8046.0,
        "input_lines": 221.0,
        "summary_chars": 45.0,
        "summary_coverage_ratio": 0.006,
        "keyword_hit_rate": 0.4,
        "action_item_count": 1.0,
        "unique_summary_sentences": 1.0,
        "estimated_read_seconds": 482.8
      }
    }
  }
}