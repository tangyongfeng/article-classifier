---
title: c# 打印和条码
updated: 2013-06-27 01:46:39Z
created: 2013-06-27 01:43:06Z
tags:
  - c#
---

using

System;
using

System.Collections.Generic;
using

System.ComponentModel;
using

System.Data;
using

System.Drawing;
using

System.Linq;
using

System.Text;
using

System.Windows.Forms;
using

System.Drawing.Printing;
namespace

WindowsFormsApplication7
{
   
public

partial

class

Form1

:

Form
    {
       
string

inputString;
       
public

Form1()
        {
            InitializeComponent();
        }
       
private

void

button1_Click(

object

sender,

EventArgs

e)
        {
            inputString = textBox1.Text;
            PrintLable();
        }
       
private

string

Get128CodeString(

string

inputData)
        {
           
string

result;
           
int

checksum = 104;
           
for

(

int

ii = 0; ii < inputData.Length; ii++)
            {
               
if

(inputData[ii] >= 32)
                {
                    checksum += (inputData[ii] - 32) * (ii + 1);
                }
               
else
                {
                    checksum += (inputData[ii] + 64) * (ii + 1);
                }
            checksum = checksum % 103;
           
if

(checksum < 95)
            {
                checksum += 32;
            }
           
else
            {
                checksum += 100;
            }
            result =

Convert
.ToChar(204) + inputData.ToString() +

Convert
.ToChar(checksum) +

Convert
.ToChar(206);
           
return

result;
        }
       
public

void

PrintLable()
        {
           
PrintDocument

pd =

new

PrintDocument

();
           
StandardPrintController

controler =

new

StandardPrintController

();
           
try
            {
                pd.PrintPage +=

new

PrintPageEventHandler
(
this
.PrintCustomLable);
                pd.PrintController = controler;
                pd.Print();
               
return
;
            }
           
catch

(

Exception

err)
            {
               
Console
.WriteLine(err.Message);
               
return
;
            }
           
finally
            {
                pd.Dispose();
            }
       
public

void

PrintCustomLable(

Object

Sender,

PrintPageEventArgs

av)
        {
           
Font

ft1 =

new

System.Drawing.

Font
(

"Times New Roman"
, 18,

FontStyle

.Regular,

GraphicsUnit
.World);
           
Font

ft2 =

new

System.Drawing.

Font
(

"Code 128"
, 64,

FontStyle

.Regular,

GraphicsUnit
.World);
           
Brush

br =

new

SolidBrush
(

Color
.Black);
           
Margins

margins =

new

Margins
(50, 50, 50, 145);
            av.PageSettings.Margins = margins;
            av.Graphics.DrawString(Get128CodeString(inputString), ft2, br, 50, -3);
            av.Graphics.DrawString(inputString, ft1, br, 110, 60);
            av.HasMorePages =

false
;
        }