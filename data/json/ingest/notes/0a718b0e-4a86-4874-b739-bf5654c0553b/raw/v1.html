---
title: dataGridView
updated: 2013-06-18 04:32:46Z
created: 2013-06-16 15:11:50Z
tags:
  - c#
---




<en-note STYLE="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div ALIGN="left"><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;</span></font><font COLOR="#010101" FACE="Calibri" SIZE="4">&nbsp; &nbsp; &nbsp;</font>&nbsp;public static readonly string SQLconnString = &quot;Data Source=TANG-LEPTOP\\SQLEXPRESS;Initial Catalog=health;Integrated Security=True&quot;;</div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri" SIZE="4">&nbsp;</font></div><div ALIGN="left"><font COLOR="#0000FF" FACE="Calibri" SIZE="4">&nbsp; &nbsp; &nbsp;&nbsp;</font><font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">private</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">void</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">Form1_Load(</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">object</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">sender,</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">EventArgs</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">e)</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dataGridView1.Columns.Add(CreateCheckInfoColumn());</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">DataGridViewComboBoxColumn</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">CreateCheckInfoColumn()</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">DataGridViewComboBoxColumn</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">combo =</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">new</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">DataGridViewComboBoxColumn</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">();</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">SqlCommand</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">sqlComm = InitDatabase(SQLconnString);</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sqlComm.CommandType =</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">CommandType</span></font><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">.Text;</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sqlComm.CommandText =</span></font> <font COLOR="#A31515" FACE="Calibri"><span STYLE="font-size:12pt">&quot;select checkName from checklist;&quot;</span></font><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">;</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">if</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">(sqlComm.Connection.State ==</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">ConnectionState</span></font><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">.Open)</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">SqlDataReader</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">dr = sqlComm.ExecuteReader();</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">List</span></font><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&lt;</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">string</span></font><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&gt; _buff_list =</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">new</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">List</span></font><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&lt;</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">string</span></font><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&gt;();</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">while</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">(dr.Read())</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _buff_list.Add((</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">string</span></font><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">)dr[</span></font> <font COLOR="#A31515" FACE="Calibri"><span STYLE="font-size:12pt">&quot;checkName&quot;</span></font><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">]);</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; combo.DataSource = _buff_list;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; combo.DataPropertyName =</span></font> <font COLOR="#A31515" FACE="Calibri"><span STYLE="font-size:12pt">&quot;check info&quot;</span></font><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">;</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; combo.Name =</span></font> <font COLOR="#A31515" FACE="Calibri"><span STYLE="font-size:12pt">&quot;checkinfo&quot;</span></font><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">;</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sqlComm.Connection.Close();</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">return</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">combo;</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">SqlCommand</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">InitDatabase(</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">string</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">ConnString)</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">SqlConnection</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">sqlConn=</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">new</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">SqlConnection</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">(ConnString);</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sqlConn.Open();</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt"><br/></span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#2B91AF" FACE="Calibri"><span STYLE="font-size:12pt">SqlCommand</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">sqlComm = sqlConn.CreateCommand();</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font COLOR="#0000FF" FACE="Calibri"><span STYLE="font-size:12pt">return</span></font> <font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">sqlComm;</span></font></div><div ALIGN="left"><font COLOR="#010101" FACE="Calibri"><span STYLE="font-size:12pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></font></div></div></en-note>      