---
title: OpenBTS 5.0安装 - 原子冲击 - 博客园
updated: 2016-04-07 09:46:20Z
created: 2016-04-07 09:46:20Z
source: http://www.cnblogs.com/atomic-pulse/p/4177589.html
---


<en-note><br/><div><div><div><div><h1>OpenBTS 5.0安装</h1><div><div></div></div></div><p>在安装OpenBTS 5.0之前，要先安装GNU Radio和UHD，只要运行安装文件包可执行脚本build-gnuradio，就可以自动安装，安装过程耗时较长，但是不需要过多的手动操作。</p>  <p><b>Step1</b><b>：安装合适的系统</b></p>  <p>Ubuntu Desktop or Server 32-bit 12.04（我使用的是Desktop）</p>  <p><b>Step2</b><b>：更新</b><b>Git</b></p>  <p>OpenBTS使用了Git的几个新的特性，为了确保客户端的兼容性，Git的版本必须在1.8.2以上。命令如下：</p>  <pre><code>$ sudo apt-get install software-properties-common python-software-properties</code></pre>

<pre><code>$ sudo add-apt-repository ppa:git-core/ppa</code></pre>

<pre><code>(press enter to continue)</code></pre>

<pre><code>$ sudo apt-get update</code></pre>

<pre><code>$ sudo apt-get install git</code></pre>

<p><b>Step3</b><b>：下载</b></p>



<p>首先确定Git的版本是不是大于1.8.2</p>

<pre><code>$ git --version</code></pre>

<pre><code>git version 1.9.1</code></pre>

<p>下载最新的工具</p>

<pre><code>$ git clone https://github.com/RangeNetworks/dev.git</code></pre>



<p>首先在GitHub上建立自己的SSH keys。首先登陆github，可以使用已经注册的github账号。</p>

<p>在执行下列命令之前，首先输入命令</p>

<pre><code>sudo apt-get install ssh</code></pre>

<p>安装了ssh之后，再进行下列步骤</p>

<p><i>产生</i><i>SSH keys</i><i>的步骤：</i></p>

<p><i>1、</i><i>首先检查已经存在的</i><i>SSH keys</i><i>，输入命令</i></p>

<p><a HREF="http://images.cnitblog.com/blog/649182/201412/221004079527494.jpg" TARGET="_blank"><img src="../_resources/221004087337622.jpg"  type="image/jpeg" hash="e7e3f644222aa754b209ef9869b9263b" width="588" height="60" alt="clip_image002" title="clip_image002" /></en-media></a></p>

<p><i>检查是否已经有了公钥，默认的公钥文件名：</i></p>

<p>&Oslash; <i>id_dsa.pub</i></p>

<p>&Oslash; <i>id_ecdsa.pub</i></p>

<p>&Oslash; <i>id_ed25519.pubid_rsa.pub</i></p>

<p><i>注：如果没有出现上述文件，则需要使用</i><i>ssh-keygen -t rsa</i><i>命令产生</i></p>

<p><i>2、</i><i>产生新的</i><i>SSH key</i></p>

<p><a HREF="http://images.cnitblog.com/blog/649182/201412/221004093905021.jpg" TARGET="_blank"></a></p><div><a HREF="http://images.cnitblog.com/blog/649182/201412/221004093905021.jpg" TARGET="_blank"><img src="../_resources/221004100159663.jpg"  type="image/jpeg" hash="685195cbf817e2383af71172c366d16f" alt="clip_image004" title="clip_image004" width="576" height="87" /></en-media></a></div><p></p>

<p><a HREF="http://images.cnitblog.com/blog/649182/201412/221004106558535.jpg" TARGET="_blank"><img src="../_resources/221004115934148.jpg"  type="image/jpeg" hash="5986a80563f9f5a706a7ac1d02dc7337" width="595" height="60" alt="clip_image006" title="clip_image006" /></en-media></a></p>

<p><a HREF="http://images.cnitblog.com/blog/649182/201412/221004124526720.jpg" TARGET="_blank"></a></p><div><a HREF="http://images.cnitblog.com/blog/649182/201412/221004124526720.jpg" TARGET="_blank"><img src="../_resources/221004138438260.jpg"  type="image/jpeg" hash="94fd706c886fe29620ddea401b6605f9" alt="clip_image008" title="clip_image008" width="576" height="90" /></en-media></a></div><p></p>

<p><a HREF="http://images.cnitblog.com/blog/649182/201412/221004146402618.jpg" TARGET="_blank"></a></p><div><a HREF="http://images.cnitblog.com/blog/649182/201412/221004146402618.jpg" TARGET="_blank"><img src="../_resources/221004152023747.jpg"  type="image/jpeg" hash="8ae9567807a2b47885aff1b74c26428d" alt="clip_image010" title="clip_image010" width="576" height="88" /></en-media></a></div><p></p>

<p><i>3、</i><i>把自己的</i><i>SSH key</i><i>加到</i><i>GitHub</i><i>中</i></p>

<p><i>打开</i><i>id_rsa.pub,</i><i>把里面的内容复制到剪贴板</i></p>

<p><a HREF="http://images.cnitblog.com/blog/649182/201412/221004157337417.jpg" TARGET="_blank"><img src="../_resources/221004164058045.jpg"  type="image/jpeg" hash="9118eafd94068a4a37703a5d11d28b4b" width="600" height="62" alt="clip_image012" title="clip_image012" /></en-media></a></p>

<p><i>登陆自己的</i><i>github</i><i>，在每个页面的右上角，点击</i></p>

<p><i>选择</i><i>SSH keys</i><i>，点击</i><i>add SHH key</i></p>

<p><i>在</i><i>title field</i><i>添加名字</i></p>

<p><i>把复制的内容粘贴到&ldquo;</i><i>key</i><i>&rdquo;</i><i>field</i><i>。</i></p>

<p><i>4、</i><i>检测是否产生了</i><i>SSH keys</i></p>

<p><a HREF="http://images.cnitblog.com/blog/649182/201412/221004178123815.jpg" TARGET="_blank"><img src="../_resources/221004183437486.jpg"  type="image/jpeg" hash="ac473f32bf5eb8d7930005fac495f25f" width="600" height="61" alt="clip_image015" title="clip_image015" /></en-media></a></p>

<p><i>这时可能会有这样的提示：</i></p>

<p><a HREF="http://images.cnitblog.com/blog/649182/201412/221004190302344.jpg" TARGET="_blank"></a></p><div><a HREF="http://images.cnitblog.com/blog/649182/201412/221004190302344.jpg" TARGET="_blank"><img src="../_resources/221004195626014.jpg"  type="image/jpeg" hash="a0b1a0c3a4f1bf8ca9d725346bad4079" alt="clip_image017" title="clip_image017" width="576" height="75" /></en-media></a></div><p></p>

<p><i>输入</i><i>yes</i><i>，显示如下</i></p>

<p><a HREF="http://images.cnitblog.com/blog/649182/201412/221004200627927.jpg" TARGET="_blank"><img src="../_resources/221004205466612.jpg"  type="image/jpeg" hash="97dcdda281eb8ba6c60d86fbe9738093" width="599" height="61" alt="clip_image019" title="clip_image019" /></en-media></a></p>

<p><i>说明</i><i>SSH</i><i>配置成功。</i></p>

<p>下面就可以下载所有的组件了，只需要简单的输入命令：</p>

<pre><code>$ cd dev</code></pre>

<pre><code>$ ./clone.sh</code></pre>

<p>就可以实现自动的安装。</p>

<p><b>Step4:</b><b>选择一个</b><b>branch</b><b>或</b><b>tag</b></p>

<pre><code>$ ./switchto.sh master</code></pre>

<p><b>Step5</b><b>：编译</b></p>

<p>Build.sh脚本会自动安装所有编译所需要的东西</p>

<pre><code>$ ./build.sh</code><code> N210</code></pre>

<p>编译的包会被放在一个新的目录中。这个目录在dev的BUILD中，找到最新的时间戳文件夹。</p>

<p>注意：这一步需要在安装完GNU Radio之后进行，否则会报找不到UHD包的错误。</p>

<p><b>Step6</b><b>：安装</b></p>

<p>先cd到最新的时间戳文件里</p>

<pre><code>$ sudo dpkg -i *.deb</code></pre>

<p>安装了该目录下所有.deb</p>

<p>这里可能会遇到dependencies的问题，输入下面的命令可以解决:</p>

<pre><code>$ sudo apt-get -f install</code></pre>

<p><b>Step7:</b><b>运行</b></p>

<p>下面可以运行OpenBTS</p>

<pre><code>$ sudo start sipauthserve</code></pre>

<pre><code>$ sudo start smqueue</code></pre>

<pre><code>$ sudo start openbts</code></pre>

<pre><code>$ sudo start asterisk</code></pre>

<p>如果上述组件都能被启动，分配到进程号，说明OpenBTS安装成功，这里需要注意一点，前两个进程可以在没有安装完GNU Radio的情况下被启动，openbts和asterisk必须在安装完GNU Radio的情况下才能被启动。是否能被启动的判断依据是是否分配了进程号，如果输入start命令显示的是unknown job，则表示启动失败。</p>

<p>停止的命令：</p>

<pre><code>$ sudo stop sipauthserve</code></pre>

<pre><code>$ sudo stop smqueue</code></pre>

<pre><code>$ sudo stop openbts</code></pre>

<pre><code>$ sudo stop asterisk</code></pre>

<p><b>Step8:</b><b>用户数据库的注册</b></p>

<pre><code>$ sudo sqlite3 /var/lib/asterisk/sqlite3dir/sqlite3.db</code></pre>

<pre><code>sqlite&gt; .tables</code></pre>

<pre><code>DIALDATA_TABLE RRLP SIP_BUDDIES rates</code></pre>

<pre><code>sqlite&gt; select * from sip_buddies;</code></pre>

<pre><code>sqlite&gt; select * from dialdata_table;</code></pre>

<pre><code>sqlite&gt; .quit</code></pre>

<p>以上，OpenBTS的安装结束。</p>

<p>下面进入运行的阶段。</p>

<p><b>OpenBTS</b><b>运行</b></p>

<p>Step1：连接USRP，按照USRP的ip地址，给主机配置一个网络，命令行中中执行uhd_find_devices，若能够找到USRP，则继续执行下述步骤，否则，检查IP地址配置是否正确，网线是否正确连接，UHD和GNU Radio驱动是否正常运行。</p>

<p>Step2：启动上面提到的四个进程：</p>

<pre><code>$ sudo start sipauthserve</code></pre>

<pre><code>$ sudo start smqueue</code></pre>

<pre><code>$ sudo start openbts</code></pre>

<pre><code>$ sudo start asterisk</code></pre>

<p>Step3：四个进程都被分配了各自的进程号以后。启动OpenBTSCLI命令，操作如下：</p>

<pre><code>$ cd /OpenBTS</code></pre>

<pre><code>$ ./OpenBTSCLI</code></pre>

<pre><code>OpenBTS&gt; help&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (list all commands available)</code></pre>

<pre><code>OpenBTS&gt; audit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (check if your configuration is correct)</code></pre>

<pre><code>OpenBTS&gt; config&nbsp;&nbsp;&nbsp;&nbsp; (list all parameters)</code></pre>

<pre><code>OpenBTS&gt; config XYZ (list all parameters that contain XYZ)</code></pre>

<pre><code>OpenBTS&gt; devconfig&nbsp; (change developer and factory parameters)</code></pre>

<pre><code>OpenBTS&gt; trxconfig&nbsp; (view the factory radio calibration) [so far only on Range Networks equipment]</code></pre>

<pre><code>OpenBTS&gt; chans&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (view the currently active channels)</code></pre>

<pre><code>OpenBTS&gt; tmsis&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (view all IMSIs that have interacted with the system)</code></pre>

<pre><code>OpenBTS&gt; trans&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (view all completed transactions like calls and sms)</code></pre>

<pre><code>OpenBTS&gt; quit</code></pre>

<p>Step4：启动OpenBTSCLI以后</p>

<pre><code>config GSM.Radio.Band 900</code></pre>

<pre><code>config GSM.Radio.C0 1</code></pre>

<pre><code>config Control.LUR.OpenRegistration <strong>.*</strong></code></pre>

<p>上面配置BTS 为GSM900，ARFCN 1，对所有手机开放注册权限。注意：该配置使得手机没有注册限制。这样如果系统配置天线的情况下，附近的任何手机便可使用该网络，谨慎在居民点使用。</p>

<p>给101发送你想使用的手机号码，位数在5到12位之间均可。</p>

<p>手机选择运营商（我搜到的运营商名字是00101），连接该运营商。</p>

<p>这样配置以后手机就可以接入网络，并实施通话，发短信功能了。</p></div></div></div><br/></en-note>      