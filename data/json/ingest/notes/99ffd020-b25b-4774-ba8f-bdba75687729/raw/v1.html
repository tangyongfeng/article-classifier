---
title: Deploying Letâ€™s Encrypt on an Amazon Linux AMI EC2 Instance
updated: 2018-12-22 12:46:23Z
created: 2018-12-22 12:46:23Z
source: >-
  https://medium.com/@gnowland/deploying-lets-encrypt-on-an-amazon-linux-ami-ec2-instance-f8e2e8f4fc1f
---


<en-note>
  <div>
<div><br/></div><div STYLE="font-size: 16px; display:block; min-width: 100%; "> <div STYLE="background-color:transparent;font:inherit;vertical-align:baseline;"><div STYLE="background-color:transparent;font:inherit;vertical-align:baseline;font-family:&quot;PT Serif&quot;;font-size:16px;line-height:1.5em;color:rgb(31, 9, 9);text-align:left;"><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><div STYLE="z-index:200;padding-left:2em;padding-right:2em;margin-left:auto;margin-right:auto;position:relative;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;width:36em;"><div STYLE="position:relative;margin-left:-25px;margin-right:25px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><div STYLE="position:relative;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;padding-top:4.5em;padding-bottom:9em;"><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;"><div STYLE="margin-bottom:0px;position:relative;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><div STYLE="margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><div STYLE="margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><h1 STYLE="padding:0px;margin:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:normal;font-size:35px;line-height:35px;margin-bottom:20px;font-family:&quot;PT Serif&quot;;text-align:left;">Deploying Let&rsquo;s Encrypt on an Amazon Linux AMI EC2 Instance</h1><div STYLE="margin-bottom:0px;position:relative;margin:0px;height:1em;line-height:1;text-align:center;padding:0px;border:0px;font:inherit;vertical-align:baseline;padding-top:1.5em;padding-bottom:1.5em;"><div STYLE="margin-bottom:0px;position:absolute;left:-4em;top:50%;z-index:10;width:100%;padding-left:4em;padding-right:4em;height:0.1em;margin:0px;opacity:0.5;padding:0px;border:0px;font:inherit;vertical-align:baseline;background:-webkit-linear-gradient(0deg, rgb(243, 242, 238) 1%, rgb(31, 9, 9) 50%, rgb(243, 242, 238) 99%);"><span STYLE="font:inherit;position:absolute;left:-4em;top:50%;z-index:10;width:100%;padding-left:4em;padding-right:4em;height:0.1em;margin:0px;opacity:0.5;background:-webkit-linear-gradient(0deg, rgb(243, 242, 238) 1%, rgb(31, 9, 9) 50%, rgb(243, 242, 238) 99%);"></span></div></div></div><div STYLE="position:relative;margin-top:0px;padding-top:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;display:block;"><span STYLE="font:inherit;position:absolute;left:25%;top:0px;z-index:10;width:50%;padding-left:0px;padding-right:0px;height:0.1em;margin:0px;opacity:0.25;display:none !important;background:-webkit-linear-gradient(0deg, rgb(243, 242, 238) 1%, rgb(31, 9, 9) 50%, rgb(243, 242, 238) 99%);"> </span><p STYLE="margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;">Are you experiencing migraines trying to install Let&rsquo;s Encrypt on your Amazon Linux AMI EC2 Instance?</p></div><div STYLE="position:relative;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;display:block;margin-top:1.5em;padding-top:1.5em;"><span STYLE="font:inherit;position:absolute;left:25%;top:0px;z-index:10;width:50%;padding-left:0px;padding-right:0px;height:0.1em;margin:0px;opacity:0.25;display:block;background:-webkit-linear-gradient(0deg, rgb(243, 242, 238) 1%, rgb(31, 9, 9) 50%, rgb(243, 242, 238) 99%);"> </span><div STYLE="margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><div STYLE="margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><h3 STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:normal;font-size:30px;line-height:35px;margin-top:35px;margin-bottom:15px;font-family:&quot;PT Serif&quot;;text-align:left;">You&rsquo;re not&nbsp;alone!</h3><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;"><strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">The Anticipation<br/></strong><a HREF="https://letsencrypt.org/" TARGET="_blank" STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);">Let&rsquo;s Encrypt</a> announced its public beta on a bitter cold day in December, 2015. I was attending the inaugural WordCamp US in Philadelphia, PA alongside<a HREF="https://www.mikeauteri.com/2015/12/07/the-day-after-wordcamp-us/" TARGET="_blank" STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);"> about 1,800 peers</a> whose personal livelihoods are built on the internet. The mood was<em STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-style:italic;"> electric</em>. Google <a HREF="https://webmasters.googleblog.com/2014/08/https-as-ranking-signal.html" TARGET="_blank" STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);">had been signaling</a> that they favor HTTPS sites in search rankings for some time. &ldquo;Finally, free SSL Certificates for all!&rdquo; presenters throughout the morning enthusiastically exclaimed. By lunchtime dozens of developers had collected in the hallways, fervently entering commands into their terminal windows, all racing to implement this divine gift bestowed upon the world by <a HREF="https://letsencrypt.org/isrg/" TARGET="_blank" STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);">an obscure acronym</a>.</p><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;"><strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">The Reality<br/></strong>As the day wore on I inquisitively approached a group of people I overheard discussing Let&rsquo;s Encrypt. The consensus? Not one of them had successfully generated a valid SSL certificate for their site using the Let&rsquo;s Encrypt software. A rather disheartening inception indeed! Not to be deterred, over the following months I gathered everything I could find about implementing Let&rsquo;s Encrypt SSL certificate generation and management on my own <strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">AWS EC2 instance</strong> running <strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">Amazon Linux AMI</strong> and <strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">Apache</strong>. What follows is my process, and since there&rsquo;s currently very little documentation of this niche implementation online if this saves just <em STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-style:italic;">one</em> other person some grief then the time spent will have been worth it.</p><h3 STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:normal;font-size:30px;line-height:35px;margin-top:35px;margin-bottom:15px;font-family:&quot;PT Serif&quot;;text-align:left;">Blindly follow me into the promised&nbsp;land!</h3><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;"><em STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-style:italic;">Shameful admission:</em> I&rsquo;m adapting this documentation from step-by-step notes taken during my own install over three months ago, so please excuse any hazy details and certainly leave feedback if anything is unclear so I can make improvements!</p><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;"><strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">(In)Compatibility with Amazon Linux AMI<br/></strong>At the time of writing the Let&rsquo;s Encrypt Certbot still isn&rsquo;t <em STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-style:italic;">technically</em> supported for deployment on the Amazon AMI flavor of Linux. It still works, though*! At this point it&rsquo;s also worth it to note that <a HREF="https://aws.amazon.com/certificate-manager/" TARGET="_blank" STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);">Amazon itself</a> also offers a free service, although I haven&rsquo;t tried it because as I always say: &ldquo;with just a little coffee and foolhardy perseverance you too can start generating and managing SSL Certificates yourself, for free!&rdquo; Plus, think of the bragging rights.</p><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;"><em STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-style:italic;">* As long as you use the</em><code STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;">--debug</code> <em STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-style:italic;">option on all commands</em></p><h4 STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;font-size:20px;margin-top:30px;margin-bottom:1.5em;font-family:&quot;PT Serif&quot;;text-align:left;">So without further&nbsp;ado&hellip;</h4></div></div></div><div STYLE="position:relative;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;display:block;margin-top:1.5em;padding-top:1.5em;"><span STYLE="font:inherit;position:absolute;left:25%;top:0px;z-index:10;width:50%;padding-left:0px;padding-right:0px;height:0.1em;margin:0px;opacity:0.25;display:block;background:-webkit-linear-gradient(0deg, rgb(243, 242, 238) 1%, rgb(31, 9, 9) 50%, rgb(243, 242, 238) 99%);"> </span><div STYLE="margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><div STYLE="margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><h3 STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:normal;font-size:30px;line-height:35px;margin-top:35px;margin-bottom:15px;font-family:&quot;PT Serif&quot;;text-align:left;">The Install</h3><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">1. Install Python:</p><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;">$ yum <strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">install</strong> python27-devel git</pre><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">2. Install Let&rsquo;s Encrypt by cloning the <a HREF="https://github.com/letsencrypt/letsencrypt" TARGET="_blank" STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);">github repository</a> into <code STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;">/<strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">opt</strong>/letsencrypt</code> and running the Let&rsquo;s Encrypt installer:</p><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;">$ <code STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:1.15em;line-height:1.71429em;font-family:Inconsolata;">git clone <a HREF="https://github.com/letsencrypt/letsencrypt" TARGET="_blank" STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);">https://github.<strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">com</strong>/letsencrypt/letsencrypt</a> /<strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">opt</strong>/letsencrypt</code></pre><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;">$ /opt/letsencrypt/letsencrypt-<strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">auto</strong> --<strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">debug</strong></pre><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">2a. If you&rsquo;re running <strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">Amazon Linux 2 </strong>on yourEC2 follow <a HREF="https://medium.com/@andrenakkurt/great-guide-thanks-for-putting-this-together-gifford-nowland-c3ce0ea2455" TARGET="_blank" STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);">these additional steps</a> (thanks <a HREF="http://twitter.com/andrenakkurt" TITLE="Twitter profile for @andrenakkurt" TARGET="_blank" STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);">@andrenakkurt</a>!) before continuing.</p><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">3. Make a configuration file (<code STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;">/etc/letsencrypt/config.ini</code>) that will be used to sign all future certificates and renewals with your private key and email address:</p><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;">$ echo &quot;rsa-key-size = 4096&quot; &gt;&gt; /etc/letsencrypt/config.ini</pre><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;">$ echo &quot;email = ________@____.com&quot; &gt;&gt; /etc/letsencrypt/config.ini</pre><h3 STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:normal;font-size:30px;line-height:35px;margin-top:35px;margin-bottom:15px;font-family:&quot;PT Serif&quot;;text-align:left;">Certificate Generation</h3><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">1. Request a certificate the naked domain (<code STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;">_______.com</code>) and www subdomain (<code STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;">www._______.com</code>), using a &ldquo;secret file&rdquo; generated in a directory (<code STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;">.well-known</code>) in your website&rsquo;s root folder (<code STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;">/var/www/_______</code>)</p><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;"><code STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:1.15em;line-height:1.71429em;font-family:Inconsolata;">$ /opt/letsencrypt/letsencrypt-auto certonly --debug --webroot -w /var/www/_______ -d _______.com -d www._______.com --config /etc/letsencrypt/config.ini --agree-tos</code> </pre><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">Certificate files (<code STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;">cert.pem</code>, <code STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;">chain.pem</code>, <code STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;">fullchain.pem</code>, and <code STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;">privkey.pem</code>) are generated in an individual folder for each domain in <code STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;">/etc/letsencrypt/live/</code> (e.g. <code STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;">/etc/letsencrypt/live/_______.com/</code> )</p><ul STYLE="margin:0px 0px 1.5em 1.5em;padding:0px;border:0px;font:inherit;vertical-align:baseline;list-style:none outside none;margin-top:-1em;list-style-type:none;"><li STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;list-style-type:inherit;list-style-position:outside;"><strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">cert.pem</strong>: server certificate only.</li><li STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;list-style-type:inherit;list-style-position:outside;"><strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">chain.pem</strong>: root and intermediate certificates only.</li><li STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;list-style-type:inherit;list-style-position:outside;"><strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">fullchain.pem</strong>: combination of server, root and intermediate certificates (replaces <code STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;">cert.pem</code> and <code STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;font-family:Inconsolata;">chain.pem</code>).</li><li STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;list-style-type:inherit;list-style-position:outside;"><strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">privkey.pem</strong>: private key (do <strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">not</strong> share this with anyone!).</li></ul><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">Take a note of your expiration date and other important information displayed on the confirmation screen.</p><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">2. Remove the now-empty &ldquo;secret file&rdquo; directory, if desired (for cleanliness)</p><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;">$ rmdir /var/www/______/.well-known</pre><h3 STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:normal;font-size:30px;line-height:35px;margin-top:35px;margin-bottom:15px;font-family:&quot;PT Serif&quot;;text-align:left;">Certificate Renewal&hairsp;&mdash;&hairsp;Manual</h3><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">Let&rsquo;s Encrypt includes a script to check and renew your certificates:</p><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;">/opt/letsencrypt/letsencrypt-auto --no-bootstrap renew</pre><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;"><strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">Troubleshooting:</strong></p><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">One common issue experienced on Amazon Linux AMI is receiving the following error:</p><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;">Traceback (most recent call last):<br/>  File &quot;/usr/local/bin/virtualenv&quot;, line 7, in &lt;module&gt;<br/>    from virtualenv import main<br/>ImportError: No module named virtualenv</pre><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">&hellip;or similarly:</p><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;">/opt/letsencrypt/letsencrypt-auto: line 666: virtualenv: command not found</pre><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">To resolve this, install/reinstall the python package &ldquo;virtualenv&rdquo; using PIP</p><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;">$ sudo easy_install pip<br/>$ sudo pip install virtualenv</pre><h3 STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:normal;font-size:30px;line-height:35px;margin-top:35px;margin-bottom:15px;font-family:&quot;PT Serif&quot;;text-align:left;">Certificate Renewal&hairsp;&mdash;&hairsp;Automated</h3><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">The easiest way to automate the above certificate renewal process is to add it to your cron process.</p><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;">$ sudo nano /etc/crontab</pre><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">Enter the following for a once-a-day check. <em STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-style:italic;">Make sure you also refresh Apache, newly renewed certificates won&rsquo;t be recognized otherwise!</em></p><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;"><em STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-style:italic;"># Renew SSL Certs<br/></em>0  13  <strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">*</strong>  <strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">*</strong>  <strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">*</strong>  ec2-user  /opt/letsencrypt/letsencrypt-auto --no-bootstrap renew</pre><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;"># Refresh Server<br/>10 13  *  *  *  root      apachectl -k restart &gt; /dev/null 2&gt;&amp;1</pre><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">If your certificates fail to renew automatically see &ldquo;Troubleshooting&rdquo; under Certificate Renewal&hairsp;&mdash;&hairsp;Manual, many times it&rsquo;s the virtualenv package failing to execute during the auto-renew process as well, a reinstall of that package should fix it.</p><h3 STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:normal;font-size:30px;line-height:35px;margin-top:35px;margin-bottom:15px;font-family:&quot;PT Serif&quot;;text-align:left;">Certificate Implementation</h3><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">Adding your newly generated SSL Certificates to your website just requires making some additions to your virtual host configuration files.</p><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;">$ sudo nano /etc/httpd/<strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">conf</strong>.<strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">d</strong>/_____.com.<strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">conf</strong></pre><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">If you want to force SSL (a good idea) add the following to the TOP of the config file before anything else:</p><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;"># Force SSL<br/>&lt;IfModule mod_rewrite.c&gt;<br/> RewriteEngine On<br/> RewriteCond %{HTTPS} !=on<br/> RewriteRule ^/?(.*) https://%{SERVER_NAME}/$1 [R=301,L]<br/>&lt;/IfModule&gt;</pre><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">Then add the port 443 (SSL) configuration below:</p><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;">Listen 443<br/>&lt;VirtualHost *:443&gt;<br/>     ServerAdmin ________@____.com<br/>     DocumentRoot /var/www/_______.com<br/>     ServerName _______.com<br/>     ServerAlias <a HREF="http://www._______.com/" TARGET="_blank" STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);">www._______.com</a></pre><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;">     # Logs<br/>     ErrorLog /var/www/logs/_______.com-ssl_error_log<br/>     CustomLog /var/www/logs/_______.com-ssl_access_log common</pre><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;">     # Certificates<br/>     SSLEngine on<br/>     SSLCertificateFile /etc/letsencrypt/live/___.com/cert.pem<br/>     SSLCertificateKeyFile /etc/letsencrypt/live/___.com/privkey.pem<br/>     SSLCertificateChainFile /etc/letsencrypt/live/___.com/chain.pem<br/>     SSLProtocol All -SSLv2 -SSLv3<br/>     SSLHonorCipherOrder on<br/>     SSLCipherSuite &quot;EECDH+ECDSA+AESGCM EECDH+aRSA+AESGCM EECDH+ECDSA+SHA384 EECDH+ECDSA+SHA256 EECDH+aRSA+SHA384 EECDH+aRSA+SHA256 EECDH+aRSA+RC4 EECDH EDH+aRSA !RC4 !aNULL !eNULL !LOW !3DES !MD5 !EXP !PSK !SRP !DSS&quot;<br/>&lt;/VirtualHost&gt;</pre><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">Refresh Apache for the changes to take effect:</p><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;">$ sudo apachectl graceful</pre><h3 STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:normal;font-size:30px;line-height:35px;margin-top:35px;margin-bottom:15px;font-family:&quot;PT Serif&quot;;text-align:left;">Certificate Validity&nbsp;Audit</h3><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">Here are a couple of methods to use to ensure your new certificate is configured properly and to check an existing certificate&rsquo;s expiry date:</p><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">HTTP response:</p><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;">$ curl -sIv https://_______.<strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">com</strong> |&amp; <strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">grep</strong> expire</pre><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">Direct file read:</p><pre STYLE="width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;background-color:rgb(243, 242, 238);font-family:Inconsolata;"><code STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:1.15em;line-height:1.71429em;font-family:Inconsolata;">$ sudo openssl x509 -noout -dates -<strong STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;">in</strong> /etc/letsencrypt/live/_______.com/cert.pem</code></pre><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">The following online tools are indispensable for checking and debugging invalid certificate issues:</p><ul STYLE="margin:0px 0px 1.5em 1.5em;padding:0px;border:0px;font:inherit;vertical-align:baseline;list-style:none outside none;margin-top:-1em;list-style-type:none;"><li STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;list-style-type:inherit;list-style-position:outside;">SSL Shopper&rsquo;s <a HREF="https://www.sslshopper.com/ssl-checker.html" TARGET="_blank" STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);">SSL Checker</a></li><li STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;list-style-type:inherit;list-style-position:outside;">In-depth certificate analysis on <a HREF="https://www.whynopadlock.com/" TARGET="_blank" STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;color:rgb(6, 85, 136);">Why No Padlock</a></li></ul></div></div></div><div STYLE="position:relative;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;display:block;margin-top:1.5em;padding-top:1.5em;"><span STYLE="font:inherit;position:absolute;left:25%;top:0px;z-index:10;width:50%;padding-left:0px;padding-right:0px;height:0.1em;margin:0px;opacity:0.25;display:block;background:-webkit-linear-gradient(0deg, rgb(243, 242, 238) 1%, rgb(31, 9, 9) 50%, rgb(243, 242, 238) 99%);"> </span><div STYLE="margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><div STYLE="margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><h3 STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:normal;font-size:30px;line-height:35px;margin-top:35px;margin-bottom:15px;font-family:&quot;PT Serif&quot;;text-align:left;">Further Reading</h3><p STYLE="margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;">My own journey would have been impossible without the sages who blazed the untamed trail before me, to which I owe my sincere gratitude:</p></div></div></div></div></div></div><div STYLE="position:absolute;top:-1000px;left:-1000px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">Measure</div><div STYLE="margin-bottom:0px;position:absolute;top:-1000px;left:-1000px;line-height:1;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;">Measure</div></div></div></div></div></div></div></div>
</div>
</en-note>      