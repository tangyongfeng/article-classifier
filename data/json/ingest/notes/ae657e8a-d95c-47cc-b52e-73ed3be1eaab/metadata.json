{
  "ingest_source": {
    "id": "083cb387-1bdd-4015-9898-f461f8364050",
    "source_type": "evernote_html",
    "source_path": "backups/2023年6月/IT技术/本文在提供一种方式,实现执行sql语句  返回字典结果集.html",
    "collected_at": "2025-11-10T15:43:32.908382Z",
    "external_id": null,
    "title_hint": null,
    "language_hint": "ca",
    "captured_at": null,
    "checksum": "fd3bdd3e9170f6683d2e0abc62541160d29739932ddf8178a0ce5134c2a6f343",
    "status": "pending",
    "notes": {
      "batch_id": "phase2-backfill-202306"
    }
  },
  "note": {
    "id": "ae657e8a-d95c-47cc-b52e-73ed3be1eaab",
    "ingest_source_id": "083cb387-1bdd-4015-9898-f461f8364050",
    "canonical_title": "本文在提供一种方式,实现执行sql语句  返回字典结果集",
    "language": "ca",
    "ingested_at": "2025-11-10T15:43:32.908387Z",
    "created_at": null,
    "status": "active",
    "importance": 0,
    "attributes": {
      "source_filename": "本文在提供一种方式,实现执行sql语句  返回字典结果集.html"
    }
  },
  "variants": [
    {
      "id": "c0bfa803-cb14-4406-afea-24fc7f8d57d9",
      "note_id": "ae657e8a-d95c-47cc-b52e-73ed3be1eaab",
      "variant_type": "raw_html",
      "version": 1,
      "created_by": "evernote_ingest:v0",
      "created_at": "2025-11-10T15:43:32.908390Z",
      "content": "---\ntitle: 本文在提供一种方式,实现执行sql语句  返回字典结果集\nupdated: 2022-09-16 10:30:37Z\ncreated: 2022-09-16 10:29:55Z\ntags:\n  - mysql\n  - python\n---\n\n\n<en-note><div># 连接数据库，数据库的，这里使用的setting中的默认设置，在这里不做具体的介绍，不懂的可以百度一下</div><div>&nbsp; &nbsp; &nbsp; &nbsp; conn = MySQLdb.connect(host=settings.DATABASES[&apos;default&apos;][&apos;HOST&apos;], user=settings.DATABASES[&apos;default&apos;][&apos;USER&apos;],</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  passwd=settings.DATABASES[&apos;default&apos;][&apos;PASSWORD&apos;],</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  db=settings.DATABASES[&apos;default&apos;][&apos;NAME&apos;])</div><div>&nbsp; &nbsp; &nbsp; &nbsp; cursor = conn.cursor()</div><div><br/></div><div>&nbsp; &nbsp; &nbsp; &nbsp; # 原生sql语句，注意要用六个&nbsp; &quot;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; sql = &quot;&quot;&quot; SELECT total_premium,quote_count,order_count from usr_statistics WHERE DAY = 20170422&quot;&quot;&quot;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # 执行sql</div><div><br/></div><div>&nbsp; &nbsp; &nbsp; &nbsp; cursor.execute(sql)</div><div><br/></div><div>&nbsp; &nbsp; &nbsp; &nbsp; # 只用于select语句，返回一行的列名</div><div>&nbsp; &nbsp; &nbsp; &nbsp; desc = cursor.description</div><div>&nbsp; &nbsp; &nbsp; &nbsp; print &quot;00000000000000000&quot;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; print desc</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # desc 将会输出&nbsp; ((&apos;total_premium&apos;, 246, 7, 26, 26, 2, 0), (&apos;quote_count&apos;, 3, 3, 11, 11, 0, 0), (&apos;order_count&apos;, 3, 3, 11, 11, 0, 0))</div><div><br/></div><div>&nbsp; &nbsp; &nbsp; &nbsp; object_dict = [</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dict(zip([col[0] for col in desc],row))</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for row in cursor.fetchall()</div><div>&nbsp; &nbsp; &nbsp; &nbsp; ]</div><div><br/></div><div>&nbsp; &nbsp; &nbsp; &nbsp; cursor.close()</div><div><br/></div><div>&nbsp; &nbsp; &nbsp; &nbsp; print &quot;1111111111111111111&quot;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; print object_dict</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # 下面是object_dict的输出，太长了，已经给其换行</div><div><br/></div><div>&nbsp; &nbsp; &nbsp; &nbsp; # [{&apos;quote_count&apos;: 5L, &apos;total_premium&apos;: Decimal(&apos;200.00&apos;), &apos;order_count&apos;: 7L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # {&apos;quote_count&apos;: 5L, &apos;total_premium&apos;: Decimal(&apos;200.00&apos;), &apos;order_count&apos;: 7L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # {&apos;quote_count&apos;: 45L, &apos;total_premium&apos;: Decimal(&apos;999.00&apos;), &apos;order_count&apos;: 78L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # {&apos;quote_count&apos;: 65L, &apos;total_premium&apos;: Decimal(&apos;999.00&apos;), &apos;order_count&apos;: 78L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # {&apos;quote_count&apos;: 45L, &apos;total_premium&apos;: Decimal(&apos;888.00&apos;), &apos;order_count&apos;: 78L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # {&apos;quote_count&apos;: 123L, &apos;total_premium&apos;: Decimal(&apos;523.00&apos;), &apos;order_count&apos;: 23L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; #&nbsp; {&apos;quote_count&apos;: 2L, &apos;total_premium&apos;: Decimal(&apos;211.00&apos;), &apos;order_count&apos;: 21L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # {&apos;quote_count&apos;: 1L, &apos;total_premium&apos;: Decimal(&apos;0.00&apos;), &apos;order_count&apos;: 23L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # {&apos;quote_count&apos;: 23L, &apos;total_premium&apos;: Decimal(&apos;213.00&apos;), &apos;order_count&apos;: 23L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # {&apos;quote_count&apos;: 13L, &apos;total_premium&apos;: Decimal(&apos;1232.00&apos;), &apos;order_count&apos;: 123L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # {&apos;quote_count&apos;: 0L, &apos;total_premium&apos;: Decimal(&apos;0.00&apos;), &apos;order_count&apos;: 1L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # {&apos;quote_count&apos;: 0L, &apos;total_premium&apos;: Decimal(&apos;0.00&apos;), &apos;order_count&apos;: 0L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # {&apos;quote_count&apos;: 0L, &apos;total_premium&apos;: Decimal(&apos;0.00&apos;), &apos;order_count&apos;: 0L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # {&apos;quote_count&apos;: 0L, &apos;total_premium&apos;: Decimal(&apos;0.00&apos;), &apos;order_count&apos;: 0L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # {&apos;quote_count&apos;: 0L, &apos;total_premium&apos;: Decimal(&apos;0.00&apos;), &apos;order_count&apos;: 0L}]</div><div><br/></div><div><br/></div><div>&nbsp; &nbsp; &nbsp; &nbsp; object_list = []</div><div>&nbsp; &nbsp; &nbsp; &nbsp; object_list_b = []</div><div><br/></div><div>&nbsp; &nbsp; &nbsp; &nbsp; for i in object_dict:</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; object_list.append(int(i.get(&quot;total_premium&quot;)))</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; object_list_b.append(i.get(&quot;quote_count&quot;))</div><div><br/></div><div>&nbsp; &nbsp; &nbsp; &nbsp; print &quot;22222222222222222222&quot;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; print object_list</div><div>&nbsp; &nbsp; &nbsp; &nbsp; print object_list_b</div><div><br/></div><div>&nbsp; &nbsp; &nbsp; &nbsp; # object_list输出&nbsp; &nbsp; [200, 200, 999, 999, 888, 523, 211, 0, 213, 1232, 0, 0, 0, 0, 0]</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # object_list_b输出&nbsp; [5L, 5L, 45L, 65L, 45L, 123L, 2L, 1L, 23L, 13L, 0L, 0L, 0L, 0L, 0L]</div><div><br/></div><div>&nbsp; &nbsp; &nbsp; &nbsp; conn.close()</div></en-note>      ",
      "content_path": null,
      "diff_base_variant_id": null,
      "metadata": {
        "checksum": "fd3bdd3e9170f6683d2e0abc62541160d29739932ddf8178a0ce5134c2a6f343",
        "path": "backups/2023年6月/IT技术/本文在提供一种方式,实现执行sql语句  返回字典结果集.html"
      }
    },
    {
      "id": "a8fc0a12-2e18-454d-aedd-236840712c0e",
      "note_id": "ae657e8a-d95c-47cc-b52e-73ed3be1eaab",
      "variant_type": "clean_text",
      "version": 1,
      "created_by": "evernote_ingest:v0",
      "created_at": "2025-11-10T15:43:32.908393Z",
      "content": "---\ntitle: 本文在提供一种方式,实现执行sql语句  返回字典结果集\nupdated: 2022-09-16 10:30:37Z\ncreated: 2022-09-16 10:29:55Z\ntags:\n  - mysql\n  - python\n---\n\n# 连接数据库，数据库的，这里使用的setting中的默认设置，在这里不做具体的介绍，不懂的可以百度一下\n        conn = MySQLdb.connect(host=settings.DATABASES['default']['HOST'], user=settings.DATABASES['default']['USER'],\n                               passwd=settings.DATABASES['default']['PASSWORD'],\n                               db=settings.DATABASES['default']['NAME'])\n        cursor = conn.cursor()\n        # 原生sql语句，注意要用六个  \"\n        sql = \"\"\" SELECT total_premium,quote_count,order_count from usr_statistics WHERE DAY = 20170422\"\"\"\n        # 执行sql\n        cursor.execute(sql)\n        # 只用于select语句，返回一行的列名\n        desc = cursor.description\n        print \"00000000000000000\"\n        print desc\n        # desc 将会输出  (('total_premium', 246, 7, 26, 26, 2, 0), ('quote_count', 3, 3, 11, 11, 0, 0), ('order_count', 3, 3, 11, 11, 0, 0))\n        object_dict = [\n            dict(zip([col[0] for col in desc],row))\n            for row in cursor.fetchall()\n        ]\n        cursor.close()\n        print \"1111111111111111111\"\n        print object_dict\n        # 下面是object_dict的输出，太长了，已经给其换行\n        # [{'quote_count': 5L, 'total_premium': Decimal('200.00'), 'order_count': 7L},\n        # {'quote_count': 5L, 'total_premium': Decimal('200.00'), 'order_count': 7L},\n        # {'quote_count': 45L, 'total_premium': Decimal('999.00'), 'order_count': 78L},\n        # {'quote_count': 65L, 'total_premium': Decimal('999.00'), 'order_count': 78L},\n        # {'quote_count': 45L, 'total_premium': Decimal('888.00'), 'order_count': 78L},\n        # {'quote_count': 123L, 'total_premium': Decimal('523.00'), 'order_count': 23L},\n        #  {'quote_count': 2L, 'total_premium': Decimal('211.00'), 'order_count': 21L},\n        # {'quote_count': 1L, 'total_premium': Decimal('0.00'), 'order_count': 23L},\n        # {'quote_count': 23L, 'total_premium': Decimal('213.00'), 'order_count': 23L},\n        # {'quote_count': 13L, 'total_premium': Decimal('1232.00'), 'order_count': 123L},\n        # {'quote_count': 0L, 'total_premium': Decimal('0.00'), 'order_count': 1L},\n        # {'quote_count': 0L, 'total_premium': Decimal('0.00'), 'order_count': 0L},\n        # {'quote_count': 0L, 'total_premium': Decimal('0.00'), 'order_count': 0L}]\n        object_list = []\n        object_list_b = []\n        for i in object_dict:\n            object_list.append(int(i.get(\"total_premium\")))\n            object_list_b.append(i.get(\"quote_count\"))\n        print \"22222222222222222222\"\n        print object_list\n        print object_list_b\n        # object_list输出    [200, 200, 999, 999, 888, 523, 211, 0, 213, 1232, 0, 0, 0, 0, 0]\n        # object_list_b输出  [5L, 5L, 45L, 65L, 45L, 123L, 2L, 1L, 23L, 13L, 0L, 0L, 0L, 0L, 0L]\n        conn.close()",
      "content_path": null,
      "diff_base_variant_id": null,
      "metadata": {
        "language": "ca",
        "length": 2797,
        "rule_count": 1,
        "applied_rules": [
          {
            "rule_id": "dedupe_lines",
            "description": "Collapse adjacent duplicate lines",
            "note": "collapsed duplicate adjacent lines"
          }
        ]
      }
    }
  ],
  "extractions": [
    {
      "id": "087b8a40-3b6a-47fc-b2df-d8337f451321",
      "note_id": "ae657e8a-d95c-47cc-b52e-73ed3be1eaab",
      "extractor": "llm_enhance:v0#qwen3:30b",
      "payload": {
        "summary": "提供Python连接MySQL执行SQL查询并返回字典格式结果的代码示例。",
        "keywords": [
          "数据库",
          "Python",
          "SQL",
          "字典",
          "结果集"
        ],
        "action_items": [
          "无"
        ],
        "source": "qwen3:30b",
        "category_path": [
          "商务"
        ],
        "new_category_suggestion": [
          "技术",
          "数据库",
          "Python"
        ]
      },
      "version": 1,
      "created_at": "2025-11-12T04:07:09.241390Z",
      "created_by": "llm_enhance:v0",
      "quality_score": 0.373
    }
  ],
  "journal": {
    "id": "31eb96f6-f79c-4ad2-8a71-e06b6ecb8bdb",
    "note_id": "ae657e8a-d95c-47cc-b52e-73ed3be1eaab",
    "stage": "ingest",
    "agent_id": "evernote_ingest:v0",
    "started_at": "2025-11-10T15:43:32.908398Z",
    "finished_at": "2025-11-10T15:43:32.908398Z",
    "status": "success",
    "input_ref": {
      "task_id": "f6f9cab9-881d-4e5b-9cdd-f3b999ec568f",
      "source_path": "backups/2023年6月/IT技术/本文在提供一种方式,实现执行sql语句  返回字典结果集.html",
      "checksum": "fd3bdd3e9170f6683d2e0abc62541160d29739932ddf8178a0ce5134c2a6f343"
    },
    "output_ref": {
      "ingest_source": "083cb387-1bdd-4015-9898-f461f8364050",
      "note": "ae657e8a-d95c-47cc-b52e-73ed3be1eaab",
      "variants": [
        "c0bfa803-cb14-4406-afea-24fc7f8d57d9",
        "a8fc0a12-2e18-454d-aedd-236840712c0e"
      ]
    },
    "error_detail": null
  },
  "llm": {
    "status": "success",
    "model": "qwen3:30b",
    "updated_at": "2025-11-12T04:07:09.241186Z",
    "latency_seconds": 46.47643733397126,
    "attempts": 1,
    "summary": {
      "summary": "提供Python连接MySQL执行SQL查询并返回字典格式结果的代码示例。",
      "keywords": [
        "数据库",
        "Python",
        "SQL",
        "字典",
        "结果集"
      ],
      "action_items": [
        "无"
      ],
      "source": "qwen3:30b",
      "category_path": [
        "商务"
      ],
      "new_category_suggestion": [
        "技术",
        "数据库",
        "Python"
      ]
    },
    "quality": {
      "score": 0.373,
      "metrics": {
        "input_chars": 2797.0,
        "input_lines": 54.0,
        "summary_chars": 37.0,
        "summary_coverage_ratio": 0.013,
        "keyword_hit_rate": 1.0,
        "action_item_count": 1.0,
        "unique_summary_sentences": 1.0,
        "estimated_read_seconds": 167.8
      }
    }
  }
}