---
title: 本文在提供一种方式,实现执行sql语句  返回字典结果集
updated: 2022-09-16 10:30:37Z
created: 2022-09-16 10:29:55Z
tags:
  - mysql
  - python
---


<en-note><div># 连接数据库，数据库的，这里使用的setting中的默认设置，在这里不做具体的介绍，不懂的可以百度一下</div><div>&nbsp; &nbsp; &nbsp; &nbsp; conn = MySQLdb.connect(host=settings.DATABASES[&apos;default&apos;][&apos;HOST&apos;], user=settings.DATABASES[&apos;default&apos;][&apos;USER&apos;],</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  passwd=settings.DATABASES[&apos;default&apos;][&apos;PASSWORD&apos;],</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  db=settings.DATABASES[&apos;default&apos;][&apos;NAME&apos;])</div><div>&nbsp; &nbsp; &nbsp; &nbsp; cursor = conn.cursor()</div><div><br/></div><div>&nbsp; &nbsp; &nbsp; &nbsp; # 原生sql语句，注意要用六个&nbsp; &quot;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; sql = &quot;&quot;&quot; SELECT total_premium,quote_count,order_count from usr_statistics WHERE DAY = 20170422&quot;&quot;&quot;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # 执行sql</div><div><br/></div><div>&nbsp; &nbsp; &nbsp; &nbsp; cursor.execute(sql)</div><div><br/></div><div>&nbsp; &nbsp; &nbsp; &nbsp; # 只用于select语句，返回一行的列名</div><div>&nbsp; &nbsp; &nbsp; &nbsp; desc = cursor.description</div><div>&nbsp; &nbsp; &nbsp; &nbsp; print &quot;00000000000000000&quot;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; print desc</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # desc 将会输出&nbsp; ((&apos;total_premium&apos;, 246, 7, 26, 26, 2, 0), (&apos;quote_count&apos;, 3, 3, 11, 11, 0, 0), (&apos;order_count&apos;, 3, 3, 11, 11, 0, 0))</div><div><br/></div><div>&nbsp; &nbsp; &nbsp; &nbsp; object_dict = [</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dict(zip([col[0] for col in desc],row))</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for row in cursor.fetchall()</div><div>&nbsp; &nbsp; &nbsp; &nbsp; ]</div><div><br/></div><div>&nbsp; &nbsp; &nbsp; &nbsp; cursor.close()</div><div><br/></div><div>&nbsp; &nbsp; &nbsp; &nbsp; print &quot;1111111111111111111&quot;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; print object_dict</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # 下面是object_dict的输出，太长了，已经给其换行</div><div><br/></div><div>&nbsp; &nbsp; &nbsp; &nbsp; # [{&apos;quote_count&apos;: 5L, &apos;total_premium&apos;: Decimal(&apos;200.00&apos;), &apos;order_count&apos;: 7L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # {&apos;quote_count&apos;: 5L, &apos;total_premium&apos;: Decimal(&apos;200.00&apos;), &apos;order_count&apos;: 7L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # {&apos;quote_count&apos;: 45L, &apos;total_premium&apos;: Decimal(&apos;999.00&apos;), &apos;order_count&apos;: 78L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # {&apos;quote_count&apos;: 65L, &apos;total_premium&apos;: Decimal(&apos;999.00&apos;), &apos;order_count&apos;: 78L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # {&apos;quote_count&apos;: 45L, &apos;total_premium&apos;: Decimal(&apos;888.00&apos;), &apos;order_count&apos;: 78L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # {&apos;quote_count&apos;: 123L, &apos;total_premium&apos;: Decimal(&apos;523.00&apos;), &apos;order_count&apos;: 23L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; #&nbsp; {&apos;quote_count&apos;: 2L, &apos;total_premium&apos;: Decimal(&apos;211.00&apos;), &apos;order_count&apos;: 21L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # {&apos;quote_count&apos;: 1L, &apos;total_premium&apos;: Decimal(&apos;0.00&apos;), &apos;order_count&apos;: 23L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # {&apos;quote_count&apos;: 23L, &apos;total_premium&apos;: Decimal(&apos;213.00&apos;), &apos;order_count&apos;: 23L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # {&apos;quote_count&apos;: 13L, &apos;total_premium&apos;: Decimal(&apos;1232.00&apos;), &apos;order_count&apos;: 123L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # {&apos;quote_count&apos;: 0L, &apos;total_premium&apos;: Decimal(&apos;0.00&apos;), &apos;order_count&apos;: 1L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # {&apos;quote_count&apos;: 0L, &apos;total_premium&apos;: Decimal(&apos;0.00&apos;), &apos;order_count&apos;: 0L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # {&apos;quote_count&apos;: 0L, &apos;total_premium&apos;: Decimal(&apos;0.00&apos;), &apos;order_count&apos;: 0L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # {&apos;quote_count&apos;: 0L, &apos;total_premium&apos;: Decimal(&apos;0.00&apos;), &apos;order_count&apos;: 0L},</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # {&apos;quote_count&apos;: 0L, &apos;total_premium&apos;: Decimal(&apos;0.00&apos;), &apos;order_count&apos;: 0L}]</div><div><br/></div><div><br/></div><div>&nbsp; &nbsp; &nbsp; &nbsp; object_list = []</div><div>&nbsp; &nbsp; &nbsp; &nbsp; object_list_b = []</div><div><br/></div><div>&nbsp; &nbsp; &nbsp; &nbsp; for i in object_dict:</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; object_list.append(int(i.get(&quot;total_premium&quot;)))</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; object_list_b.append(i.get(&quot;quote_count&quot;))</div><div><br/></div><div>&nbsp; &nbsp; &nbsp; &nbsp; print &quot;22222222222222222222&quot;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; print object_list</div><div>&nbsp; &nbsp; &nbsp; &nbsp; print object_list_b</div><div><br/></div><div>&nbsp; &nbsp; &nbsp; &nbsp; # object_list输出&nbsp; &nbsp; [200, 200, 999, 999, 888, 523, 211, 0, 213, 1232, 0, 0, 0, 0, 0]</div><div>&nbsp; &nbsp; &nbsp; &nbsp; # object_list_b输出&nbsp; [5L, 5L, 45L, 65L, 45L, 123L, 2L, 1L, 23L, 13L, 0L, 0L, 0L, 0L, 0L]</div><div><br/></div><div>&nbsp; &nbsp; &nbsp; &nbsp; conn.close()</div></en-note>      