{
  "ingest_source": {
    "id": "65e964e5-4680-4257-862c-137c503dc5a6",
    "source_type": "evernote_html",
    "source_path": "/Users/tang/workbench/article-classifier/backups/2023年6月/IT技术/rsync 用法教程.html",
    "collected_at": "2025-11-09T20:01:35.106594Z",
    "external_id": null,
    "title_hint": null,
    "language_hint": "fr",
    "captured_at": null,
    "checksum": "ca4d539ebe3e4f5ec8ba0730d08feb15097c601b2faeb22f64f04cfe2ba8669c",
    "status": "pending",
    "notes": {
      "batch_id": null
    }
  },
  "note": {
    "id": "adb2bd3f-3564-4f3b-aae2-d3cb3fd2fcec",
    "ingest_source_id": "65e964e5-4680-4257-862c-137c503dc5a6",
    "canonical_title": "rsync 用法教程",
    "language": "fr",
    "ingested_at": "2025-11-09T20:01:35.106598Z",
    "created_at": null,
    "status": "active",
    "importance": 0,
    "attributes": {
      "source_filename": "rsync 用法教程.html"
    }
  },
  "variants": [
    {
      "id": "797b1439-700a-46c3-be1d-e451f951c2a4",
      "note_id": "adb2bd3f-3564-4f3b-aae2-d3cb3fd2fcec",
      "variant_type": "raw_html",
      "version": 1,
      "created_by": "evernote_ingest:v0",
      "created_at": "2025-11-09T20:01:35.106601Z",
      "content": "---\ntitle: rsync 用法教程\nupdated: 2022-09-06 20:58:50Z\ncreated: 2022-09-06 20:58:16Z\n---\n\n\n<en-note><h1><span STYLE=\"color:rgb(0, 0, 0);\"><span STYLE=\"--en-markholder:true;\"><br/></span></span></h1><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(85, 102, 119);\">作者： </span><a HREF=\"https://www.ruanyifeng.com/\" REV=\"en_rl_none\"><span STYLE=\"color:rgb(85, 102, 119);\">阮一峰</span></a></div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(85, 102, 119);\">日期： </span><abbr STYLE=\"margin: 0px; padding: 0px; list-style-type: none; text-align: left; text-decoration: none; font-weight: normal; font-style: normal; border: none;color:rgb(85, 102, 119);\" TITLE=\"2020-08-26T10:17:20+08:00\"><a HREF=\"https://www.ruanyifeng.com/blog/2020/08/\" REV=\"en_rl_none\"><span STYLE=\"color:rgb(85, 102, 119);\">2020年8月26日</span></a></abbr></div><h2><span STYLE=\"color:rgb(0, 0, 0);\">一、简介</span></h2><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">rsync 是一个常用的 Linux 应用程序，用于文件同步。</span></div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">它可以在本地计算机与远程计算机之间，或者两个本地目录之间同步文件（但不支持两台远程计算机之间的同步）。它也可以当作文件复制工具，替代</span><code>cp</code>和<code>mv</code>命令。</div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">它名称里面的</span><code>r</code>指的是 remote，rsync 其实就是&quot;远程同步&quot;（remote sync）的意思。与其他文件传输工具（如 FTP 或 scp）不同，rsync 的最大特点是会检查发送方和接收方已有的文件，仅传输有变动的部分（默认规则是文件大小或修改时间有变动）。</div><h2><span STYLE=\"color:rgb(0, 0, 0);\">二、安装</span></h2><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">如果本机或者远程计算机没有安装 rsync，可以用下面的命令安装。</span></div><div STYLE=\"--en-codeblock:true;box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\"><div><br/></div><div># Debian</div><div>$ sudo apt-get install rsync</div><div><br/></div><div># Red Hat</div><div>$ sudo yum install rsync</div><div><br/></div><div># Arch Linux</div><div>$ sudo pacman -S rsync</div><div><br/></div></div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">注意，传输的双方都必须安装 rsync。</span></div><h2><span STYLE=\"color:rgb(0, 0, 0);\">三、基本用法</span></h2><h3><span STYLE=\"color:rgb(0, 0, 0);\">3.1 </span><code>-r</code> 参数</h3><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">本机使用 rsync 命令时，可以作为</span><code>cp</code>和<code>mv</code>命令的替代方法，将源目录同步到目标目录。</div><div STYLE=\"--en-codeblock:true;box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\"><div><br/></div><div>$ rsync -r source destination</div><div><br/></div></div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">上面命令中，</span><code>-r</code>表示递归，即包含子目录。注意，<code>-r</code>是必须的，否则 rsync 运行不会成功。<code>source</code>目录表示源目录，<code>destination</code>表示目标目录。</div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">如果有多个文件或目录需要同步，可以写成下面这样。</span></div><div STYLE=\"--en-codeblock:true;box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\"><div><br/></div><div>$ rsync -r source1 source2 destination</div><div><br/></div></div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">上面命令中，</span><code>source1</code>、<code>source2</code>都会被同步到<code>destination</code>目录。</div><h3><span STYLE=\"color:rgb(0, 0, 0);\">3.2 </span><code>-a</code> 参数</h3><div><br/></div><div STYLE=\"padding-left:40px;\"><code>-a</code><span STYLE=\"color:rgb(17, 17, 17);\">参数可以替代</span><code>-r</code>，除了可以递归同步以外，还可以同步元信息（比如修改时间、权限等）。由于 rsync 默认使用文件大小和修改时间决定文件是否需要更新，所以<code>-a</code>比<code>-r</code>更有用。下面的用法才是常见的写法。</div><div STYLE=\"--en-codeblock:true;box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\"><div><br/></div><div>$ rsync -a source destination</div><div><br/></div></div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">目标目录</span><code>destination</code>如果不存在，rsync 会自动创建。执行上面的命令后，源目录<code>source</code>被完整地复制到了目标目录<code>destination</code>下面，即形成了<code>destination/source</code>的目录结构。</div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">如果只想同步源目录</span><code>source</code>里面的内容到目标目录<code>destination</code>，则需要在源目录后面加上斜杠。</div><div STYLE=\"--en-codeblock:true;box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\"><div><br/></div><div>$ rsync -a source/ destination</div><div><br/></div></div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">上面命令执行后，</span><code>source</code>目录里面的内容，就都被复制到了<code>destination</code>目录里面，并不会在<code>destination</code>下面创建一个<code>source</code>子目录。</div><h3><span STYLE=\"color:rgb(0, 0, 0);\">3.3 </span><code>-n</code> 参数</h3><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">如果不确定 rsync 执行后会产生什么结果，可以先用</span><code>-n</code>或<code>--dry-run</code>参数模拟执行的结果。</div><div STYLE=\"--en-codeblock:true;box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\"><div><br/></div><div>$ rsync -anv source/ destination</div><div><br/></div></div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">上面命令中，</span><code>-n</code>参数模拟命令执行的结果，并不真的执行命令。<code>-v</code>参数则是将结果输出到终端，这样就可以看到哪些内容会被同步。</div><h3><span STYLE=\"color:rgb(0, 0, 0);\">3.4 </span><code>--delete</code> 参数</h3><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">默认情况下，rsync 只确保源目录的所有内容（明确排除的文件除外）都复制到目标目录。它不会使两个目录保持相同，并且不会删除文件。如果要使得目标目录成为源目录的镜像副本，则必须使用</span><code>--delete</code>参数，这将删除只存在于目标目录、不存在于源目录的文件。</div><div STYLE=\"--en-codeblock:true;box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\"><div><br/></div><div>$ rsync -av --delete source/ destination</div><div><br/></div></div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">上面命令中，</span><code>--delete</code>参数会使得<code>destination</code>成为<code>source</code>的一个镜像。</div><h2><span STYLE=\"color:rgb(0, 0, 0);\">四、排除文件</span></h2><h3><span STYLE=\"color:rgb(0, 0, 0);\">4.1 </span><code>--exclude</code> 参数</h3><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">有时，我们希望同步时排除某些文件或目录，这时可以用</span><code>--exclude</code>参数指定排除模式。</div><div STYLE=\"--en-codeblock:true;box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\"><div><br/></div><div>$ rsync -av --exclude=&apos;*.txt&apos; source/ destination</div><div># 或者</div><div>$ rsync -av --exclude &apos;*.txt&apos; source/ destination</div><div><br/></div></div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">上面命令排除了所有 TXT 文件。</span></div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">注意，rsync 会同步以&quot;点&quot;开头的隐藏文件，如果要排除隐藏文件，可以这样写</span><code>--exclude=&quot;.*&quot;</code>。</div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">如果要排除某个目录里面的所有文件，但不希望排除目录本身，可以写成下面这样。</span></div><div STYLE=\"--en-codeblock:true;box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\"><div><br/></div><div>$ rsync -av --exclude &apos;dir1/*&apos; source/ destination</div><div><br/></div></div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">多个排除模式，可以用多个</span><code>--exclude</code>参数。</div><div STYLE=\"--en-codeblock:true;box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\"><div><br/></div><div>$ rsync -av --exclude &apos;file1.txt&apos; --exclude &apos;dir1/*&apos; source/ destination</div><div><br/></div></div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">多个排除模式也可以利用 Bash 的大扩号的扩展功能，只用一个</span><code>--exclude</code>参数。</div><div STYLE=\"--en-codeblock:true;box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\"><div><br/></div><div>$ rsync -av --exclude={&apos;file1.txt&apos;,&apos;dir1/*&apos;} source/ destination</div><div><br/></div></div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">如果排除模式很多，可以将它们写入一个文件，每个模式一行，然后用</span><code>--exclude-from</code>参数指定这个文件。</div><div STYLE=\"--en-codeblock:true;box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\"><div><br/></div><div>$ rsync -av --exclude-from=&apos;exclude-file.txt&apos; source/ destination</div><div><br/></div></div><h3><span STYLE=\"color:rgb(0, 0, 0);\">4.2 </span><code>--include</code> 参数</h3><div><br/></div><div STYLE=\"padding-left:40px;\"><code>--include</code><span STYLE=\"color:rgb(17, 17, 17);\">参数用来指定必须同步的文件模式，往往与</span><code>--exclude</code>结合使用。</div><div STYLE=\"--en-codeblock:true;box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\"><div><br/></div><div>$ rsync -av --include=&quot;*.txt&quot; --exclude=&apos;*&apos; source/ destination</div><div><br/></div></div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">上面命令指定同步时，排除所有文件，但是会包括 TXT 文件。</span></div><h2><span STYLE=\"color:rgb(0, 0, 0);\">五、远程同步</span></h2><h3><span STYLE=\"color:rgb(0, 0, 0);\">5.1 SSH 协议</span></h3><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">rsync 除了支持本地两个目录之间的同步，也支持远程同步。它可以将本地内容，同步到远程服务器。</span></div><div STYLE=\"--en-codeblock:true;box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\"><div><br/></div><div>$ rsync -av source/ username@remote_host:destination</div><div><br/></div></div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">也可以将远程内容同步到本地。</span></div><div STYLE=\"--en-codeblock:true;box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\"><div><br/></div><div>$ rsync -av username@remote_host:source/ destination</div><div><br/></div></div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">rsync 默认使用 SSH 进行远程登录和数据传输。</span></div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">由于早期 rsync 不使用 SSH 协议，需要用</span><code>-e</code>参数指定协议，后来才改的。所以，下面<code>-e ssh</code>可以省略。</div><div STYLE=\"--en-codeblock:true;box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\"><div><br/></div><div>$ rsync -av -e ssh source/ user@remote_host:/destination</div><div><br/></div></div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">但是，如果 ssh 命令有附加的参数，则必须使用</span><code>-e</code>参数指定所要执行的 SSH 命令。</div><div STYLE=\"--en-codeblock:true;box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\"><div><br/></div><div>$ rsync -av -e &apos;ssh -p 2234&apos; source/ user@remote_host:/destination</div><div><br/></div></div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">上面命令中，</span><code>-e</code>参数指定 SSH 使用2234端口。</div><h3><span STYLE=\"color:rgb(0, 0, 0);\">5.2 rsync 协议</span></h3><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">除了使用 SSH，如果另一台服务器安装并运行了 rsync 守护程序，则也可以用</span><code>rsync://</code>协议（默认端口873）进行传输。具体写法是服务器与目标目录之间使用双冒号分隔<code>::</code>。</div><div STYLE=\"--en-codeblock:true;box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\"><div><br/></div><div>$ rsync -av source/ 192.168.122.32::module/destination</div><div><br/></div></div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">注意，上面地址中的</span><code>module</code>并不是实际路径名，而是 rsync 守护程序指定的一个资源名，由管理员分配。</div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">如果想知道 rsync 守护程序分配的所有 module 列表，可以执行下面命令。</span></div><div STYLE=\"--en-codeblock:true;box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\"><div><br/></div><div>$ rsync rsync://192.168.122.32</div><div><br/></div></div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">rsync 协议除了使用双冒号，也可以直接用</span><code>rsync://</code>协议指定地址。</div><div STYLE=\"--en-codeblock:true;box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\"><div><br/></div><div>$ rsync -av source/ rsync://192.168.122.32/module/destination</div><div><br/></div></div><h2><span STYLE=\"color:rgb(0, 0, 0);\">六、增量备份</span></h2><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">rsync 的最大特点就是它可以完成增量备份，也就是默认只复制有变动的文件。</span></div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">除了源目录与目标目录直接比较，rsync 还支持使用基准目录，即将源目录与基准目录之间变动的部分，同步到目标目录。</span></div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">具体做法是，第一次同步是全量备份，所有文件在基准目录里面同步一份。以后每一次同步都是增量备份，只同步源目录与基准目录之间有变动的部分，将这部分保存在一个新的目标目录。这个新的目标目录之中，也是包含所有文件，但实际上，只有那些变动过的文件是存在于该目录，其他没有变动的文件都是指向基准目录文件的硬链接。</span></div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>--link-dest</code><span STYLE=\"color:rgb(17, 17, 17);\">参数用来指定同步时的基准目录。</span></div><div STYLE=\"--en-codeblock:true;box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\"><div><br/></div><div>$ rsync -a --delete --link-dest /compare/path /source/path /target/path</div><div><br/></div></div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">上面命令中，</span><code>--link-dest</code>参数指定基准目录<code>/compare/path</code>，然后源目录<code>/source/path</code>跟基准目录进行比较，找出变动的文件，将它们拷贝到目标目录<code>/target/path</code>。那些没变动的文件则会生成硬链接。这个命令的第一次备份时是全量备份，后面就都是增量备份了。</div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">下面是一个脚本示例，备份用户的主目录。</span></div><div STYLE=\"--en-codeblock:true;box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;\"><div><br/></div><div>#!/bin/bash</div><div><br/></div><div># A script to perform incremental backups using rsync</div><div><br/></div><div>set -o errexit</div><div>set -o nounset</div><div>set -o pipefail</div><div><br/></div><div>readonly SOURCE_DIR=&quot;${HOME}&quot;</div><div>readonly BACKUP_DIR=&quot;/mnt/data/backups&quot;</div><div>readonly DATETIME=&quot;$(date &apos;+%Y-%m-%d_%H:%M:%S&apos;)&quot;</div><div>readonly BACKUP_PATH=&quot;${BACKUP_DIR}/${DATETIME}&quot;</div><div>readonly LATEST_LINK=&quot;${BACKUP_DIR}/latest&quot;</div><div><br/></div><div>mkdir -p &quot;${BACKUP_DIR}&quot;</div><div><br/></div><div>rsync -av --delete \\</div><div>&nbsp; &quot;${SOURCE_DIR}/&quot; \\</div><div>&nbsp; --link-dest &quot;${LATEST_LINK}&quot; \\</div><div>&nbsp; --exclude=&quot;.cache&quot; \\</div><div>&nbsp; &quot;${BACKUP_PATH}&quot;</div><div><br/></div><div>rm -rf &quot;${LATEST_LINK}&quot;</div><div>ln -s &quot;${BACKUP_PATH}&quot; &quot;${LATEST_LINK}&quot;</div><div><br/></div></div><div><br/></div><div STYLE=\"padding-left:40px;\"><span STYLE=\"color:rgb(17, 17, 17);\">上面脚本中，每一次同步都会生成一个新目录</span><code>${BACKUP_DIR}/${DATETIME}</code>，并将软链接<code>${BACKUP_DIR}/latest</code>指向这个目录。下一次备份时，就将<code>${BACKUP_DIR}/latest</code>作为基准目录，生成新的备份目录。最后，再将软链接<code>${BACKUP_DIR}/latest</code>指向新的备份目录。</div><h2><span STYLE=\"color:rgb(0, 0, 0);\">七、配置项</span></h2><div><br/></div><div STYLE=\"padding-left:40px;\"><code>-a</code><span STYLE=\"color:rgb(17, 17, 17);\">、</span><code>--archive</code>参数表示存档模式，保存所有的元数据，比如修改时间（modification time）、权限、所有者等，并且软链接也会同步过去。</div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>--append</code><span STYLE=\"color:rgb(17, 17, 17);\">参数指定文件接着上次中断的地方，继续传输。</span></div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>--append-verify</code><span STYLE=\"color:rgb(17, 17, 17);\">参数跟</span><code>--append</code>参数类似，但会对传输完成后的文件进行一次校验。如果校验失败，将重新发送整个文件。</div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>-b</code><span STYLE=\"color:rgb(17, 17, 17);\">、</span><code>--backup</code>参数指定在删除或更新目标目录已经存在的文件时，将该文件更名后进行备份，默认行为是删除。更名规则是添加由<code>--suffix</code>参数指定的文件后缀名，默认是<code>~</code>。</div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>--backup-dir</code><span STYLE=\"color:rgb(17, 17, 17);\">参数指定文件备份时存放的目录，比如</span><code>--backup-dir=/path/to/backups</code>。</div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>--bwlimit</code><span STYLE=\"color:rgb(17, 17, 17);\">参数指定带宽限制，默认单位是 KB/s，比如</span><code>--bwlimit=100</code>。</div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>-c</code><span STYLE=\"color:rgb(17, 17, 17);\">、</span><code>--checksum</code>参数改变<code>rsync</code>的校验方式。默认情况下，rsync 只检查文件的大小和最后修改日期是否发生变化，如果发生变化，就重新传输；使用这个参数以后，则通过判断文件内容的校验和，决定是否重新传输。</div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>--delete</code><span STYLE=\"color:rgb(17, 17, 17);\">参数删除只存在于目标目录、不存在于源目标的文件，即保证目标目录是源目标的镜像。</span></div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>-e</code><span STYLE=\"color:rgb(17, 17, 17);\">参数指定使用 SSH 协议传输数据。</span></div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>--exclude</code><span STYLE=\"color:rgb(17, 17, 17);\">参数指定排除不进行同步的文件，比如</span><code>--exclude=&quot;*.iso&quot;</code>。</div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>--exclude-from</code><span STYLE=\"color:rgb(17, 17, 17);\">参数指定一个本地文件，里面是需要排除的文件模式，每个模式一行。</span></div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>--existing</code><span STYLE=\"color:rgb(17, 17, 17);\">、</span><code>--ignore-non-existing</code>参数表示不同步目标目录中不存在的文件和目录。</div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>-h</code><span STYLE=\"color:rgb(17, 17, 17);\">参数表示以人类可读的格式输出。</span></div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>-h</code><span STYLE=\"color:rgb(17, 17, 17);\">、</span><code>--help</code>参数返回帮助信息。</div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>-i</code><span STYLE=\"color:rgb(17, 17, 17);\">参数表示输出源目录与目标目录之间文件差异的详细情况。</span></div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>--ignore-existing</code><span STYLE=\"color:rgb(17, 17, 17);\">参数表示只要该文件在目标目录中已经存在，就跳过去，不再同步这些文件。</span></div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>--include</code><span STYLE=\"color:rgb(17, 17, 17);\">参数指定同步时要包括的文件，一般与</span><code>--exclude</code>结合使用。</div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>--link-dest</code><span STYLE=\"color:rgb(17, 17, 17);\">参数指定增量备份的基准目录。</span></div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>-m</code><span STYLE=\"color:rgb(17, 17, 17);\">参数指定不同步空目录。</span></div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>--max-size</code><span STYLE=\"color:rgb(17, 17, 17);\">参数设置传输的最大文件的大小限制，比如不超过200KB（</span><code>--max-size=&apos;200k&apos;</code>）。</div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>--min-size</code><span STYLE=\"color:rgb(17, 17, 17);\">参数设置传输的最小文件的大小限制，比如不小于10KB（</span><code>--min-size=10k</code>）。</div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>-n</code><span STYLE=\"color:rgb(17, 17, 17);\">参数或</span><code>--dry-run</code>参数模拟将要执行的操作，而并不真的执行。配合<code>-v</code>参数使用，可以看到哪些内容会被同步过去。</div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>-P</code><span STYLE=\"color:rgb(17, 17, 17);\">参数是</span><code>--progress</code>和<code>--partial</code>这两个参数的结合。</div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>--partial</code><span STYLE=\"color:rgb(17, 17, 17);\">参数允许恢复中断的传输。不使用该参数时，</span><code>rsync</code>会删除传输到一半被打断的文件；使用该参数后，传输到一半的文件也会同步到目标目录，下次同步时再恢复中断的传输。一般需要与<code>--append</code>或<code>--append-verify</code>配合使用。</div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>--partial-dir</code><span STYLE=\"color:rgb(17, 17, 17);\">参数指定将传输到一半的文件保存到一个临时目录，比如</span><code>--partial-dir=.rsync-partial</code>。一般需要与<code>--append</code>或<code>--append-verify</code>配合使用。</div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>--progress</code><span STYLE=\"color:rgb(17, 17, 17);\">参数表示显示进展。</span></div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>-r</code><span STYLE=\"color:rgb(17, 17, 17);\">参数表示递归，即包含子目录。</span></div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>--remove-source-files</code><span STYLE=\"color:rgb(17, 17, 17);\">参数表示传输成功后，删除发送方的文件。</span></div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>--size-only</code><span STYLE=\"color:rgb(17, 17, 17);\">参数表示只同步大小有变化的文件，不考虑文件修改时间的差异。</span></div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>--suffix</code><span STYLE=\"color:rgb(17, 17, 17);\">参数指定文件名备份时，对文件名添加的后缀，默认是</span><code>~</code>。</div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>-u</code><span STYLE=\"color:rgb(17, 17, 17);\">、</span><code>--update</code>参数表示同步时跳过目标目录中修改时间更新的文件，即不同步这些有更新的时间戳的文件。</div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>-v</code><span STYLE=\"color:rgb(17, 17, 17);\">参数表示输出细节。</span><code>-vv</code>表示输出更详细的信息，<code>-vvv</code>表示输出最详细的信息。</div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>--version</code><span STYLE=\"color:rgb(17, 17, 17);\">参数返回 rsync 的版本。</span></div><div><br/></div><div STYLE=\"padding-left:40px;\"><code>-z</code><span STYLE=\"color:rgb(17, 17, 17);\">参数指定同步时压缩数据。</span></div></en-note>      ",
      "content_path": null,
      "diff_base_variant_id": null,
      "metadata": {
        "checksum": "ca4d539ebe3e4f5ec8ba0730d08feb15097c601b2faeb22f64f04cfe2ba8669c",
        "path": "/Users/tang/workbench/article-classifier/backups/2023年6月/IT技术/rsync 用法教程.html"
      }
    },
    {
      "id": "4f79038c-8deb-4788-b366-bf9b2aae68cd",
      "note_id": "adb2bd3f-3564-4f3b-aae2-d3cb3fd2fcec",
      "variant_type": "clean_text",
      "version": 1,
      "created_by": "evernote_ingest:v0",
      "created_at": "2025-11-09T20:01:35.106603Z",
      "content": "---\ntitle: rsync 用法教程\nupdated: 2022-09-06 20:58:50Z\ncreated: 2022-09-06 20:58:16Z\n---\n\n作者：\n阮一峰\n日期：\n2020年8月26日\n一、简介\nrsync 是一个常用的 Linux 应用程序，用于文件同步。\n它可以在本地计算机与远程计算机之间，或者两个本地目录之间同步文件（但不支持两台远程计算机之间的同步）。它也可以当作文件复制工具，替代\ncp\n和\nmv\n命令。\n它名称里面的\nr\n指的是 remote，rsync 其实就是\"远程同步\"（remote sync）的意思。与其他文件传输工具（如 FTP 或 scp）不同，rsync 的最大特点是会检查发送方和接收方已有的文件，仅传输有变动的部分（默认规则是文件大小或修改时间有变动）。\n二、安装\n如果本机或者远程计算机没有安装 rsync，可以用下面的命令安装。\n# Debian\n$ sudo apt-get install rsync\n# Red Hat\n$ sudo yum install rsync\n# Arch Linux\n$ sudo pacman -S rsync\n注意，传输的双方都必须安装 rsync。\n三、基本用法\n3.1\n-r\n 参数\n本机使用 rsync 命令时，可以作为\ncp\n和\nmv\n命令的替代方法，将源目录同步到目标目录。\n$ rsync -r source destination\n上面命令中，\n-r\n表示递归，即包含子目录。注意，\n-r\n是必须的，否则 rsync 运行不会成功。\nsource\n目录表示源目录，\ndestination\n表示目标目录。\n如果有多个文件或目录需要同步，可以写成下面这样。\n$ rsync -r source1 source2 destination\n上面命令中，\nsource1\n、\nsource2\n都会被同步到\ndestination\n目录。\n3.2\n-a\n 参数\n-a\n参数可以替代\n-r\n，除了可以递归同步以外，还可以同步元信息（比如修改时间、权限等）。由于 rsync 默认使用文件大小和修改时间决定文件是否需要更新，所以\n-a\n比\n-r\n更有用。下面的用法才是常见的写法。\n$ rsync -a source destination\n目标目录\ndestination\n如果不存在，rsync 会自动创建。执行上面的命令后，源目录\nsource\n被完整地复制到了目标目录\ndestination\n下面，即形成了\ndestination/source\n的目录结构。\n如果只想同步源目录\nsource\n里面的内容到目标目录\ndestination\n，则需要在源目录后面加上斜杠。\n$ rsync -a source/ destination\n上面命令执行后，\nsource\n目录里面的内容，就都被复制到了\ndestination\n目录里面，并不会在\ndestination\n下面创建一个\nsource\n子目录。\n3.3\n-n\n 参数\n如果不确定 rsync 执行后会产生什么结果，可以先用\n-n\n或\n--dry-run\n参数模拟执行的结果。\n$ rsync -anv source/ destination\n上面命令中，\n-n\n参数模拟命令执行的结果，并不真的执行命令。\n-v\n参数则是将结果输出到终端，这样就可以看到哪些内容会被同步。\n3.4\n--delete\n 参数\n默认情况下，rsync 只确保源目录的所有内容（明确排除的文件除外）都复制到目标目录。它不会使两个目录保持相同，并且不会删除文件。如果要使得目标目录成为源目录的镜像副本，则必须使用\n--delete\n参数，这将删除只存在于目标目录、不存在于源目录的文件。\n$ rsync -av --delete source/ destination\n上面命令中，\n--delete\n参数会使得\ndestination\n成为\nsource\n的一个镜像。\n四、排除文件\n4.1\n--exclude\n 参数\n有时，我们希望同步时排除某些文件或目录，这时可以用\n--exclude\n参数指定排除模式。\n$ rsync -av --exclude='*.txt' source/ destination\n# 或者\n$ rsync -av --exclude '*.txt' source/ destination\n上面命令排除了所有 TXT 文件。\n注意，rsync 会同步以\"点\"开头的隐藏文件，如果要排除隐藏文件，可以这样写\n--exclude=\".*\"\n。\n如果要排除某个目录里面的所有文件，但不希望排除目录本身，可以写成下面这样。\n$ rsync -av --exclude 'dir1/*' source/ destination\n多个排除模式，可以用多个\n--exclude\n参数。\n$ rsync -av --exclude 'file1.txt' --exclude 'dir1/*' source/ destination\n多个排除模式也可以利用 Bash 的大扩号的扩展功能，只用一个\n--exclude\n参数。\n$ rsync -av --exclude={'file1.txt','dir1/*'} source/ destination\n如果排除模式很多，可以将它们写入一个文件，每个模式一行，然后用\n--exclude-from\n参数指定这个文件。\n$ rsync -av --exclude-from='exclude-file.txt' source/ destination\n4.2\n--include\n 参数\n--include\n参数用来指定必须同步的文件模式，往往与\n--exclude\n结合使用。\n$ rsync -av --include=\"*.txt\" --exclude='*' source/ destination\n上面命令指定同步时，排除所有文件，但是会包括 TXT 文件。\n五、远程同步\n5.1 SSH 协议\nrsync 除了支持本地两个目录之间的同步，也支持远程同步。它可以将本地内容，同步到远程服务器。\n$ rsync -av source/ username@remote_host:destination\n也可以将远程内容同步到本地。\n$ rsync -av username@remote_host:source/ destination\nrsync 默认使用 SSH 进行远程登录和数据传输。\n由于早期 rsync 不使用 SSH 协议，需要用\n-e\n参数指定协议，后来才改的。所以，下面\n-e ssh\n可以省略。\n$ rsync -av -e ssh source/ user@remote_host:/destination\n但是，如果 ssh 命令有附加的参数，则必须使用\n-e\n参数指定所要执行的 SSH 命令。\n$ rsync -av -e 'ssh -p 2234' source/ user@remote_host:/destination\n上面命令中，\n-e\n参数指定 SSH 使用2234端口。\n5.2 rsync 协议\n除了使用 SSH，如果另一台服务器安装并运行了 rsync 守护程序，则也可以用\nrsync://\n协议（默认端口873）进行传输。具体写法是服务器与目标目录之间使用双冒号分隔\n::\n。\n$ rsync -av source/ 192.168.122.32::module/destination\n注意，上面地址中的\nmodule\n并不是实际路径名，而是 rsync 守护程序指定的一个资源名，由管理员分配。\n如果想知道 rsync 守护程序分配的所有 module 列表，可以执行下面命令。\n$ rsync rsync://192.168.122.32\nrsync 协议除了使用双冒号，也可以直接用\nrsync://\n协议指定地址。\n$ rsync -av source/ rsync://192.168.122.32/module/destination\n六、增量备份\nrsync 的最大特点就是它可以完成增量备份，也就是默认只复制有变动的文件。\n除了源目录与目标目录直接比较，rsync 还支持使用基准目录，即将源目录与基准目录之间变动的部分，同步到目标目录。\n具体做法是，第一次同步是全量备份，所有文件在基准目录里面同步一份。以后每一次同步都是增量备份，只同步源目录与基准目录之间有变动的部分，将这部分保存在一个新的目标目录。这个新的目标目录之中，也是包含所有文件，但实际上，只有那些变动过的文件是存在于该目录，其他没有变动的文件都是指向基准目录文件的硬链接。\n--link-dest\n参数用来指定同步时的基准目录。\n$ rsync -a --delete --link-dest /compare/path /source/path /target/path\n上面命令中，\n--link-dest\n参数指定基准目录\n/compare/path\n，然后源目录\n/source/path\n跟基准目录进行比较，找出变动的文件，将它们拷贝到目标目录\n/target/path\n。那些没变动的文件则会生成硬链接。这个命令的第一次备份时是全量备份，后面就都是增量备份了。\n下面是一个脚本示例，备份用户的主目录。\n#!/bin/bash\n# A script to perform incremental backups using rsync\nset -o errexit\nset -o nounset\nset -o pipefail\nreadonly SOURCE_DIR=\"${HOME}\"\nreadonly BACKUP_DIR=\"/mnt/data/backups\"\nreadonly DATETIME=\"$(date '+%Y-%m-%d_%H:%M:%S')\"\nreadonly BACKUP_PATH=\"${BACKUP_DIR}/${DATETIME}\"\nreadonly LATEST_LINK=\"${BACKUP_DIR}/latest\"\nmkdir -p \"${BACKUP_DIR}\"\nrsync -av --delete \\\n  \"${SOURCE_DIR}/\" \\\n  --link-dest \"${LATEST_LINK}\" \\\n  --exclude=\".cache\" \\\n  \"${BACKUP_PATH}\"\nrm -rf \"${LATEST_LINK}\"\nln -s \"${BACKUP_PATH}\" \"${LATEST_LINK}\"\n上面脚本中，每一次同步都会生成一个新目录\n${BACKUP_DIR}/${DATETIME}\n，并将软链接\n${BACKUP_DIR}/latest\n指向这个目录。下一次备份时，就将\n${BACKUP_DIR}/latest\n作为基准目录，生成新的备份目录。最后，再将软链接\n${BACKUP_DIR}/latest\n指向新的备份目录。\n七、配置项\n-a\n、\n--archive\n参数表示存档模式，保存所有的元数据，比如修改时间（modification time）、权限、所有者等，并且软链接也会同步过去。\n--append\n参数指定文件接着上次中断的地方，继续传输。\n--append-verify\n参数跟\n--append\n参数类似，但会对传输完成后的文件进行一次校验。如果校验失败，将重新发送整个文件。\n-b\n、\n--backup\n参数指定在删除或更新目标目录已经存在的文件时，将该文件更名后进行备份，默认行为是删除。更名规则是添加由\n--suffix\n参数指定的文件后缀名，默认是\n~\n。\n--backup-dir\n参数指定文件备份时存放的目录，比如\n--backup-dir=/path/to/backups\n。\n--bwlimit\n参数指定带宽限制，默认单位是 KB/s，比如\n--bwlimit=100\n。\n-c\n、\n--checksum\n参数改变\nrsync\n的校验方式。默认情况下，rsync 只检查文件的大小和最后修改日期是否发生变化，如果发生变化，就重新传输；使用这个参数以后，则通过判断文件内容的校验和，决定是否重新传输。\n--delete\n参数删除只存在于目标目录、不存在于源目标的文件，即保证目标目录是源目标的镜像。\n-e\n参数指定使用 SSH 协议传输数据。\n--exclude\n参数指定排除不进行同步的文件，比如\n--exclude=\"*.iso\"\n。\n--exclude-from\n参数指定一个本地文件，里面是需要排除的文件模式，每个模式一行。\n--existing\n、\n--ignore-non-existing\n参数表示不同步目标目录中不存在的文件和目录。\n-h\n参数表示以人类可读的格式输出。\n-h\n、\n--help\n参数返回帮助信息。\n-i\n参数表示输出源目录与目标目录之间文件差异的详细情况。\n--ignore-existing\n参数表示只要该文件在目标目录中已经存在，就跳过去，不再同步这些文件。\n--include\n参数指定同步时要包括的文件，一般与\n--exclude\n结合使用。\n--link-dest\n参数指定增量备份的基准目录。\n-m\n参数指定不同步空目录。\n--max-size\n参数设置传输的最大文件的大小限制，比如不超过200KB（\n--max-size='200k'\n）。\n--min-size\n参数设置传输的最小文件的大小限制，比如不小于10KB（\n--min-size=10k\n）。\n-n\n参数或\n--dry-run\n参数模拟将要执行的操作，而并不真的执行。配合\n-v\n参数使用，可以看到哪些内容会被同步过去。\n-P\n参数是\n--progress\n和\n--partial\n这两个参数的结合。\n--partial\n参数允许恢复中断的传输。不使用该参数时，\nrsync\n会删除传输到一半被打断的文件；使用该参数后，传输到一半的文件也会同步到目标目录，下次同步时再恢复中断的传输。一般需要与\n--append\n或\n--append-verify\n配合使用。\n--partial-dir\n参数指定将传输到一半的文件保存到一个临时目录，比如\n--partial-dir=.rsync-partial\n。一般需要与\n--append\n或\n--append-verify\n配合使用。\n--progress\n参数表示显示进展。\n-r\n参数表示递归，即包含子目录。\n--remove-source-files\n参数表示传输成功后，删除发送方的文件。\n--size-only\n参数表示只同步大小有变化的文件，不考虑文件修改时间的差异。\n--suffix\n参数指定文件名备份时，对文件名添加的后缀，默认是\n~\n。\n-u\n、\n--update\n参数表示同步时跳过目标目录中修改时间更新的文件，即不同步这些有更新的时间戳的文件。\n-v\n参数表示输出细节。\n-vv\n表示输出更详细的信息，\n-vvv\n表示输出最详细的信息。\n--version\n参数返回 rsync 的版本。\n-z\n参数指定同步时压缩数据。",
      "content_path": null,
      "diff_base_variant_id": null,
      "metadata": {
        "language": "fr",
        "length": 6293,
        "rule_count": 1,
        "applied_rules": [
          {
            "rule_id": "whitespace",
            "description": "Normalize whitespace",
            "note": "collapsed whitespace"
          }
        ]
      }
    }
  ],
  "extractions": [],
  "journal": {
    "id": "a012d2a0-d92e-48bc-ba61-bee5b7818569",
    "note_id": "adb2bd3f-3564-4f3b-aae2-d3cb3fd2fcec",
    "stage": "ingest",
    "agent_id": "evernote_ingest:v0",
    "started_at": "2025-11-09T20:01:35.106608Z",
    "finished_at": "2025-11-09T20:01:35.106608Z",
    "status": "success",
    "input_ref": {
      "task_id": "5f1db223-d256-4b66-b790-5b213431ebcc",
      "source_path": "/Users/tang/workbench/article-classifier/backups/2023年6月/IT技术/rsync 用法教程.html",
      "checksum": "ca4d539ebe3e4f5ec8ba0730d08feb15097c601b2faeb22f64f04cfe2ba8669c"
    },
    "output_ref": {
      "ingest_source": "65e964e5-4680-4257-862c-137c503dc5a6",
      "note": "adb2bd3f-3564-4f3b-aae2-d3cb3fd2fcec",
      "variants": [
        "797b1439-700a-46c3-be1d-e451f951c2a4",
        "4f79038c-8deb-4788-b366-bf9b2aae68cd"
      ]
    },
    "error_detail": null
  }
}