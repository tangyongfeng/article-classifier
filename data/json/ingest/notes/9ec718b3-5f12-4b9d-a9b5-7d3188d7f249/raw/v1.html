---
title: 基于WiFi的电子标签定位算法 - gigigo168的博客 - CSDN博客
updated: 2018-11-05 02:36:47Z
created: 2018-11-05 02:36:47Z
source: https://blog.csdn.net/gigigo168/article/details/49305215
---


<en-note>
  <div>
<div STYLE="font-size: 16px; display: inline-block;  min-width: 100%;"><div STYLE="background-color:transparent;font:inherit;vertical-align:baseline;"><div STYLE="font-family:&quot;PT Serif&quot;;font-size:16px;line-height:1.5em;color:rgb(31, 9, 9);text-align:left;background-color:transparent;font:inherit;vertical-align:baseline;"><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><div STYLE="width:36em;z-index:200;padding-left:2em;padding-right:2em;margin-left:auto;margin-right:auto;position:relative;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><div STYLE="position:relative;margin-left:-25px;margin-right:25px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><div STYLE="padding-top:4.5em;padding-bottom:9em;position:relative;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;"><div STYLE="margin-bottom:0px;position:relative;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><div STYLE="margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><div STYLE="margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><h1 STYLE="font-family:&quot;PT Serif&quot;;text-align:left;padding:0px;margin:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:normal;font-size:35px;line-height:35px;margin-bottom:20px;">基于WiFi的电子标签定位算法</h1><div STYLE="margin-bottom:0px;position:relative;margin:0px;height:1em;line-height:1;text-align:center;padding:0px;border:0px;font:inherit;vertical-align:baseline;padding-top:1.5em;padding-bottom:1.5em;"><div STYLE="background:-webkit-linear-gradient(0deg, rgb(243, 242, 238) 1%, rgb(31, 9, 9) 50%, rgb(243, 242, 238) 99%);margin-bottom:0px;position:absolute;left:-4em;top:50%;z-index:10;width:100%;padding-left:4em;padding-right:4em;height:0.1em;margin:0px;opacity:0.5;padding:0px;border:0px;font:inherit;vertical-align:baseline;"><span STYLE="font:inherit;background:-webkit-linear-gradient(0deg, rgb(243, 242, 238) 1%, rgb(31, 9, 9) 50%, rgb(243, 242, 238) 99%);position:absolute;left:-4em;top:50%;z-index:10;width:100%;padding-left:4em;padding-right:4em;height:0.1em;margin:0px;opacity:0.5;"></span></div></div></div>
&Tab;&Tab;&Tab;<div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
&Tab;&Tab;&Tab;&Tab;<div STYLE="margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;">
&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;2015年10月21日 15:25:58
&Tab;&Tab;&Tab;&Tab;&Tab;<a HREF="https://me.csdn.net/gigigo168" TARGET="_blank" STYLE="color:rgb(6, 85, 136);margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;">gigigo168</a>
&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;阅读数：2068
&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;
&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;
&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;标签：
&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;<a HREF="http://so.csdn.net/so/search/s.do?q=wi-fi&t=blog" TARGET="_blank" STYLE="color:rgb(6, 85, 136);margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;">wi-fi&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;</a>
&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;
&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;</div>
&Tab;&Tab;&Tab;&Tab;
&Tab;&Tab;&Tab;</div>
&Tab;&Tab;
&Tab;
&Tab;<div STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;display:block;">
&Tab;&Tab;<div STYLE="margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;">
&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;            
&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;<div STYLE="margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;">
                
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
随着无线通信的快速发展，由此引起的关于室内定位的无线网络和RFID技术的结合也越来越受关注。人们对物品、人员位置的需求也越来越强烈。在室外的定位，如熟知的GPS定位已经做到让很多人都满意的程度，但是一旦进入到室内，由于建筑物的阻挡以及多径效应，GPS在室内的定位的效果大打折扣，所以室内定位的研究成为定位后续的研究重点。住公司中需要对人员和物品进行定位的时候范围很大。传统的标签定位的距离有缺陷，限制了其广泛的应用。所以义提出了RFID技术和无线网络结合，扩大其定位的范围。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
<a HREF="http://s4.51cto.com/wyfs02/M02/56/CC/wKiom1SOTwGRX7RzAAErljXHLfU533.jpg" TARGET="_blank" STYLE="color:rgb(6, 85, 136);display:block;margin:0px;padding:0px;background-color:transparent;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;"></a></p><div STYLE="display:block;text-align:center;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1em;margin-top:1em;"><a HREF="http://s4.51cto.com/wyfs02/M02/56/CC/wKiom1SOTwGRX7RzAAErljXHLfU533.jpg" TARGET="_blank" STYLE="color:rgb(6, 85, 136);display:block;margin:0px;padding:0px;background-color:transparent;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;"><img src="../_resources/wKiom1SOTwGRX7RzAAErljXHLfU533.jpg"  type="image/jpeg" hash="9299439fa15314862347cba0f827eccc" width="362" height="221" style="border-color:rgb(6, 85, 136);display:block;max-width:100%;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;" alt="wKiom1SOTwGRX7RzAAErljXHLfU533.jpg" /></en-media></a></div><p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;"></p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
<a HREF="http://blog.sina.com.cn/s/blog_14fd481440102vzt6.html" TARGET="_blank" STYLE="color:rgb(6, 85, 136);margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;">无线WiFi</a>在一个免费的2.4GHz频段，有很高的数据传输速度。所以选择基于WiFi网络通信的定位标签。WiFi网络有如下优势：WiFi的工作频段在2.4GHz，而且处于免费频段，对用户来说不需要额外的费用;WiFi的传输距离可以达到100m，可以覆盖整个大楼;WiFi的传输速率很高，可达到54 Mbps。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
影响定位的精确度不仅仅是关于定位技术的选择，同时定位算法的选择也会影响其定位精度。常见的室内定位的算法主要分为两类：基于测距技术的定位算法和距离无关的算法。基于测距技术的算法一般是通过节点之间的距离或者角度来计算出未知节点的位置，实际运用中常见的有：基于接收信号强度指示算法(RSSI)、到达角度算法(AOA)、到达时间算法(TOA)等。距离无关的算法有：质心法、APIT算法、凸规划算法等。这些算法都是利用节点之间的邻近关系实现定位的。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
一般来说，基于测距技术的算法比无需测距的精度要高。本文采用基于无线网络的RFID技术，并在此基础上提出一种算法，实现误差范围小的定位系统。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
系统的硬件结构</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
射频识别(Radio Frequency Identification，RFID)俗称电子标签。RFID是一种非接触式的自动识别技术，它通过射频信号自动识别目标对象并获取相关数据，识别工作无需人工干预，可工作于各种恶劣环境。RFID技术可识别高速运动物体并可同时识别多个标签，操作快捷方便。RFID是一种简单的无线系统，只有两个基本器件，该系统用于控制、检测和跟踪物体。系统由一个询问器(或阅读器)和很多应答器(或标签)组成。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
定位系统的硬件包括：阅读器、电子标签和无线WiFi模块。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
阅读器是用于读取/写入标签信息的设备。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
电子标签分为有源和无源两类。有源技术电子标签内部有电池，它的寿命一般比无源的长。在电池更换前一直通过设定频段向外发送信息。本文所采用的有源技术电子标签具有长时间的寿命。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
无线WiFi模块主要是用于电子标签、阅读器以及AP(用于接收标签的发射信号)之间的通信。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
RFID定位可用于仓库管理、公司人员、物品以及医院病人的准确定位。但是由于距离限制了其发展，所以把无线WiFi技术和RFID技术结合起来，进一步地提高定位的范围和精度。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
系统软件及定位算法</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
1)基于信号强度算法</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
传统的信号传播容易受到折射、反射、绕射、衍射等影响，接收到的信号强度是各种途径传播来的信号的叠加。所以有时候信号强度增大，有时候又减小。经过大量的实践，发现接收信号强度服从log-normal分布。通过信号在传播中的衰减来估计节点之间的距离，根据信道模型求解接收到待定位置的信号场强：</p>

<img src="../_resources/wKioL1SOT6fARykdAAAMnbMHa28508.jpg"  type="image/jpeg" hash="7233f9f458c9ac6085a4912d2207b540" width="385" height="34" style="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;" alt="wKioL1SOT6fARykdAAAMnbMHa28508.jpg" /></en-media>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
式中：n为路径损耗指数，与周围的环境有关;X&Sigma;是标准差为&Sigma;的正态随机变量;d0是参考距离，在室内环境中通常取1 m;PL(d0)为参考位置的信号强度。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
假设有n个AP，m个参考标签，则AP点接收到的待定标签的强度量P=(AP1，AP2，&hellip;，APn)，采集到的第t个参考标签的强度矢量为St=(St1，St2，&hellip;，Stn)，则待定标签和参考标签St之间的欧氏距离为：</p>

<img src="../_resources/wKiom1SOTwrx3p1ZAAALq4_fp5c425.jpg"  type="image/jpeg" hash="68d46421d22118a40fe973377c9f852c" width="370" height="42" style="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;" alt="wKiom1SOTwrx3p1ZAAALq4_fp5c425.jpg" /></en-media>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
基于信号强度算法代表是LANDMARC算法。该算法主要通过比较不同Et来寻找与待定标签位置最近的参考标签。当由K个邻近的参考标签来确定一个待测标签的时候，我们称之为&ldquo;K-最邻近算法&rdquo;，待定标签坐标是(x，y)：</p>

<img src="../_resources/wKiom1SOTwqxOH_BAAAHQYIqdEI834.jpg"  type="image/jpeg" hash="cda9456e25c2bf7f7eafac7f591ca596" width="194" height="39" style="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;" alt="wKiom1SOTwqxOH_BAAAHQYIqdEI834.jpg" /></en-media>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
其中的Wi和(xi，yi)分别是第i个邻居参考标签的权重因子和坐标位置。根据经验：</p>

<img src="../_resources/wKioL1SOT6jTeMWTAAAIvnzZ_Vg749.jpg"  type="image/jpeg" hash="1ff896d4ac1b1a95fde5d7dbcf4e6d64" width="302" height="59" style="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;" alt="wKioL1SOT6jTeMWTAAAIvnzZ_Vg749.jpg" /></en-media>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
权重越大的，E值越小。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
LANDMARC箅法虽然能够处理比较复杂的环境，但是在一些封闭的环境中可能会出现多径效应，导致定位精度不高。又有研究者对LANDM ARC算法提出了改进：把不同的阅读器中收获到的标签的RSSI值加入到一个集合，然后求出集合中频率最高的标签作为最近距离的标签，然后再使用经验公式求出待测标签的坐标位置。这样可以获得更准确的精度。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
2)三边定位算法</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
三边定位法：分别以已知位置的3个AP为圆心，以各个到待测标签的距离最近参考标签的距离为半径作圆。所得的3个圆的交点为D。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
设位置节点D(x，y)，已知A、B、C三点的坐标为(x1，y1)，(x2，y2)，(x3，y3)。它们到D的距离分别是d1、d2、d3。则D的位置可以通过下列方程中的任意两个进行求解。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
但是在实际应用中，由于测量误差的存在，三个圆交于一点的情况很难存在。而这是经常的事情，这会导致方程无解，无法定位出待测目标的位置。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
3)本文采用的算法</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
本方案中，我们采用的定位算法是基于接收信号强度的算法(即LANDMARC算法)，并在LANDMARC算法的后面利用三边定位算法，使其更准确。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
实验前在某公司大楼的走道和三间房内各安置每隔3 m固定一个电子标签(参考标签)，在该层楼的东南两北角各放置一个AP。做好上位机与下位机的无线通信(软件程序的服务器和客户端的连接)。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
实验进行时，当待测标签进入到AP(4个)的范围内，开始接收到待测标签发出的信号场强，并传入上位机。同时也接收各个参考标签在各个AP的信号场强，并传入上位机。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
定位算法则把待测标签在4个AP(AP1，AP2，AP3，AP4)上的场强建立成一个场强矢量，同时参考标签也建立成场强矢量。通过LANDMARC算法即通过比较待测标签场强矢量与参考标签场强矢量的欧氏距离，找出 3个欧氏距离最小的参考标签，并得知3个参考标签的具体位置(在实验前期，参考标签放置时已经有记录)。对于3个参考点，不用再根据信号的强度来决定其半径，而是3个以参考点为圆心，以最近参考标签之间的距离(以确定每隔几米放置一个参考标签)的3/4长度为半径做3个圆，这样3个圆两两相交的可能性会增加。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
由于3个圆很难在同一个点相交，所以对于3个圆之间的关系有3种：</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
◆3个圆两两相交，并且3个圆有公共区域;</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
◆3个网两两相交，但没有公共区域;</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
◆3个圆不相交。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
具体关系如下：</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
①当3个圆有公共区域时，则公共区域必然有3个交点，以3个交点作三角形，则待测标签的坐标即是三角形内心坐标。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
②当两两相交无公共区域时，必然有两两公共区域。取两圆相交区域的两个交点的连线的中点，然后以这3个中点做三角形，其内心就是待测标签内心坐标。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
③3个圆不相交时舍弃，接受下一组最近3个参考标签，若3次还没有找到相交情况，即用3个参考标签做的位置做三角形，其内心就是待测标签的位置。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
本算法的优势为在原来LANDMARC算法的定位精度上，再进行三角定位，进一步提高定位精度。同时，以参考标签之间的距离来进行进一步的三角定位，可以减少额外的计算，并且可以减少由于参考标签场强的变化带来的重复测量。</p>
<p STYLE="margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">
结语</p>
<p STYLE="margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;">
本文主要讨论了基于信号强度算法和基于非测距的三边算法，同时对LANDMARC算法进行了进一步的改进。由相关实验结果得出：该算法可以达到定位精度在1.5 m左右的误差，该方案适合广泛运用。</p>
            </div>
                </div>
&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;
&Tab;&Tab;&Tab;&Tab;&Tab;
&Tab;&Tab;&Tab;&Tab;&Tab;</div>
&Tab;
</div></div></div><div STYLE="position:absolute;top:-1000px;left:-1000px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;">Measure</div><div STYLE="margin-bottom:0px;position:absolute;top:-1000px;left:-1000px;line-height:1;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;">Measure</div></div></div></div></div></div></div></div>
</div>
</en-note>      