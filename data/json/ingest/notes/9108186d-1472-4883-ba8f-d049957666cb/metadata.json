{
  "ingest_source": {
    "id": "ddfa630c-c870-4de8-989e-bd6091a650dd",
    "source_type": "evernote_html",
    "source_path": "/Users/tang/workbench/article-classifier/backups/2023年6月/IT技术/OpenWrt下WiFi无线指标的提取（MAC地址、RSSI等） - LeatherWang的博客 .html",
    "collected_at": "2025-11-09T20:01:34.227414Z",
    "external_id": null,
    "title_hint": null,
    "language_hint": "vi",
    "captured_at": null,
    "checksum": "ffbcda0574e2da2c794f6c27e25d2e3375c20d042c23a6d5e16c52c23797993c",
    "status": "pending",
    "notes": {
      "batch_id": null
    }
  },
  "note": {
    "id": "9108186d-1472-4883-ba8f-d049957666cb",
    "ingest_source_id": "ddfa630c-c870-4de8-989e-bd6091a650dd",
    "canonical_title": "OpenWrt下WiFi无线指标的提取（MAC地址、RSSI等） - LeatherWang的博客 ",
    "language": "vi",
    "ingested_at": "2025-11-09T20:01:34.227418Z",
    "created_at": null,
    "status": "active",
    "importance": 0,
    "attributes": {
      "source_filename": "OpenWrt下WiFi无线指标的提取（MAC地址、RSSI等） - LeatherWang的博客 .html"
    }
  },
  "variants": [
    {
      "id": "7a7920bf-8a77-4f57-a574-f20c7fdc266b",
      "note_id": "9108186d-1472-4883-ba8f-d049957666cb",
      "variant_type": "raw_html",
      "version": 1,
      "created_by": "evernote_ingest:v0",
      "created_at": "2025-11-09T20:01:34.227421Z",
      "content": "---\ntitle: OpenWrt下WiFi无线指标的提取（MAC地址、RSSI等） - LeatherWang的博客 - CSDN博客\nupdated: 2018-11-02 06:21:53Z\ncreated: 2018-11-02 06:21:53Z\nsource: https://blog.csdn.net/hzwwpgmwy/article/details/70184093\n---\n\n\n<en-note>\n  <div>\n<div STYLE=\"font-size: 16px; display: inline-block;  min-width: 100%;\"><div STYLE=\"background-color:transparent;font:inherit;vertical-align:baseline;\"><div STYLE=\"font-family:&quot;PT Serif&quot;;font-size:16px;line-height:1.5em;color:rgb(31, 9, 9);text-align:left;background-color:transparent;font:inherit;vertical-align:baseline;\"><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\"><div STYLE=\"width:36em;z-index:200;padding-left:2em;padding-right:2em;margin-left:auto;margin-right:auto;position:relative;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\"><div STYLE=\"position:relative;margin-left:-25px;margin-right:25px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\"><div STYLE=\"padding-top:4.5em;padding-bottom:9em;position:relative;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\"><div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\"><div STYLE=\"margin-bottom:0px;position:relative;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\"><div STYLE=\"margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\"><div STYLE=\"margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\"><h1 STYLE=\"font-family:&quot;PT Serif&quot;;text-align:left;padding:0px;margin:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:normal;font-size:35px;line-height:35px;margin-bottom:20px;\">OpenWrt下WiFi无线指标的提取（MAC地址、RSSI等）</h1><div STYLE=\"margin-bottom:0px;position:relative;margin:0px;height:1em;line-height:1;text-align:center;padding:0px;border:0px;font:inherit;vertical-align:baseline;padding-top:1.5em;padding-bottom:1.5em;\"><div STYLE=\"background:-webkit-linear-gradient(0deg, rgb(243, 242, 238) 1%, rgb(31, 9, 9) 50%, rgb(243, 242, 238) 99%);margin-bottom:0px;position:absolute;left:-4em;top:50%;z-index:10;width:100%;padding-left:4em;padding-right:4em;height:0.1em;margin:0px;opacity:0.5;padding:0px;border:0px;font:inherit;vertical-align:baseline;\"><span STYLE=\"font:inherit;background:-webkit-linear-gradient(0deg, rgb(243, 242, 238) 1%, rgb(31, 9, 9) 50%, rgb(243, 242, 238) 99%);position:absolute;left:-4em;top:50%;z-index:10;width:100%;padding-left:4em;padding-right:4em;height:0.1em;margin:0px;opacity:0.5;\"></span></div></div></div>\n&Tab;&Tab;&Tab;<div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">\n&Tab;&Tab;&Tab;&Tab;<div STYLE=\"margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\">\n&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;2017年04月15日 13:43:00\n&Tab;&Tab;&Tab;&Tab;&Tab;<a HREF=\"https://me.csdn.net/hzwwpgmwy\" TARGET=\"_blank\" STYLE=\"color:rgb(6, 85, 136);margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;\">Leather_Wang</a>\n&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;阅读数：6053\n&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;\n&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;\n&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;标签：\n&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;<a HREF=\"http://so.csdn.net/so/search/s.do?q=openwrt&t=blog\" TARGET=\"_blank\" STYLE=\"color:rgb(6, 85, 136);margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;\">openwrt&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;</a><a HREF=\"http://so.csdn.net/so/search/s.do?q=%E8%B7%AF%E7%94%B1%E5%99%A8&t=blog\" TARGET=\"_blank\" STYLE=\"color:rgb(6, 85, 136);margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;\">路由器&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;</a><a HREF=\"http://so.csdn.net/so/search/s.do?q=wi-fi&t=blog\" TARGET=\"_blank\" STYLE=\"color:rgb(6, 85, 136);margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;\">wi-fi&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;</a>\n&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;更多\n&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;<div STYLE=\"margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\">\n&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;个人分类：\n&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;<a HREF=\"https://blog.csdn.net/hzwwpgmwy/article/category/6818134\" TARGET=\"_blank\" STYLE=\"color:rgb(6, 85, 136);margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;\">OpenWrt&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;</a>\n&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;</div>\n&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;</div>\n&Tab;&Tab;&Tab;&Tab;\n&Tab;&Tab;&Tab;</div>\n&Tab;&Tab;\n&Tab;\n&Tab;<div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;display:block;\">\n&Tab;&Tab;<div STYLE=\"margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\">\n&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;<div STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">\n&Tab;&Tab;&Tab;&Tab;&Tab;版权声明：本文为博主原创文章，未经博主允许不得转载。&Tab;&Tab;&Tab;&Tab;&Tab;https://blog.csdn.net/hzwwpgmwy/article/details/70184093&Tab;&Tab;&Tab;&Tab;</div>\n&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;            <div STYLE=\"margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\">\n&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;\n&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;\n&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">实验平台如下：</p>\n\n<blockquote STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;quotes:none;margin-bottom:1.5em;font-style:italic;border-left:5px solid;margin-left:2em;padding-left:1em;\"><span STYLE=\"font:inherit;quotes:none;font-style:italic;\"></span>\n  <p STYLE=\"margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\">路由器型号：<a HREF=\"https://wiki.openwrt.org/toh/tp-link/tl-wr703n\" TARGET=\"_blank\" STYLE=\"color:rgb(6, 85, 136);margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;\">TP-LINK TL-WR703N v1 </a> <br/>\n  OpenWrt版本：<a HREF=\"https://openwrt.org/\" TARGET=\"_blank\" STYLE=\"color:rgb(6, 85, 136);margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;\">Chaos Calmer 15.05.1</a> </p>\n<span STYLE=\"font:inherit;quotes:none;font-style:italic;\"></span></blockquote>\n\n\n\n<h2 STYLE=\"font-family:&quot;PT Serif&quot;;text-align:left;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;font-size:30px;line-height:35px;margin-top:35px;margin-bottom:15px;\"><strong STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;\">前言：</strong></h2>\n\n<blockquote STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;quotes:none;margin-bottom:1.5em;font-style:italic;border-left:5px solid;margin-left:2em;padding-left:1em;\"><span STYLE=\"font:inherit;quotes:none;font-style:italic;\"></span>\n  <p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">802.11帧有三种，管理帧、控制帧，数据帧。每种类型帧又分很多种&ldquo;子帧&rdquo;。手机WIFI开启扫描热点、连接热点的过程主要涉及管理帧。</p>\n  \n  <p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">当我们的手机扫描周边WiFi热点时，会发出一种probe_request的帧（它是管理帧的一种，其中包含了手机的MAC地址），遍历空间所有信道，等待AP返回Probe Response帧。</p>\n  \n  <p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">这个交互过程中，终端到各AP的信号强度值是一清二楚的，从而可以采用RSSI等方式来定位。也就是说只要你手机终端开启了Wi-Fi，在后台它是会与空间内的AP发生一次或反复的帧听与响应，这些可以帧听，基本暴露了你在空间的大致位置了。  </p>\n  \n  <p STYLE=\"margin-bottom:0px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\">通过这种方式，WiFi热点亦可扫描并收集周围的AP信号，无论是否加密，是否已连接，甚至信号强度不足以显示在无线信号列表中，都可以获取到AP广播出来的MAC地址。</p>\n<span STYLE=\"font:inherit;quotes:none;font-style:italic;\"></span></blockquote>\n\n<hr STYLE=\"border-color:rgb(31, 9, 9);border-top:none;border-right:none;border-bottom:1px solid;border-left:none;\"/>\n\n\n\n<h2 STYLE=\"font-family:&quot;PT Serif&quot;;text-align:left;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;font-size:30px;line-height:35px;margin-top:35px;margin-bottom:15px;\"><strong STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;\">一、基本原理</strong></h2>\n\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">利用工作在monitor模式的无线网卡可以探测到所有经过它的数据流，在AP端使用无线网卡抓取AP与AP、AP与STA之间的MAC层管理数据包，然后对抓取的MAC帧进行实时解包，提取所需要的Timestamp、MAC address、RSSI等信息，并将其存入服务器数据库中，用于后续的wifi定位、链路分析等。</p>\n\n<hr STYLE=\"border-color:rgb(31, 9, 9);border-top:none;border-right:none;border-bottom:1px solid;border-left:none;\"/>\n\n\n\n<h2 STYLE=\"font-family:&quot;PT Serif&quot;;text-align:left;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;font-size:30px;line-height:35px;margin-top:35px;margin-bottom:15px;\"><strong STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;\">二、获取周围wifi强度的两种方法：</strong></h2>\n\n\n\n<h3 STYLE=\"font-family:&quot;PT Serif&quot;;text-align:left;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:normal;font-size:30px;line-height:35px;margin-top:35px;margin-bottom:15px;\"><strong STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;\">1、抓取AP与AP之间的MAC层管理数据包</strong></h3>\n\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">OpenWrt路由器无线网卡工作于AP模式，无需连接周围wifi，通过以下指令即可监听到它们的MAC地址、RSSI强度等信息。</p>\n\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">如何在Linxu程序内部嵌入shell终端指令并获取该指令的输出结果。请参考 <a HREF=\"http://blog.csdn.net/hzwwpgmwy/article/details/70186646\" TARGET=\"_blank\" STYLE=\"color:rgb(6, 85, 136);margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;\">此处</a>。</p>\n\n\n\n<pre STYLE=\"background-color:rgb(243, 242, 238);font-family:Inconsolata;width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;\"><code STYLE=\"font-family:Inconsolata;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:1.15em;line-height:1.71429em;\">iw dev wlan0 scan | egrep &quot;^BSS|singal&quot;//参考注释[4]</code><ul STYLE=\"margin:0px 0px 1.5em 1.5em;padding:0px;border:0px;font:inherit;vertical-align:baseline;list-style:none outside none;list-style-type:none;\"><li STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;list-style-type:inherit;list-style-position:outside;\">1</li></ul></pre>\n\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">最终效果：在703N路由器测试最快速度为 0.8秒以上，<strong STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;\">此外获得的RSSI不稳定，浮动较大，</strong>不适合做控制，故寻找第二种方法。</p>\n\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">原因分析：此条语句执行时，会将周围所有的 wifi热点的MAC层管理数据包都捕获进来，然后再挨个解包、提取，这个过程将花费相当长时间，造成读取线程堵塞。</p>\n\n<h3 STYLE=\"font-family:&quot;PT Serif&quot;;text-align:left;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:normal;font-size:30px;line-height:35px;margin-top:35px;margin-bottom:15px;\"><strong STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;\">2、抓取AP与STA之间的MAC层管理数据包</strong></h3>\n\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">OpenWrt路由器无线网卡工作于AP模式并作为Master路由器，其它路由器作为Client，连上该AP，即可通过下列指令查看所有连入该AP的客户端的信息。</p>\n\n\n\n<pre STYLE=\"background-color:rgb(243, 242, 238);font-family:Inconsolata;width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;\"><code STYLE=\"font-family:Inconsolata;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:1.15em;line-height:1.71429em;\">iw dev wlan0 station dump | egrep &quot;Station|singal:&quot;//参考注释[5]\n//iw wlan0 station get 40:b0:fa:c1:75:41//查看单个路由器信息</code><ul STYLE=\"margin:0px 0px 1.5em 1.5em;padding:0px;border:0px;font:inherit;vertical-align:baseline;list-style:none outside none;list-style-type:none;\"><li STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;list-style-type:inherit;list-style-position:outside;\">1</li><li STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;list-style-type:inherit;list-style-position:outside;\">2</li></ul></pre>\n\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">最终效果：在703N路由器测试最快速度为 28ms，获得的RSSI较为稳定，实时性也满足要求。</p>\n\n<hr STYLE=\"border-color:rgb(31, 9, 9);border-top:none;border-right:none;border-bottom:1px solid;border-left:none;\"/>\n\n<h2 STYLE=\"font-family:&quot;PT Serif&quot;;text-align:left;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-weight:bold;font-size:30px;line-height:35px;margin-top:35px;margin-bottom:15px;\">参考文章：</h2>\n\n<p STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">[1] <a HREF=\"http://blog.dujiong.net/2016/04/20/wifi-data-get/\" TARGET=\"_blank\" STYLE=\"color:rgb(6, 85, 136);margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;\">wifi关键数据提取</a> <br/>\n[2] <a HREF=\"https://blog.csdn.net/hzwwpgmwy/article/details/Linux%E4%BD%BF%E7%94%A8tcpdump%E6%8A%93%E8%8E%B7%E5%8F%96WIFI%E5%8C%85\" TARGET=\"_blank\" STYLE=\"color:rgb(6, 85, 136);margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;\">Linux使用tcpdump抓获取WIFI包</a> <br/>\n[3] <a HREF=\"http://www.latelee.org/programming-under-linux/capture-wifi-mac-using-socket.html\" TARGET=\"_blank\" STYLE=\"color:rgb(6, 85, 136);margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;\">Linux系统无线网络抓包程序(分析手机WIFI MAC地址)</a> <br/>\n[4] <a HREF=\"http://www.aneasystone.com/category/linux/\" TARGET=\"_blank\" STYLE=\"color:rgb(6, 85, 136);margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;\">实战无线网络分析（篇一）无线监听</a> <br/>\n[5] <a HREF=\"http://stackoverflow.com/questions/35753319/how-to-get-rssi-in-a-linux-ap-iw-station-dump-doesnt-work\" TARGET=\"_blank\" STYLE=\"color:rgb(6, 85, 136);margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;text-decoration:none;\">How to get RSSI in a linux AP (iw station dump doesn&rsquo;t work)</a></p>\n\n<pre STYLE=\"background-color:rgb(243, 242, 238);font-family:Inconsolata;width:auto;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:0.875em;line-height:1.71429em;\"><code STYLE=\"font-family:Inconsolata;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;font-size:1.15em;line-height:1.71429em;\">                                                                        @本文作者：LeathreWang\n</code><ul STYLE=\"margin:0px 0px 1.5em 1.5em;padding:0px;border:0px;font:inherit;vertical-align:baseline;list-style:none outside none;list-style-type:none;\"><li STYLE=\"margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;list-style-type:inherit;list-style-position:outside;\">1</li></ul></pre>            </div>\n&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;\n                </div>\n&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;&Tab;\n&Tab;&Tab;&Tab;&Tab;&Tab;\n&Tab;&Tab;&Tab;&Tab;&Tab;</div>\n&Tab;\n\n\n</div></div></div><div STYLE=\"position:absolute;top:-1000px;left:-1000px;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;margin-bottom:1.5em;\">Measure</div><div STYLE=\"margin-bottom:0px;position:absolute;top:-1000px;left:-1000px;line-height:1;margin:0px;padding:0px;border:0px;font:inherit;vertical-align:baseline;\">Measure</div></div></div></div></div></div></div></div>\n</div>\n</en-note>      ",
      "content_path": null,
      "diff_base_variant_id": null,
      "metadata": {
        "checksum": "ffbcda0574e2da2c794f6c27e25d2e3375c20d042c23a6d5e16c52c23797993c",
        "path": "/Users/tang/workbench/article-classifier/backups/2023年6月/IT技术/OpenWrt下WiFi无线指标的提取（MAC地址、RSSI等） - LeatherWang的博客 .html"
      }
    },
    {
      "id": "f7cb9fa3-a253-4b54-a505-7ddc4c063611",
      "note_id": "9108186d-1472-4883-ba8f-d049957666cb",
      "variant_type": "clean_text",
      "version": 1,
      "created_by": "evernote_ingest:v0",
      "created_at": "2025-11-09T20:01:34.227424Z",
      "content": "---\ntitle: OpenWrt下WiFi无线指标的提取（MAC地址、RSSI等） - LeatherWang的博客 - CSDN博客\nupdated: 2018-11-02 06:21:53Z\ncreated: 2018-11-02 06:21:53Z\nsource: https://blog.csdn.net/hzwwpgmwy/article/details/70184093\n---\n\nOpenWrt下WiFi无线指标的提取（MAC地址、RSSI等）\n\n 2017年04月15日 13:43:00\n\nLeather_Wang\n\n 阅读数：6053\n\n 标签：\n\nopenwrt\n路由器\nwi-fi\n\n 更多\n\n 个人分类：\n\nOpenWrt\n\n 版权声明：本文为博主原创文章，未经博主允许不得转载。 https://blog.csdn.net/hzwwpgmwy/article/details/70184093\n\n实验平台如下：\n\n路由器型号：\nTP-LINK TL-WR703N v1\n\n  OpenWrt版本：\nChaos Calmer 15.05.1\n\n前言：\n\n802.11帧有三种，管理帧、控制帧，数据帧。每种类型帧又分很多种“子帧”。手机WIFI开启扫描热点、连接热点的过程主要涉及管理帧。\n\n当我们的手机扫描周边WiFi热点时，会发出一种probe_request的帧（它是管理帧的一种，其中包含了手机的MAC地址），遍历空间所有信道，等待AP返回Probe Response帧。\n\n这个交互过程中，终端到各AP的信号强度值是一清二楚的，从而可以采用RSSI等方式来定位。也就是说只要你手机终端开启了Wi-Fi，在后台它是会与空间内的AP发生一次或反复的帧听与响应，这些可以帧听，基本暴露了你在空间的大致位置了。 \n\n通过这种方式，WiFi热点亦可扫描并收集周围的AP信号，无论是否加密，是否已连接，甚至信号强度不足以显示在无线信号列表中，都可以获取到AP广播出来的MAC地址。\n\n一、基本原理\n\n利用工作在monitor模式的无线网卡可以探测到所有经过它的数据流，在AP端使用无线网卡抓取AP与AP、AP与STA之间的MAC层管理数据包，然后对抓取的MAC帧进行实时解包，提取所需要的Timestamp、MAC address、RSSI等信息，并将其存入服务器数据库中，用于后续的wifi定位、链路分析等。\n\n二、获取周围wifi强度的两种方法：\n\n1、抓取AP与AP之间的MAC层管理数据包\n\nOpenWrt路由器无线网卡工作于AP模式，无需连接周围wifi，通过以下指令即可监听到它们的MAC地址、RSSI强度等信息。\n\n如何在Linxu程序内部嵌入shell终端指令并获取该指令的输出结果。请参考\n此处\n。\n\niw dev wlan0 scan | egrep \"^BSS|singal\"//参考注释[4]\n1\n\n最终效果：在703N路由器测试最快速度为 0.8秒以上，\n此外获得的RSSI不稳定，浮动较大，\n不适合做控制，故寻找第二种方法。\n\n原因分析：此条语句执行时，会将周围所有的 wifi热点的MAC层管理数据包都捕获进来，然后再挨个解包、提取，这个过程将花费相当长时间，造成读取线程堵塞。\n\n2、抓取AP与STA之间的MAC层管理数据包\n\nOpenWrt路由器无线网卡工作于AP模式并作为Master路由器，其它路由器作为Client，连上该AP，即可通过下列指令查看所有连入该AP的客户端的信息。\n\niw dev wlan0 station dump | egrep \"Station|singal:\"//参考注释[5]\n//iw wlan0 station get 40:b0:fa:c1:75:41//查看单个路由器信息\n1\n2\n\n最终效果：在703N路由器测试最快速度为 28ms，获得的RSSI较为稳定，实时性也满足要求。\n\n参考文章：\n\n[1]\nwifi关键数据提取\n\n[2]\nLinux使用tcpdump抓获取WIFI包\n\n[3]\nLinux系统无线网络抓包程序(分析手机WIFI MAC地址)\n\n[4]\n实战无线网络分析（篇一）无线监听\n\n[5]\nHow to get RSSI in a linux AP (iw station dump doesn’t work)\n\n                                                                        @本文作者：LeathreWang\n\n1\n\nMeasure",
      "content_path": null,
      "diff_base_variant_id": null,
      "metadata": {
        "language": "vi",
        "length": 1919,
        "rule_count": 2,
        "applied_rules": [
          {
            "rule_id": "dedupe_lines",
            "description": "Collapse adjacent duplicate lines",
            "note": "collapsed duplicate adjacent lines"
          },
          {
            "rule_id": "whitespace",
            "description": "Normalize whitespace",
            "note": "collapsed whitespace"
          }
        ]
      }
    }
  ],
  "extractions": [],
  "journal": {
    "id": "54cd1144-9315-44d1-8f2f-bc7085d674e4",
    "note_id": "9108186d-1472-4883-ba8f-d049957666cb",
    "stage": "ingest",
    "agent_id": "evernote_ingest:v0",
    "started_at": "2025-11-09T20:01:34.227429Z",
    "finished_at": "2025-11-09T20:01:34.227429Z",
    "status": "success",
    "input_ref": {
      "task_id": "e9071875-03d0-4746-a157-b0c3d68d8a87",
      "source_path": "/Users/tang/workbench/article-classifier/backups/2023年6月/IT技术/OpenWrt下WiFi无线指标的提取（MAC地址、RSSI等） - LeatherWang的博客 .html",
      "checksum": "ffbcda0574e2da2c794f6c27e25d2e3375c20d042c23a6d5e16c52c23797993c"
    },
    "output_ref": {
      "ingest_source": "ddfa630c-c870-4de8-989e-bd6091a650dd",
      "note": "9108186d-1472-4883-ba8f-d049957666cb",
      "variants": [
        "7a7920bf-8a77-4f57-a574-f20c7fdc266b",
        "f7cb9fa3-a253-4b54-a505-7ddc4c063611"
      ]
    },
    "error_detail": null
  }
}