{
  "ingest_source": {
    "id": "0762f128-0f7a-419d-bb8a-da119c3980d8",
    "source_type": "evernote_html",
    "source_path": "/Users/tang/workbench/article-classifier/backups/2023年6月/IT技术/Dns隧道.html",
    "collected_at": "2025-11-09T20:01:33.985364Z",
    "external_id": null,
    "title_hint": null,
    "language_hint": "zh-cn",
    "captured_at": null,
    "checksum": "2652e794b2110e65786c8208a98bce53f2bc0407d43afbd19ca79aa871849189",
    "status": "pending",
    "notes": {
      "batch_id": null
    }
  },
  "note": {
    "id": "f37a11f7-62de-4ee7-9afb-e9c7ed184c9e",
    "ingest_source_id": "0762f128-0f7a-419d-bb8a-da119c3980d8",
    "canonical_title": "Dns隧道",
    "language": "zh-cn",
    "ingested_at": "2025-11-09T20:01:33.985368Z",
    "created_at": null,
    "status": "active",
    "importance": 0,
    "attributes": {
      "source_filename": "Dns隧道.html"
    }
  },
  "variants": [
    {
      "id": "daaec983-cee8-4fbd-a3ee-e9e1a653f093",
      "note_id": "f37a11f7-62de-4ee7-9afb-e9c7ed184c9e",
      "variant_type": "raw_html",
      "version": 1,
      "created_by": "evernote_ingest:v0",
      "created_at": "2025-11-09T20:01:33.985371Z",
      "content": "---\ntitle: Dns隧道\nupdated: 2014-02-16 06:10:11Z\ncreated: 2014-02-16 06:09:48Z\n---\n\n\n\n<en-note><span STYLE=\"border-collapse: separate; color: rgb(0, 0, 0); font-family: 'Microsoft Yahei', 'Helvetica Neue', 'Luxi Sans', 'DejaVu Sans', Tahoma, 'Hiragino Sans GB', STHeiti; font-size: 18px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-align: -webkit-auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: 0px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.300781); -webkit-composition-fill-color: rgba(175, 192, 227, 0.234375); -webkit-composition-frame-color: rgba(77, 128, 180, 0.234375); -webkit-text-decorations-in-effect: none; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; \">\n&Tab;&Tab;<div STYLE=\"font-size: 18px; word-wrap: break-word; font-family: 'Microsoft Yahei', 'Helvetica Neue', 'Luxi Sans', 'DejaVu Sans', Tahoma, 'Hiragino Sans GB', STHeiti !important; padding-top: 2px; padding-right: 5px; padding-bottom: 2px; padding-left: 5px; line-height: 22px; \">\n&Tab;&Tab;&Tab;<div STYLE=\"font-size: 18px; word-wrap: break-word; font-family: 'Microsoft Yahei', 'Helvetica Neue', 'Luxi Sans', 'DejaVu Sans', Tahoma, 'Hiragino Sans GB', STHeiti !important; \">\n&Tab;&Tab;&Tab;&Tab;<p STYLE=\"font-size: 18px; word-wrap: break-word; font-family: 'Microsoft Yahei', 'Helvetica Neue', 'Luxi Sans', 'DejaVu Sans', Tahoma, 'Hiragino Sans GB', STHeiti !important; \">&nbsp;&nbsp;&nbsp;&nbsp;今天在 greader 上看到这么一篇，<a STYLE=\"color: rgb(2, 50, 152); text-decoration: underline; \" HREF=\"http://blog.creke.net/747.html\">用 DNS 隧道实现免费上网</a>。我的思绪猛然回到去年去<a STYLE=\"color: rgb(2, 50, 152); text-decoration: underline; \" HREF=\"http://blog.codingnow.com/2010/09/nz.html\">新西兰度假</a>的日子。</p>\n&Tab;&Tab;&Tab;&Tab;<p STYLE=\"font-size: 18px; word-wrap: break-word; font-family: 'Microsoft Yahei', 'Helvetica Neue', 'Luxi Sans', 'DejaVu Sans', Tahoma, 'Hiragino Sans GB', STHeiti !important; \">&nbsp;&nbsp;&nbsp;&nbsp;有那么几天，我们在惠灵顿的海边山顶租了个屋子，一切都很舒服，但是不能上网。甚至于附近连 wifi 信号都收不到，想&quot;借用&quot;一下别人的 wifi 热点都不成。我顶着海边的狂风在院子里竖起天线，捕捉着周围微弱的信号，最终未果。然后转战屋里的有线电视。我发现和国内的有线电视一样，机顶盒是接有网线的。也就是说，物理上，存在一条链路接入了互联网。但是我插上电脑后，发现 ip 包根本发不出去。不过，好似有个 DNS 服务是可以用的。</p>\n&Tab;&Tab;&Tab;&Tab;<p STYLE=\"font-size: 18px; word-wrap: break-word; font-family: 'Microsoft Yahei', 'Helvetica Neue', 'Luxi Sans', 'DejaVu Sans', Tahoma, 'Hiragino Sans GB', STHeiti !important; \">&nbsp;&nbsp;&nbsp;&nbsp;当时也没多想，只是觉得有办法可以利用一下。不过隔天就搬走了，没有深入下去。今天回味一下，感觉的确可以利用 DNS 服务和外部建立连接。当然，一开始就需要在外界把接应的程序程序搭建好。</p>\n&Tab;&Tab;&Tab;&Tab;<p STYLE=\"font-size: 18px; word-wrap: break-word; font-family: 'Microsoft Yahei', 'Helvetica Neue', 'Luxi Sans', 'DejaVu Sans', Tahoma, 'Hiragino Sans GB', STHeiti !important; \">&nbsp;&nbsp;&nbsp;&nbsp;原理很简单，你在做 DNS 查询的时候，如果查的域名在 DNS 服务器本机的 cache 中没有，它就会去互联网上查询，最终把结果返回给你。如果你在互联网上有台定制的服务器。只要依靠 DNS 的这层约定，就可以交换数据包了。从 DNS 协议上看，你是在一次次的查询某个特定域名，并得到解析结果。但实际上，你在和外部通讯。你没有直接连到局域网外的机器，因为网关不会转发你的 IP 包出去。但局域网上的 DNS 服务器帮你做了中转。这就是 DNS Tunnel 了。</p>\n&Tab;&Tab;&Tab;&Tab;<p STYLE=\"font-size: 18px; word-wrap: break-word; font-family: 'Microsoft Yahei', 'Helvetica Neue', 'Luxi Sans', 'DejaVu Sans', Tahoma, 'Hiragino Sans GB', STHeiti !important; \">&nbsp;&nbsp;&nbsp;&nbsp;我觉得有趣，就按文章所述做了试验。</p>\n&Tab;&Tab;&Tab;&Tab;<p STYLE=\"font-size: 18px; word-wrap: break-word; font-family: 'Microsoft Yahei', 'Helvetica Neue', 'Luxi Sans', 'DejaVu Sans', Tahoma, 'Hiragino Sans GB', STHeiti !important; \">&nbsp;&nbsp;&nbsp;&nbsp;这需要一个自己的域名，一台运行在互联网上的机器可以自由安装软件。这些都有。那个假的 DNS 是由 OzymanDNS 提供的。不过今天我搜到的 OzymanDNS 网站上已经没有了下载包。好在 google 很强大，这个 2004 年编写的小 perl 程序，并不难找到。</p>\n&Tab;&Tab;&Tab;&Tab;<p STYLE=\"font-size: 18px; word-wrap: break-word; font-family: 'Microsoft Yahei', 'Helvetica Neue', 'Luxi Sans', 'DejaVu Sans', Tahoma, 'Hiragino Sans GB', STHeiti !important; \">&nbsp;&nbsp;&nbsp;&nbsp;不过我反复试验也没有成功，按文章所述的，利用 ssh 在本机上的 proxycommand 我怎么都无法通过 dnstunnel 连上主机。估计是我哪里配置的不对吧。不过接下来 google 到了更好的选择。那就是<span>&nbsp;</span><a STYLE=\"color: rgb(2, 50, 152); text-decoration: underline; \" HREF=\"http://dev.kryo.se/iodine/\">iodine</a><span>&nbsp;</span>这个小玩意。非常简单的就装好了。第一次运行发现找不到 tun 设备。看来需要手工建一个。在 linux 上可以自己来：</p>\n&Tab;&Tab;&Tab;&Tab;<pre></pre>mkdir /dev/net ; mknod /dev/net/tun c <a HREF=\"tel:10%20200\">10 200</a>\n&Tab;&Tab;&Tab;&Tab;<pre></pre>这样即可。\n&Tab;&Tab;&Tab;&Tab;<p STYLE=\"font-size: 18px; word-wrap: break-word; font-family: 'Microsoft Yahei', 'Helvetica Neue', 'Luxi Sans', 'DejaVu Sans', Tahoma, 'Hiragino Sans GB', STHeiti !important; \"></p>\n&Tab;&Tab;&Tab;&Tab;<p STYLE=\"font-size: 18px; word-wrap: break-word; font-family: 'Microsoft Yahei', 'Helvetica Neue', 'Luxi Sans', 'DejaVu Sans', Tahoma, 'Hiragino Sans GB', STHeiti !important; \">&nbsp;&nbsp;&nbsp;&nbsp;windows 版麻烦一些，需要装软件。安装个 openvpn 包里的 TAP driver 就行了。</p>\n&Tab;&Tab;&Tab;&Tab;<p STYLE=\"font-size: 18px; word-wrap: break-word; font-family: 'Microsoft Yahei', 'Helvetica Neue', 'Luxi Sans', 'DejaVu Sans', Tahoma, 'Hiragino Sans GB', STHeiti !important; \">&nbsp;&nbsp;&nbsp;&nbsp;然后利用 iodine 可以利用 dns tunnel 建立起虚拟网。接下来可以方便的用 ssh -D 建起 socks5 了。不过我觉得这个都是多余的。为了节约 dns tunnel 上的带宽，我直接建了个 socks5 服务器。就是用的我<a STYLE=\"color: rgb(2, 50, 152); text-decoration: underline; \" HREF=\"http://blog.codingnow.com/2011/05/xtunnel.html\">前段写的一篇 blog</a><span>&nbsp;</span>中提到的 ssocks 。同样需要修改一下，把监听端口绑定在 10.0.0.1 上。</p>\n&Tab;&Tab;&Tab;&Tab;<p STYLE=\"font-size: 18px; word-wrap: break-word; font-family: 'Microsoft Yahei', 'Helvetica Neue', 'Luxi Sans', 'DejaVu Sans', Tahoma, 'Hiragino Sans GB', STHeiti !important; \">&nbsp;&nbsp;&nbsp;&nbsp;最后，居然没遇到什么麻烦就接通了。我想我所在网络出口上的 dns 服务器肯定觉得很疼。这真是一个超级淡疼的 tunnel 方案啊。嗯，可以留作日后翻墙的备用方案，以备不时之需。</p>\n&Tab;&Tab;&Tab;&Tab;<p STYLE=\"font-size: 18px; word-wrap: break-word; font-family: 'Microsoft Yahei', 'Helvetica Neue', 'Luxi Sans', 'DejaVu Sans', Tahoma, 'Hiragino Sans GB', STHeiti !important; \">&nbsp;&nbsp;&nbsp;&nbsp;ps. 好想知道到处都有的诸如 CMCC 的 wifi 热点能不能用。下次到商业区别忘记试试看。</p>\n&Tab;&Tab;&Tab;</div>\n&Tab;&Tab;&Tab;<div STYLE=\"font-size: 18px; word-wrap: break-word; font-family: 'Microsoft Yahei', 'Helvetica Neue', 'Luxi Sans', 'DejaVu Sans', Tahoma, 'Hiragino Sans GB', STHeiti !important; \"><strong>前一篇：</strong><a STYLE=\"color: rgb(2, 50, 152); text-decoration: underline; \" HREF=\"http://blogread.cn/it/article/4096\">TCP链接主动关闭不发fin包奇怪行为分析</a></div>\n&Tab;&Tab;&Tab;<div STYLE=\"font-size: 18px; word-wrap: break-word; font-family: 'Microsoft Yahei', 'Helvetica Neue', 'Luxi Sans', 'DejaVu Sans', Tahoma, 'Hiragino Sans GB', STHeiti !important; \"><strong>后一篇：</strong><a STYLE=\"color: rgb(2, 50, 152); text-decoration: underline; \" HREF=\"http://blogread.cn/it/article/4244\">跨机房问题</a></div>\n&Tab;&Tab;</div>\n&Tab;</span><br/>\n\n</en-note>      ",
      "content_path": null,
      "diff_base_variant_id": null,
      "metadata": {
        "checksum": "2652e794b2110e65786c8208a98bce53f2bc0407d43afbd19ca79aa871849189",
        "path": "/Users/tang/workbench/article-classifier/backups/2023年6月/IT技术/Dns隧道.html"
      }
    },
    {
      "id": "a58afcfe-2882-453c-ad38-c6d0633de689",
      "note_id": "f37a11f7-62de-4ee7-9afb-e9c7ed184c9e",
      "variant_type": "clean_text",
      "version": 1,
      "created_by": "evernote_ingest:v0",
      "created_at": "2025-11-09T20:01:33.985374Z",
      "content": "---\ntitle: Dns隧道\nupdated: 2014-02-16 06:10:11Z\ncreated: 2014-02-16 06:09:48Z\n---\n\n    今天在 greader 上看到这么一篇，\n用 DNS 隧道实现免费上网\n。我的思绪猛然回到去年去\n新西兰度假\n的日子。\n\n    有那么几天，我们在惠灵顿的海边山顶租了个屋子，一切都很舒服，但是不能上网。甚至于附近连 wifi 信号都收不到，想\"借用\"一下别人的 wifi 热点都不成。我顶着海边的狂风在院子里竖起天线，捕捉着周围微弱的信号，最终未果。然后转战屋里的有线电视。我发现和国内的有线电视一样，机顶盒是接有网线的。也就是说，物理上，存在一条链路接入了互联网。但是我插上电脑后，发现 ip 包根本发不出去。不过，好似有个 DNS 服务是可以用的。\n\n    当时也没多想，只是觉得有办法可以利用一下。不过隔天就搬走了，没有深入下去。今天回味一下，感觉的确可以利用 DNS 服务和外部建立连接。当然，一开始就需要在外界把接应的程序程序搭建好。\n\n    原理很简单，你在做 DNS 查询的时候，如果查的域名在 DNS 服务器本机的 cache 中没有，它就会去互联网上查询，最终把结果返回给你。如果你在互联网上有台定制的服务器。只要依靠 DNS 的这层约定，就可以交换数据包了。从 DNS 协议上看，你是在一次次的查询某个特定域名，并得到解析结果。但实际上，你在和外部通讯。你没有直接连到局域网外的机器，因为网关不会转发你的 IP 包出去。但局域网上的 DNS 服务器帮你做了中转。这就是 DNS Tunnel 了。\n\n    我觉得有趣，就按文章所述做了试验。\n\n    这需要一个自己的域名，一台运行在互联网上的机器可以自由安装软件。这些都有。那个假的 DNS 是由 OzymanDNS 提供的。不过今天我搜到的 OzymanDNS 网站上已经没有了下载包。好在 google 很强大，这个 2004 年编写的小 perl 程序，并不难找到。\n\n    不过我反复试验也没有成功，按文章所述的，利用 ssh 在本机上的 proxycommand 我怎么都无法通过 dnstunnel 连上主机。估计是我哪里配置的不对吧。不过接下来 google 到了更好的选择。那就是\n \niodine\n \n这个小玩意。非常简单的就装好了。第一次运行发现找不到 tun 设备。看来需要手工建一个。在 linux 上可以自己来：\n\nmkdir /dev/net ; mknod /dev/net/tun c\n10 200\n\n这样即可。\n\n    windows 版麻烦一些，需要装软件。安装个 openvpn 包里的 TAP driver 就行了。\n\n    然后利用 iodine 可以利用 dns tunnel 建立起虚拟网。接下来可以方便的用 ssh -D 建起 socks5 了。不过我觉得这个都是多余的。为了节约 dns tunnel 上的带宽，我直接建了个 socks5 服务器。就是用的我\n前段写的一篇 blog\n \n中提到的 ssocks 。同样需要修改一下，把监听端口绑定在 10.0.0.1 上。\n\n    最后，居然没遇到什么麻烦就接通了。我想我所在网络出口上的 dns 服务器肯定觉得很疼。这真是一个超级淡疼的 tunnel 方案啊。嗯，可以留作日后翻墙的备用方案，以备不时之需。\n\n    ps. 好想知道到处都有的诸如 CMCC 的 wifi 热点能不能用。下次到商业区别忘记试试看。\n\n前一篇：\nTCP链接主动关闭不发fin包奇怪行为分析\n\n后一篇：\n跨机房问题",
      "content_path": null,
      "diff_base_variant_id": null,
      "metadata": {
        "language": "zh-cn",
        "length": 1528,
        "rule_count": 2,
        "applied_rules": [
          {
            "rule_id": "dedupe_lines",
            "description": "Collapse adjacent duplicate lines",
            "note": "collapsed duplicate adjacent lines"
          },
          {
            "rule_id": "whitespace",
            "description": "Normalize whitespace",
            "note": "collapsed whitespace"
          }
        ]
      }
    }
  ],
  "extractions": [],
  "journal": {
    "id": "f8cb8235-1170-40f0-8d67-6798175ef72f",
    "note_id": "f37a11f7-62de-4ee7-9afb-e9c7ed184c9e",
    "stage": "ingest",
    "agent_id": "evernote_ingest:v0",
    "started_at": "2025-11-09T20:01:33.985378Z",
    "finished_at": "2025-11-09T20:01:33.985379Z",
    "status": "success",
    "input_ref": {
      "task_id": "8e912c7b-aebd-4aa7-af54-cd52fcb2c619",
      "source_path": "/Users/tang/workbench/article-classifier/backups/2023年6月/IT技术/Dns隧道.html",
      "checksum": "2652e794b2110e65786c8208a98bce53f2bc0407d43afbd19ca79aa871849189"
    },
    "output_ref": {
      "ingest_source": "0762f128-0f7a-419d-bb8a-da119c3980d8",
      "note": "f37a11f7-62de-4ee7-9afb-e9c7ed184c9e",
      "variants": [
        "daaec983-cee8-4fbd-a3ee-e9e1a653f093",
        "a58afcfe-2882-453c-ad38-c6d0633de689"
      ]
    },
    "error_detail": null
  }
}